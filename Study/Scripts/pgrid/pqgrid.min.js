(function(n){var t=n.paramquery=n.paramquery||{};n.paramquery.pqgrid=n.paramquery.pqgrid||{};t.xmlToArray=function(t,i){var u=i.itemParent,f=i.itemNames,r=[],e=n(t).find(u);return e.each(function(t,i){var e=n(i),u=[];n(f).each(function(n,t){u.push(e.find(t).text().replace(/\r|\n|\t/g,""))});r.push(u)}),r};t.xmlToJson=function(t,i){var f=i.itemParent,r=i.itemNames,u=[],e=n(t).find(f);return e.each(function(t,i){for(var e,s=n(i),o={},f=0,h=r.length;f<h;f++)e=r[f],o[e]=s.find(e).text().replace(/\r|\n|\t/g,"");u.push(o)}),u};t.tableToArray=function(t){var e=n(t),r=[],u=[],i=e.children("tbody").children("tr"),o=i.length?n(i[0]):n(),f=i.length>1?n(i[1]):n();return o.children("th,td").each(function(t,i){var u=n(i),h=u.html(),c=u.width(),e="left",s;if(f.length)var l=f.find("td:eq("+t+")"),o=l.attr("align"),e=o?o:e;s={title:h,width:c,dataType:"string",align:e,dataIndx:t};r.push(s)}),i.each(function(t,i){if(t!=0){var f=n(i),r=[];f.children("td").each(function(t,i){r.push(n.trim(n(i).html()))});u.push(r)}}),{data:u,colModel:r}};t.formatCurrency=function(n){var t;if(isNaN(n))return n;n=Math.round(n*100)/100;n=n+"";n.indexOf(".")==-1?n=n+".00":n.indexOf(".")+2==n.length&&(n=n+"0");var r=n.length,f=3,u=n.substring(0,r-f),o=n.substring(r-f,r),e=u.match(/\d/g).reverse(),i=[];for(t=0;t<e.length;t++)t>0&&t%3==0&&i.push(","),i.push(e[t]);return i=i.reverse(),u=i.join(""),u+o};t.validation={is:function(n,t){return n=="string"||!n?!0:(n=n.substring(0,1).toUpperCase()+n.substring(1,n.length),this["is"+n](t))},isFloat:function(n){var t=parseFloat(n);return isNaN(t)||t!=n?!1:!0},isInteger:function(n){var t=parseInt(n);return isNaN(t)||t!=n?!1:!0},isDate:function(n){var t=Date.parse(n);return isNaN(t)?!1:!0}}})(jQuery),function(n){var t={};t.options={curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20};t._regional={strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"};n.extend(t.options,t._regional);t._create=function(){var t=this,i=this.options;this.element.addClass("pq-pager");this.first=n("<button type='button' title='"+i.strFirstPage+"'><\/button>",{}).appendTo(this.element).button({icons:{primary:"ui-icon-seek-first"},text:!1}).bind("click.paramquery",function(n){t.options.curPage>1&&t._onChange(n,1)});this.prev=n("<button type='button' title='"+i.strPrevPage+"'><\/button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-prev"},text:!1}).bind("click",function(n){if(t.options.curPage>1){var i=t.options.curPage-1;t._onChange(n,i)}});n("<span class='pq-separator'><\/span>").appendTo(this.element);this.pageHolder=n("<span class='pq-page-placeholder'><\/span>").appendTo(this.element);n("<span class='pq-separator'><\/span>").appendTo(this.element);this.next=n("<button type='button' title='"+this.options.strNextPage+"'><\/button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-next"},text:!1}).bind("click",function(n){var i=t.options.curPage+1;t._onChange(n,i)});this.last=n("<button type='button' title='"+this.options.strLastPage+"'><\/button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-end"},text:!1}).bind("click",function(n){var i=t.options.totalPages;t._onChange(n,i)});n("<span class='pq-separator'><\/span>").appendTo(this.element);this.rPPHolder=n("<span class='pq-page-placeholder'><\/span>").appendTo(this.element);this.$refresh=n("<button type='button' title='"+this.options.strRefresh+"'><\/button>").appendTo(this.element).button({icons:{primary:"ui-icon-refresh"},text:!1}).bind("click",function(n){if(t._trigger("beforeRefresh",n)===!1)return!1;t._trigger("refresh",n)});n("<span class='pq-separator'><\/span>").appendTo(this.element);this.$msg=n("<span class='pq-pager-msg'><\/span>").appendTo(this.element);this._refresh()};t._refreshPage=function(){var h=this,r,o,u,s,f;this.pageHolder.empty();var t=this.options,c=t.strPage,e=c.split(" "),i=[];for(r=0,o=e.length;r<o;r++)u=e[r],u=="{0}"?i.push("<input type='text' tabindex='0' class='ui-corner-all' />"):u=="{1}"?i.push("<span class='total'><\/span>"):i.push("<span>",u,"<\/span>");s=i.join("");f=n(s).appendTo(this.pageHolder);this.page=f.filter("input").bind("change",function(i){var u=n(this),r=u.val();return isNaN(r)||r<1?(u.val(t.curPage),!1):(r=parseInt(r),r>t.totalPages)?(u.val(t.curPage),!1):h._onChange(i,r)===!1?(u.val(t.curPage),!1):void 0});this.$total=f.filter("span.total")};t._onChange=function(n,t){if(this._trigger("beforeChange",n,{curPage:t})===!1||this._trigger("change",n,{curPage:t})===!1)return!1;this.option({curPage:t})};t._refresh=function(){var o,i,f,e,l,s,a,r;this._refreshPage();var w=this.$rPP,u=this,t=this.options;if(this.first.attr("title",t.strFirstPage),this.prev.attr("title",t.strPrevPage),this.next.attr("title",t.strNextPage),this.last.attr("title",t.strLastPage),this.$refresh.attr("title",t.strRefresh),this.rPPHolder.empty(),t.strRpp){if(o=t.rPPOptions,i=t.strRpp,i.indexOf("{0}")!=-1){for(f=["<select class='ui-corner-all'>"],e=0,l=o.length;e<l;e++)s=o[e],f.push('<option value="',s,'">',s,"<\/option>");f.push("<\/select>");a=f.join("");i=i.replace("{0}","<\/span>"+a);i="<span>"+i+"<span class='pq-separator'><\/span>"}else i="<span>"+i+"<\/span><span class='pq-separator'><\/span>";this.$rPP=n(i).appendTo(this.rPPHolder).filter("select").val(t.rPP).change(function(t){var r=n(this),i=r.val();if(u._trigger("beforeChange",t,{rPP:i})===!1)return r.val(u.options.rPP),!1;u._trigger("change",t,{rPP:i})!==!1&&(u.options.rPP=i)})}if(t.curPage>=t.totalPages?(this.next.button({disabled:!0}),this.last.button({disabled:!0})):(this.next.button({disabled:!1}),this.last.button({disabled:!1})),t.curPage<=1?(this.first.button({disabled:!0}),this.prev.button({disabled:!0})):(this.first.button({disabled:!1}),this.prev.button({disabled:!1})),this.page.val(t.curPage),this.$total.text(t.totalPages),this.options.totalRecords>0){var v=t.rPP,y=t.curPage,h=t.totalRecords,p=(y-1)*v,c=y*v;c>h&&(c=h);r=t.strDisplay;r=r.replace("{0}",p+1);r=r.replace("{1}",c);r=r.replace("{2}",h);this.$msg.html(r)}else this.$msg.html("")};t._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()};t._setOption=function(n,t){(n=="curPage"||n=="totalPages")&&(t=parseInt(t));this._super.call(this,n,t)};t._setOptions=function(){this._super.apply(this,arguments);this._refresh()};n.widget("paramquery.pqPager",t);n.paramquery.pqPager.regional={};n.paramquery.pqPager.regional.en=t._regional}(jQuery),function(n){var t={};t.options={length:200,num_eles:3,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",theme:!1};t._destroy=function(){n(document).off("."+this.eventNamespace);this.element.removeClass("pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty();this.element.removeData()};t._create=function(){this._createLayout()};t._createLayout=function(){var t=this,r=this.options,e=r.direction,o=this.eventNamespace,u=r.theme,i=this.element.empty(),f;e=="vertical"?(i.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb-vert"),u?(i.addClass("pq-sb-vert-t"),i.html("<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'><div class='ui-icon ui-icon-triangle-1-n'><\/div><\/div><div class='pq-sb-slider ui-corner-all ui-state-default'><\/div><div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'><div class='ui-icon ui-icon-triangle-1-s'><\/div><\/div>")):(i.addClass("pq-sb-vert-wt"),i.html("<div class='top-btn pq-sb-btn'><\/div><div class='pq-sb-slider'><div class='vert-slider-top'><\/div><div class='vert-slider-bg'><\/div><div class='vert-slider-center'><\/div><div class='vert-slider-bg'><\/div><div class='vert-slider-bottom'><\/div><\/div><div class='bottom-btn pq-sb-btn'><\/div>"))):(i.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb-horiz"),u?(i.addClass("pq-sb-horiz-t"),i.html("<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'><div class='ui-icon ui-icon-triangle-1-w'><\/div><\/div><div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all'><\/div><div class='right-btn pq-sb-btn ui-state-default ui-corner-right'><div class='ui-icon ui-icon-triangle-1-e'><\/div><\/div>")):(i.addClass("pq-sb-horiz-wt"),i.width(this.width),i.html("<div class='left-btn pq-sb-btn'><\/div><div class='pq-sb-slider pq-sb-slider-h'><span class='horiz-slider-left'><\/span><span class='horiz-slider-bg'><\/span><span class='horiz-slider-center'><\/span><span class='horiz-slider-bg'><\/span><span class='horiz-slider-right'><\/span><\/div><div class='right-btn pq-sb-btn'><\/div>")));i.disableSelection().unbind(".pq-scrollbar").on("mousedown.pq-scrollbar",function(i){if(!r.disabled&&!t.$slider.is(":hidden")){n(document).off("."+o).on("mouseup."+o,function(n){t._mouseup(n)});if(e=="vertical"){var u=i.pageY,s=t.element.offset().top,l=s+r.length,h=t.$slider,c=h.offset().top,a=h.height(),v=c+a;u<c&&u>s+17?t.mousedownInterval=window.setInterval(function(){u>=h.offset().top?(window.clearInterval(t.mousedownInterval),t.mousedownInterval=null):t._pageUp(i)},0):u>v&&u<l-17&&(t.mousedownInterval=window.setInterval(function(){u<=h.offset().top+a?(window.clearInterval(t.mousedownInterval),t.mousedownInterval=null):t._pageDown(i)},0))}else{var f=i.pageX,s=t.element.offset().left,l=s+r.length,c=t.$slider.offset().left,v=c+t.$slider.width();f<c&&f>s+17?(t.$slider.css("left",f-t.element.offset().left),t._updateCurPosAndTrigger(i)):f>v&&f<l-17&&(t.$slider.css("left",f-t.element.offset().left-t.$slider.width()),t._updateCurPosAndTrigger(i))}}});f=this.$slider=n("div.pq-sb-slider",this.element);u&&f.attr("tabindex","0");this._bindSliderEvents(f);this.$top_btn=n("div.top-btn,div.left-btn",this.element).click(function(n){if(!t.options.disabled)return t.decr_cur_pos(n),n.preventDefault(),!1}).mousedown(function(n){t.options.disabled||(t.mousedownTimeout=window.setTimeout(function(){t.mousedownInterval=window.setInterval(function(){t.decr_cur_pos(n)},0)},t.options.timeout))}).bind("mouseup mouseout",function(n){t._mouseup(n)});this.$bottom_btn=n("div.bottom-btn,div.right-btn",this.element).click(function(n){if(!t.options.disabled)return t.incr_cur_pos(n),n.preventDefault(),!1}).mousedown(function(n){t.options.disabled||(t.mousedownTimeout=window.setTimeout(function(){t.mousedownInterval=window.setInterval(function(){t.incr_cur_pos(n)},0)},t.options.timeout))}).bind("mouseup mouseout",function(n){t._mouseup(n)});this.refresh()};t._bindSliderEvents=function(t){var i=this,u=this.options.direction,r="x";u=="vertical"&&(r="y");t.draggable({axis:r,helper:function(){return i._setDragLimits(),this},start:function(){i.topWhileDrag=null;i.dragging=!0},drag:function(n){i.dragging=!0;var t=i.options.pace;t=="optimum"?i._setNormalPace(n):t=="fast"&&i._updateCurPosAndTrigger(n)},stop:function(n){i.options.pace!="fast"&&i._updateCurPosAndTrigger(n);i.dragging=!1;i.refresh()}}).on("keydown.pq-scrollbar",function(t){var r=t.keyCode,f=i.options,e=f.cur_pos,o=f.ratio,s=f.num_eles,u=n.ui.keyCode;return i.keydownTimeout==null&&(i.keydownTimeout=window.setTimeout(function(){r==u.DOWN||r==u.RIGHT?i.incr_cur_pos(t):r==u.UP||r==u.LEFT?i.decr_cur_pos(t):r==u.HOME?f.steps?e>0&&(f.cur_pos=0,i.updateSliderPos(),i.scroll(t)):o>0&&(f.ratio=0,i.updateSliderPos(),i.drag(t)):r==u.END?f.steps?e<s&&(f.cur_pos=s,i.updateSliderPos(),i.scroll(t)):o<1&&(f.ratio=1,i.updateSliderPos(),i.drag(t)):f.direction=="vertical"&&(r==u.PAGE_DOWN?i._pageDown(t):r==u.PAGE_UP&&i._pageUp(t));i.keydownTimeout=null},0)),r==u.DOWN||r==u.RIGHT||r==u.UP||r==u.LEFT||r==u.PAGE_DOWN||r==u.PAGE_UP||r==u.HOME||r==u.END?(t.preventDefault(),!1):void 0})};t.decr_cur_pos=function(n){var i=this,t=i.options,u=t.steps,r;u?t.cur_pos>0&&(t.cur_pos--,i.updateSliderPos(),i.scroll(n)):t.ratio>0&&(r=t.ratio-1/(t.num_eles-1),r<0&&(r=0),t.ratio=r,i.updateSliderPos(),i.drag(n))};t.incr_cur_pos=function(n){var i=this,t=i.options,u=t.steps,r;u?(t.cur_pos<t.num_eles-1&&t.cur_pos++,i.updateSliderPos(),i.scroll(n)):(t.ratio<1&&(r=t.ratio+1/(t.num_eles-1),r>1&&(r=1),t.ratio=r),i.updateSliderPos(),i.drag(n))};t._mouseup=function(){if(!this.options.disabled){var n=this;window.clearTimeout(n.mousedownTimeout);n.mousedownTimeout=null;window.clearInterval(n.mousedownInterval);n.mousedownInterval=null}};t._setDragLimits=function(){var i=this.options,n,t;i.direction=="vertical"?(n=this.element.offset().top+17,t=n+i.length-34-this.slider_length,this.$slider.draggable("option","containment",[0,n,0,t])):(n=this.element.offset().left+17,t=n+i.length-34-this.slider_length,this.$slider.draggable("option","containment",[n,0,t,0]))};t.refresh=function(){var n=this.options,t=this.element;if(n.num_eles<=1){t.css("display","none");return}t.css("display","");this._validateCurPos();this.dragging||(t[n.direction==="vertical"?"height":"width"](n.length),this._setSliderBgLength(),this.scroll_space<4||n.num_eles<=1?this.$slider.css("display","none"):this.$slider.css("display",""));this.updateSliderPos()};t._setSliderBgLength=function(){var i=this.options,o=i.theme,e=this.$slider,f=i.length,s=i.num_eles*40+f,h=f-34,c=h*f/s,u=Math.round((c-14)/2),t,r;u<1&&(u=1);t=14+2*u;this.scroll_space=i.length-34-t;t!==this.slider_length&&(this.slider_length=t,r=i.direction==="vertical"?{dim:"height",cls:".vert-slider-bg"}:{dim:"width",cls:".horiz-slider-bg"},o?e[r.dim](t-2):(n(r.cls,this.element)[r.dim](u),e[r.dim](t)))};t._updateCurPosAndTrigger=function(n,t){var f=this,i=this.options,o=i.direction,s=f.$slider,e,u,r;if(t==null&&(t=parseInt(s[0].style[o==="vertical"?"top":"left"])),e=i.length-34-this.slider_length,u=(t-17)/e,i.steps){if(r=u*(i.num_eles-1),r=Math.round(r),i.cur_pos!=r){if(this.dragging){if(this.topWhileDrag!=null){if(this.topWhileDrag<t&&i.cur_pos>r)return;if(this.topWhileDrag>t&&i.cur_pos<r)return}this.topWhileDrag=t}f.options.cur_pos=r;this.scroll(n)}}else i.ratio=u,this.drag(n)};t._setNormalPace=function(n){this.timer&&(window.clearInterval(this.timer),this.timer=null);var t=this,i=this.options,r=i.direction;t.timer=window.setInterval(function(){var u=t.$slider,i=parseInt(u[0].style[r==="vertical"?"top":"left"]);t.prev_top===i&&(t._updateCurPosAndTrigger(n,i),window.clearInterval(t.timer),t.timer=null);t.prev_top=i},20)};t._validateCurPos=function(){var n=this.options;n.cur_pos>=n.num_eles&&(n.cur_pos=n.num_eles-1);n.cur_pos<0&&(n.cur_pos=0)};t._updateSliderPosRatio=function(){var u=this,n=this.options,f=n.direction,i=n.ratio,r=u.$slider,e=n.length-34-this.slider_length,t;if(i==null)throw"ration N/A";t=i*e+17;f=="vertical"?r.css("top",t):r.css("left",t)};t._updateSliderPosCurPos=function(){var n=this.options,t=this.scroll_space*n.cur_pos/(n.num_eles-1);n.direction=="vertical"?this.$slider.css("top",17+t):this.$slider.css("left",17+t)};t.updateSliderPos=function(){var n=this.options;if(n.steps===undefined)throw"assert failed. steps N/A";n.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()};t.scroll=function(n){var t=this.options;this._trigger("scroll",n,{cur_pos:t.cur_pos,num_eles:t.num_eles})};t.drag=function(n){var t=this,i=t.options;this._trigger("drag",n,{ratio:i.ratio})};t._pageDown=function(n){this._trigger("pageDown",n,null)};t._pageUp=function(n){this._trigger("pageUp",n,null)};t._setOption=function(n,t){n=="disabled"?(this._super(n,t),t==!0?this.$slider.draggable("disable"):this.$slider.draggable("enable")):n=="theme"?(this._super(n,t),this._createLayout()):n=="ratio"?t>=0&&t<=1&&this._super(n,t):this._super(n,t)};t._setOptions=function(){this._super.apply(this,arguments);this.refresh()};n.widget("paramquery.pqScrollBar",t)}(jQuery),function(n){n.paramquery=n.paramquery||{};n.paramquery.onResize=function(t,i){var e=!1,r=n(t),f,u,o,s;for(r.css("position")==="static"&&r.css("position","relative"),e||(f=n('<iframe type="text/html" src="about:blank" class="pq-resize-iframe" style="display:block;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;overflow: hidden; pointer-events: none;" />').appendTo(r),f[0].data="about:blank",f.css("opacity","0")),u=0;u<r.length;u++)if(e)n(r[u]).on("resize",function(){i()});else{o=f[u];s=n(o.contentWindow);s.on("resize",function(){i()})}}}(jQuery),function(n){var c=function(){},f,r,t,o,l,s,e,h,i,u;c.prototype.belongs=function(n){if(n.target==this.that.element[0])return!0};n.paramquery.cClass=c;f=function(n){this.that=n;this.hidearrHS1=[];this.options=n.options;this.offset=null};n.paramquery.cGenerateView=f;r=f.prototype;r.generateView=function(t){var it=this,i=this.that,e=i.options,b=e.freezeCols,k=e.width==="flex",rt=e.height==="flex",ut=i.colModel,v,y,d=i.initH,ft=i.finalH,et=e.groupModel,o=i.pqpanes,a,h,nt,tt,f,r,w;if(t){r=this._generateTables(null,null,t);f=t.$cont;f.empty();o.v?f.append(["<div class='pq-grid-cont-inner'>",r,"<\/div>","<div class='pq-grid-cont-inner'>",r,"<\/div>"].join("")):f.append("<div class='pq-grid-cont-inner'>"+r+"<\/div>");var c=f.children("div"),s=c.children("table"),ot=i.iRefresh,g=k?"":ot.getEContWd(),p=s[0].scrollHeight-1;if(f.height(p),o.v){var st=n(c[0]),at=s[0].scrollWidth,ht=n(c[1]),ct=n(s[1]),l=u.call(i,-1,b),lt=u.call(i,b,d);st.css({width:l,zIndex:1});ht.css({left:l-1,width:g-l,height:p});ct.css({left:-1*(lt+l)})}else c.css({width:g,height:p});for(i.tables||(i.tables=[]),a=-1,h=0;h<i.tables.length;h++)nt=i.tables[h].cont,nt==t.$cont[0]&&(a=h);a==-1?i.tables.push({$tbl:s,cont:t.$cont[0]}):i.tables[a].$tbl=s}else{if(v=i.initV,y=i.finalV,tt=et?i.dataGM:i.pdata,f=i.$cont,e.editModel.indices!=null&&i.blurEditor({force:!0}),r=it._generateTables(v,y,t),f.empty(),i.totalVisibleRows===0?f.append("<div class='pq-grid-cont-inner pq-grid-norows' >"+e.strNoRows+"<\/div>"):(w=rt||k?"style='position:relative;'":"",f[0].innerHTML=o.h&&o.v?["<div class='pq-grid-cont-inner'>",r,"<\/div>","<div class='pq-grid-cont-inner'>",r,"<\/div>","<div class='pq-grid-cont-inner'>",r,"<\/div>","<div class='pq-grid-cont-inner'>",r,"<\/div>"].join(""):o.v?["<div class='pq-grid-cont-inner' ",w," >",r,"<\/div>","<div class='pq-grid-cont-inner' >",r,"<\/div>"].join(""):o.h?["<div class='pq-grid-cont-inner' style='position:static;' >",r,"<\/div>","<div class='pq-grid-cont-inner' style='position:static;' >",r,"<\/div>"].join(""):["<div class='pq-grid-cont-inner' ",w," >",r,"<\/div>"].join("")),i.$tbl=f.children("div").children("table"),e.scrollModel.flexContent&&i.$tbl[0])n.paramquery.onResize(i.$tbl[0],function(){var n=i.iRefresh;n.ignoreTResize||(n.refreshScrollbars(),i.iGenerateView.setPanes(),i._saveDims(),i.iMouseSelection.syncScrollBarVert(),e.height=="flex"&&n.setContAndGridHeightFromTable(),e.width=="flex"&&n.setContAndGridWidthFromTable(),n._refreshFrozenLine())});this.setPanes();this.setPaneEvents()}t||i._trigger("refresh",null,{dataModel:e.dataModel,colModel:ut,pageData:tt,initV:v,finalV:y,initH:d,finalH:ft});i._saveDims();this.scrollView()};r.scrollView=function(){var n=this.that,t=this.options,u=t.virtualX,f=t.virtualXHeader,e=t.virtualY,i,r;u||t.width==="flex"||n.$hscroll.pqScrollBar("drag");e||t.height==="flex"||n.$vscroll.pqScrollBar("drag");f===!1&&n.$hscroll&&(i=n.$hscroll.pqScrollBar("option"),r=parseInt(i.cur_pos),n.iMouseSelection.syncHeaderViewWithScrollBarHor(r))};r.setPaneEvents=function(){var r=this.that,c=r.$cont,u=r.pqpanes,i=c.children("div"),t=r.iMouseSelection,f=r.$tbl,e,o,s,h;if(f&&f.length)if(u.h&&u.v){var l=n(i[0]),a=n(i[1]),v=n(i[2]),y=n(i[3]);l.on("scroll",function(){this.scrollTop=0;this.scrollLeft=0});a.on("scroll",function(){this.scrollTop=0;this.scrollLeft=t.getScrollLeft()});v.on("scroll",function(){this.scrollTop=t.getScrollTop();this.scrollLeft=0});y.on("scroll",function(){this.scrollTop=t.getScrollTop();this.scrollLeft=t.getScrollLeft()})}else if(u.v){e=n(i[0]);o=n(i[1]);e.on("scroll",function(){this.scrollTop=t.getScrollTop();this.scrollLeft=0});o.on("scroll",function(){this.scrollTop=t.getScrollTop();this.scrollLeft=t.getScrollLeft()})}else if(u.h){s=n(i[0]);h=n(i[1]);s.on("scroll",function(){this.scrollTop=0;this.scrollLeft=t.getScrollLeft()});h.on("scroll",function(){this.scrollTop=t.getScrollTop();this.scrollLeft=t.getScrollLeft()})}else i.on("scroll",function(){this.scrollTop=t.getScrollTop();this.scrollLeft=t.getScrollLeft()})};r.setPanes=function(){var i=this.that,y=i.$cont,c=i.pqpanes,r=y.children("div"),v=i.iRefresh,e=i.$tbl,l=i.options,a=parseInt(l.freezeCols),p=i.initH,t,w,h;if(e&&e.length){var b=l.height==="flex",k=l.width==="flex",o=b?"":v.getEContHt(),s=k?"":v.getEContWd();if(c.h&&c.v){var d=n(r[0]),g=n(r[1]),nt=n(e[1]),tt=n(r[2]),it=n(e[2]),rt=n(r[3]),ut=n(e[3]),t=u.call(i,-1,a),h=i.calcHeightFrozenRows(),f=h-1;d.css({width:t,height:f});g.css({left:t,width:s-t,height:f});nt.css({left:-1*t});tt.css({width:t,top:f,height:o-f});it.css({marginTop:-h});rt.css({left:t,width:s-t,top:f,height:o-f});ut.css({marginTop:-h,left:-1*t})}else if(c.v){var ft=n(r[0]),et=n(r[1]),ot=n(e[1]),t=u.call(i,-1,a),w=u.call(i,a,p);ft.css({width:t,height:o});et.css({left:t,width:s-t,height:o});ot.css({left:-1*(w+t)})}else if(c.h){var st=n(r[0]),ht=n(r[1]),ct=n(e[1]),h=i.calcHeightFrozenRows(),f=h-1;st.css({height:f,width:s});ht.css({width:s,top:f,height:o-f});ct.css({marginTop:-h})}else r.css({width:s,height:o})}};r._generateTables=function(n,t,i){var r=this.that,h=r.colModel,ct=h.length,e=r.options,it=e.virtualX,y=r.initH,p=r.finalH,d=e.numberCell,rt=e.columnBorders,ut=e.rowBorders,ft=e.wrap,lt=e.scrollModel,c=e.groupModel,at=r.hidearrHS,et=e.freezeCols,ot=parseInt(e.freezeRows),l=!1,s=0,g=i?i.data.length-1:t,nt=c?!0:!1,vt=e.treeModel,tt=i&&i.data?i.data:nt?r.dataGM:r.pdata,st=r.rowIndxOffset,a,u,v,o,w,k;if(i||r._trigger("beforeTableView",null,{pageData:tt,initV:n,finalV:t,initH:y,finalH:p,colModel:h}),i||n!=null&&g!=null){if(a="pq-grid-table ",rt&&(a+="pq-td-border-right "),ut&&(a+="pq-td-border-bottom "),a+=ft?"pq-wrap ":"pq-no-wrap ",u=["<table class='"+a+"' cellpadding=0 cellspacing=0 >"],this.hidearrHS1=[],!0){for(u.push("<tr class='pq-row-hidden'>"),d.show&&(v=d.width+1,u.push("<td style='width:"+v+"px;' ><\/td>")),o=0;o<=p;o++){if(o<y&&o>=et&&(it||i)&&(o=y,o>p))throw"initH>finalH";(w=h[o],w.hidden)||(v=w.outerWidth,u.push("<td style='width:",v,"px;' pq-col-indx='",o,"'><\/td>"))}u.push("<\/tr>")}for(this.offsetRow=null,s=0;s<=g;s++){s<n&&s>=ot&&(s=n);var f=tt[s],b=nt?f.rowIndx-st:s,ht=f?f.pq_hidden:!1;ht||(l=r.lastFrozenRow===b,c&&f.groupTitle?this._generateTitleRow(c,f,u,l):c&&f.groupSummary?this._generateSummaryRow(c,f,h,u,l):(k=f.pq_detail&&f.pq_detail.show,this._generateRow(f,b,h,u,i,l,k),k&&this._generateDetailRow(f,b,h,u,i,l)))}return r.scrollMode=!1,u.push("<\/table>"),u.join("")}};r._renderCell=function(n,t){var d=this.that,s=this.options,u=n.rowData,h=n.column,c=h.type,l=h.dataIndx,f=u[l],i,o,a,e,r,y;if(u){if(t!=undefined?i=t:c=="checkBoxSelection"?i="<input type='checkbox' "+(f?"checked='checked'":"")+" />":c=="detail"?(o=s.detailModel,a=f&&f.show?o.expandIcon:o.collapseIcon,i="<div class='ui-icon "+a+"'><\/div>"):i=f,(i===""||i==undefined)&&(i="&nbsp;"),e="",n.tree&&(r=s.treeModel)&&r.labelIndx==l){var p=u.pq_leaf,w=u.pq_level,b=!u.pq_collapse,k=(w+1)*r.indent,v="";v=p?r.leafIcon:b?r.expandIcon+" pq-tree-expand-icon":r.collapseIcon+" pq-tree-expand-icon";y=["<div class='pq-tree-icon-container' style='width:",k,"px;'>","<div class='ui-icon ",v," pq-tree-icon' ><\/div><\/div>"].join("");e="<div class='"+cls+"'>"+y+i+"<\/div>"}else e=i;return e}};r.renderCell=function(n){var p=this.that,s=this.options,r=n.rowData,d=n.rowIndx,g=n.rowIndxPage,i=n.column,h=n.colIndx,u=i.dataIndx,nt=s.freezeCols,tt=s.columnBorders,w="pq-col-indx='"+h+"'",b=!1,t="pq-grid-cell ",c,l,k,a,v,y,f,e,o;if(i.align=="right"?t+=" pq-align-right":i.align=="center"&&(t+=" pq-align-center"),h==nt-1&&tt&&(t+=" pq-last-frozen-col"),c=i.cls,c&&(t=t+" "+c),l=r.pq_cellselect,l&&(b=l[u]),b&&(t=t+" pq-state-select ui-state-highlight"),i.render&&(k=i.render.call(p.element[0],{data:p.pdata,dataModel:s.dataModel,rowData:r,cellData:r[u],rowIndxPage:g,rowIndx:d,colIndx:h,column:i,dataIndx:u})),a=r.pq_cellcls,a&&(v=a[u],v&&(t+=" "+v)),y=r.pq_cellattr,y&&(f=y[u],f))for(e in f)o=f[e],e=="title"&&(o=o.replace(/\"/g,"&quot;")),w+=" "+e+'="'+o+'"';return["<td class='",t,"' ",w," >",this._renderCell(n,k),"<\/td>"].join("")};r.refreshRow=function(n,t,i){var u=this.that,r=u.pdata[n],f=u.lastFrozenRow===n,e=r.pq_detail&&r.pq_detail.show;this._generateRow(r,n,t,i,null,f,e)};r._generateRow=function(n,t,i,r,u,f,e){var s="pq-grid-row",v,l,y,p,a,c,o,w;f&&(s+=" pq-last-frozen-row");e&&(s+=" pq-detail-master");var b=this.that,h=this.options,g=h.freezeCols,nt=h.numberCell,tt=h.treeModel,it=tt.labelIndx?!0:!1,rt=h.virtualX,k=b.initH,d=b.finalH,ut=this.offset;if(h.stripeRows&&t/2==parseInt(t/2)&&(s+=" pq-grid-oddRow"),n.pq_rowselect&&(s+=" pq-row-select ui-state-highlight"),v=n.pq_rowcls,v!=null&&(s+=" "+v),l=n.pq_rowattr,y="",l)for(p in l)a=l[p],a=a.replace('"',"&quot;"),y+=p+'="'+a+'"';for(r.push("<tr pq-row-indx='",t,"' class='",s,"' ",y," >"),nt.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>",u?"&nbsp;":t+1,"<\/td>"].join("")),c={rowIndx:t+ut,rowIndxPage:t,rowData:n},o=0;o<=d;o++){if(o<k&&o>=g&&(rt||u)&&(o=k,o>d))throw"initH>finalH";(w=i[o],w.hidden)||(c.column=w,c.colIndx=o,c.tree=it,r.push(this.renderCell(c)))}return r.push("<\/tr>"),r};t={widgetEventPrefix:"pqgrid"};t.options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",distance:3,collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1e3}},colModel:null,columnBorders:!0,dataModel:{cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:2,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:n.ui.keyCode.ENTER,onSave:"next",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"textbox"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"100%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,scrollModel:{pace:"fast",horizontal:!0,lastColumn:"auto",autoFit:!1,theme:!1},selectionModel:{fireSelectChange:!1,type:"cell",mode:"block"},swipeModel:{on:!0,speed:20,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0};t._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"};n.extend(t.options,t._regional);t._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")};t._disable=function(){this.$disable==null&&(this.$disable=n("<div class='pq-grid-disable'><\/div>").css("opacity",.2).appendTo(this.element))};t._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)};t._destroy=function(){this.loading&&this.xhr.abort();this._destroyResizable();this._destroyDraggable();this._mouseDestroy();this.element.off(this.eventNamespace);n(window).unbind(this.eventNamespace);n(document).unbind(this.eventNamespace);this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()};t.destroy=function(){this._trigger("destroy");this._super();window.clearInterval(this._refreshEditorPosTimer);this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout);for(var t in this)delete this[t];n.fragments={}};t.collapse=function(n){var r=this,i=this.element,f=this.options,t=f.collapsible,e=t.$collapse.children("span"),u=function(){i.css("overflow","hidden");e.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n");i.hasClass("ui-resizable")&&i.resizable("destroy");r.$toolbar.pqToolbar("disable");t.collapsed=!0;t._collapsed=!0;t.animating=!1;r._trigger("collapse")};if(n=n?n:{},t._collapsed)return!1;t.htCapture=i.height();n.animate===!1?(i.height(23),u()):(t.animating=!0,i.animate({height:"23px"},function(){u()}))};t.expand=function(n){var i=this,r=this.element,e=this.options,t=e.collapsible,u=t.htCapture,o=t.$collapse.children("span"),f=function(){r.css("overflow","");t._collapsed=!1;t.collapsed=!1;i._refreshResizable();t.refreshAfterExpand&&i.refresh();o.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s");i.$toolbar.pqToolbar("enable");t.animating=!1;i._trigger("expand")};if(n=n?n:{},t._collapsed===!1)return!1;n.animate===!1?(r.height(u),f()):(t.animating=!0,r.animate({height:u},function(){f()}))};t._createCollapse=function(){var i=this,u=this.$top,f=this.options,t=f.collapsible,r;t.$stripe||(r=n("<div class='pq-slider-icon pq-no-capture'  ><\/div>").appendTo(u),t.$stripe=r);t.on?t.$collapse||(t.$collapse=n("<div style='float:left;margin-left:5px;' class='pq-collapse'><span class='ui-icon ui-icon-circle-triangle-n' style='float:left;'><\/span><\/div>").appendTo(t.$stripe).mouseover(function(){n(this).addClass("ui-state-hover")}).mouseout(function(){n(this).removeClass("ui-state-hover")}).click(function(){t.collapsed?i.expand():i.collapse()})):t.$collapse&&(t.$collapse.remove(),delete t.$collapse);t.collapsed&&!t._collapsed?i.collapse({animate:!1}):!t.collapsed&&t._collapsed&&i.expand({animate:!1});t.toggle?t.$toggle||(t.$toggle=n("<div style='float:left;' class='pq-max'><span class='ui-icon ui-icon-arrow-4-diag' style='float:left;'><\/span><\/div>").prependTo(t.$stripe).mouseover(function(){n(this).addClass("ui-state-hover")}).mouseout(function(){n(this).removeClass("ui-state-hover")}).click(function(){i.toggle()})):t.$toggle&&(t.$toggle.remove(),delete t.$toggle)};t._create=function(){var t=this,i=this.options,u,r,c,e,l,o;i.collapsible||(i.collapsible={on:!1,collapsed:!1});i.flexHeight&&(i.height="flex");i.flexWidth&&(i.width="flex");this.setEditorPosTimer();this.iGenerateView=new f(this);this.iRefresh=new n.paramquery.cRefresh(this);this.iKeyNav=new h(this);this.iIsValid=new s(this);this.hidearr=[];this.hidearrHS=[];this.tables=[];this.$tbl=null;this._calcThisColModel();this.iSort=new n.paramquery.cSort(this);this.iSort._refreshSorters();this.iHeader=new n.paramquery.cHeader(this);this._initTypeColumns();u=this.element;u.empty().addClass("pq-grid ui-widget ui-widget-content"+(i.roundCorners?" ui-corner-all":"")).html(["<div class='pq-grid-top ui-widget-header",i.roundCorners?" ui-corner-top":"","'>","<div class='pq-grid-title",i.roundCorners?" ui-corner-top":"","'>&nbsp;<\/div>","<\/div>","<div class='pq-grid-center' >","<div class='pq-header-outer ui-widget-header'>","<\/div>","<div class='pq-grid-cont-outer' >","<div class='pq-grid-cont' tabindex='0'><\/div>","<\/div>","<\/div>","<div class='pq-grid-bottom ui-widget-header",i.roundCorners?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'>&nbsp;<\/div>","<\/div>"].join(""));this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel});this.$top=n("div.pq-grid-top",u);this.$title=n("div.pq-grid-title",u);i.showTitle||this.$title.css("display","none");this.$toolbar=n("div.pq-grid-toolbar",u);this.$grid_inner=n("div.pq-grid-center",u);this.$header_o=n("div.pq-header-outer",this.$grid_inner);i.showTop||this.$top.css("display","none");this.$bottom=n("div.pq-grid-bottom",u);i.showBottom||this.$bottom.css("display","none");this.$footer=n("div.pq-grid-footer",u);this.$cont_o=n(".pq-grid-cont-outer",this.$grid_inner);r=this.$cont=n("div.pq-grid-cont",this.$grid_inner);n(window).bind("resize"+t.eventNamespace+" orientationchange"+t.eventNamespace,function(n,i){t.onWindowResize(n,i)});r.on("click","td.pq-grid-cell",function(i){if(n.data(i.target,t.widgetName+".preventClickEvent")!==!0)return n(i.target).closest(".pq-grid")[0]==t.element[0]?t._onClickCell(i):void 0});r.on("click","tr.pq-grid-row",function(i){if(n.data(i.target,t.widgetName+".preventClickEvent")!==!0)return n(i.target).closest(".pq-grid")[0]==t.element[0]?t._onClickRow(i):void 0});r.on("contextmenu","td.pq-grid-cell",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onRightClickCell(i)});r.on("contextmenu","tr.pq-grid-row",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onRightClickRow(i)});r.on("dblclick","td.pq-grid-cell",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onDblClickCell(i)});r.on("dblclick","tr.pq-grid-row",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onDblClickRow(i)});r.on("mousedown","td.pq-grid-cell",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onCellMouseDown(i)});r.on("mousedown","tr.pq-grid-row",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onRowMouseDown(i)});r.on("mousedown",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onContMouseDown(i)});r.on("mouseenter","td.pq-grid-cell",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onCellMouseEnter(i,n(this))});r.on("mouseenter","tr.pq-grid-row",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onRowMouseEnter(i,n(this))});r.on("mouseleave","td.pq-grid-cell",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onCellMouseLeave(i,n(this))});r.on("mouseleave","tr.pq-grid-row",function(i){if(n(i.target).closest(".pq-grid")[0]==t.element[0])return t._onRowMouseLeave(i,n(this))});r.bind("mousewheel DOMMouseScroll",function(n){return t._onMouseWheel(n)});c=0;this.$hvscroll=n("<div class='pq-hvscroll-square ui-widget-content'><\/div>").appendTo(this.$grid_inner);this.$vscroll=n("<div class='pq-vscroll'><\/div>").appendTo(this.$grid_inner);this.prevVScroll=0;e=i.scrollModel;e.lastColumn===undefined&&i.virtualX&&(e.lastColumn="auto");this.$vscroll.pqScrollBar({pace:e.pace,theme:e.theme,steps:i.virtualY,direction:"vertical",cur_pos:0,pageDown:function(){t.iKeyNav.pageDown()},pageUp:function(){t.iKeyNav.pageUp()},drag:function(n,r){var u=i.virtualY;u||t.iMouseSelection.syncViewWithScrollBarVert(r.ratio)},scroll:function(){var u=i.virtualY,n,r;u&&(t.scrollMode=!0,n=t.iRefresh,n.calcInitFinal(),t.iGenerateView.generateView(),r=n._setScrollVNumEles(),r<=1&&n.refreshScrollbars())}});l=0;o=this.$hscroll=n("<div class='pq-hscroll'><\/div>").appendTo(this.$grid_inner);i.height==="flex"&&o.css("position","relative");o.pqScrollBar({direction:"horizontal",pace:e.pace,theme:e.theme,steps:i.virtualX,cur_pos:0,drag:function(n,r){var u=i.virtualX;u||t.iMouseSelection.syncViewWithScrollBarHor(r.ratio)},scroll:function(n,r){var f=i.virtualX,u=i.virtualXHeader,e=u===!1?!1:!0;f&&t.refresh({header:e});u===!1&&t.iMouseSelection.syncHeaderViewWithScrollBarHor(r.cur_pos)}});i.selectionModel["native"]||this.disableSelection();window.opera?this.$grid_inner.bind("keypress.pq-grid",{that:this},function(i){n(i.target).closest(".pq-grid")[0]==t.element[0]&&t._onKeyPressDown(i)}):this.$grid_inner.bind("keydown.pq-grid",{that:this},function(i){n(i.target).closest(".pq-grid")[0]==t.element[0]&&t._onKeyPressDown(i)});this._refreshTitle();this.iRows=new n.paramquery.cRows(this);this.iCells=new n.paramquery.cCells(this);this.generateLoading();this._initPager();this._refreshResizable();this._refreshDraggable();this.iResizeColumns=new n.paramquery.cResizeColumns(this);this._mouseInit()};t.toggle=function(){var e=this.options,o=e.collapsible,i=this.element,u,f=n(document.body),t,r;i.css("position")=="fixed"?(t=this.maxim.eleObj,r=this.maxim.docObj,this.option({height:t.height,width:t.width}),i.css({position:t.position,left:t.left,top:t.top,margin:t.margin,zIndex:t.zIndex}),f.css({height:r.height,width:r.width,overflow:r.overflow}),n("html").css({overflow:"visible"}),window.scrollTo(r.scrollLeft,r.scrollTop),u="min"):(t={height:e.height,width:e.width,position:i.css("position"),left:i.css("left"),top:i.css("top"),margin:i.css("margin"),zIndex:i.css("zIndex")},this.option({height:"100%-2",width:"100%-2"}),i.css(n.extend({position:"fixed",left:0,top:0,margin:0},o.css)),r={height:f.height(),width:f.width(),overflow:f.css("overflow"),scrollLeft:n(window).scrollLeft(),scrollTop:n(window).scrollTop()},n(document.body).css({height:0,width:0,overflow:"hidden"}),n("html").css({overflow:"hidden"}),window.scrollTo(0,0),this.maxim={eleObj:t,docObj:r},u="max");this._trigger("toggle",null,{state:u});this._refreshResizable();this.refresh();n(window).trigger("resize",{$grid:i,state:u})};t._mouseCapture=function(t){var u=this,i=this.options,r;return i.virtualX&&i.virtualY?!1:t.target?n(t.target).closest(".pq-grid")[0]==this.element[0]?i.height=="flex"&&i.width=="flex"?!1:(r=i.swipeModel,r.on==!1||r.on=="touch"&&!n.support.touch)?!1:!0:!1:!1};t._saveDims=function(){var o=this.$cont,u=this.$tbl,f,r,t,i,e;if(u)for(t=0;t<u.length;t++)i=u[t],f=n(i),f.data("offsetHeight",Math.round(i.offsetHeight)),f.data("scrollWidth",Math.round(i.scrollWidth));if(r=this.$tbl_header,r)for(t=0;t<r.length;t++)i=r[t],e=n(i).parent(),e.data("offsetHeight",Math.round(i.offsetHeight)),e.data("scrollWidth",Math.round(i.scrollWidth))};t._mousePQUp=function(t){n(document).unbind("mouseup"+this.eventNamespace,this._mousePQUpDelegate);this._trigger("mousePQUp",t,null)};t._mouseDown=function(t){var i=this;if(n(t.target).closest(".pq-editor-focus").length){this._blurEditMode=!0;window.setTimeout(function(){i._blurEditMode=!1},0);return}return this._saveDims(),this._mousePQUpDelegate=function(n){return i._mousePQUp(n)},n(document).bind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._super(t)};t._mouseStart=function(){return this.blurEditor({force:!0}),!0};t._mouseDrag=function(n){return this._trigger("mouseDrag",n,null)==!1?!1:!0};t._mouseStop=function(n){return this._trigger("mouseStop",n,null)==!1?!1:!0};t.onWindowResize=function(t,i){var c=this.options,r=this.element,u=r.parent(),f,e,s;if((!i||(s=i.$grid,!s||s!=r&&r.closest(s).length!=0))&&u.length&&(u[0]==document.body||r.css("position")=="fixed"?(f=window.innerHeight?window.innerHeight:n(window).height(),e=n(window).width()):(f=u.height(),e=u.width()),o==null||f!=o||e!=l)&&(o=f,l=e,!n.support.touch||!c.editModel.indices||!n(document.activeElement).is(".pq-editor-focus"))){var a=this,h=c.autoSizeInterval,h=h===undefined?0:h;this.autoResizeTimeout&&(clearTimeout(this.autoResizeTimeout),delete this.autoResizeTimeout);this.autoResizeTimeout=window.setTimeout(function(){a._refreshAfterResize();delete a.autoResizeTimeout},h)}};t._onMouseWheel=function(n){var l,a,i;this._saveDims();var r=this.options,s=this,t=0,f=!1,n=n.originalEvent,e=n.wheelDeltaX,v=n.wheelDeltaY,h=n.wheelDelta;if(e&&Math.abs(e)>Math.abs(v)){if(r.width=="flex")return!0;f=!0;t=e/120}else if(h){if(r.height=="flex")return!0;t=h/120}else if(n.detail){if(r.height=="flex")return!0;t=n.detail/-3}var u=f?s.$hscroll:s.$vscroll,o=u.pqScrollBar("option"),c=parseInt(o.cur_pos),y=parseInt(o.num_eles);return f&&r.virtualX||!f&&r.virtualY?(t=t>0?Math[t<1?"ceil":"floor"](t):Math[t<-1?"ceil":"floor"](t),l=c-t,l>=0&&(u.pqScrollBar("option","cur_pos",c-t),u.pqScrollBar("scroll"))):(a=o.ratio,i=a-t/(y-1),i>1?i=1:i<0&&(i=0),u.pqScrollBar("option","ratio",i),u.pqScrollBar("drag")),!1};t._onDblClickCell=function(t){var i=this,e=n(t.currentTarget),o=i.getCellIndices({$td:e}),u=o.rowIndxPage,s=i.rowIndxOffset,f=u+s,r=o.colIndx;if(r!=null){if(i._trigger("cellDblClick",t,{$td:e,rowIndxPage:u,rowIndx:f,colIndx:r,column:i.colModel[r],rowData:i.pdata[u]})==!1)return!1;i.options.editModel.clicksToEdit>1&&this.isEditableRow({rowIndx:f})&&this.isEditableCell({colIndx:r,rowIndx:f})&&i.editCell({rowIndxPage:u,colIndx:r})}};t._onClickCont=function(){var n=this};t._onClickRow=function(t){var r=this,u=n(t.currentTarget),i=parseInt(u.attr("pq-row-indx")),e=r.rowIndxOffset,f=i+e,o,s;if(!isNaN(i))return(o={rowIndx:f,evt:t},s=this.options,r._trigger("rowClick",t,{$tr:u,rowIndxPage:i,rowIndx:f,rowData:r.pdata[i]})==!1)?!1:void 0};t._onRightClickRow=function(t){var r=this,u=n(t.currentTarget),i=parseInt(u.attr("pq-row-indx")),f=r.rowIndxOffset,e=i+f,o;if(!isNaN(i))return o=this.options,r._trigger("rowRightClick",t,{$tr:u,rowIndxPage:i,rowIndx:e,rowData:r.pdata[i]})==!1?!1:void 0};t._onDblClickRow=function(t){var i=this,u=n(t.currentTarget),r=parseInt(u.attr("pq-row-indx")),f=i.getRowIndxOffset(),e=r+f;if(i._trigger("rowDblClick",t,{$tr:u,rowIndxPage:r,rowIndx:e,rowData:i.pdata[r]})==!1)return!1};n.paramquery.getValueFromDataType=function(t,i,r){var u;if(i=="date")return u=Date.parse(t),isNaN(u)?"":r?u:t;if(i=="integer")u=parseInt(t);else if(i=="float")u=parseFloat(t);else return i=="bool"?(u=n.trim(t).toLowerCase(),u.length==0)?null:u=="true"||u=="yes"||u=="1"?!0:u=="false"||u=="no"||u=="0"?!1:Boolean(u):n.trim(t);return isNaN(u)||u==null?t==null?t:null:u};s=function(n){this.that=n};e=s.prototype;e._isValidCell=function(t){var p=this.that,s=t.column,h=s.validations,c,a,y;if(!h||!h.length)return{valid:!0};var i=t.value,w=s.dataType,u=function(t){return n.paramquery.getValueFromDataType(t,w,!0)},v=t.rowData;if(!v)throw"rowData required.";for(c=0;c<h.length;c++){var o=h[c],b=o.on,e=o.type,f=!1,l=o.msg,r=o.value;if(b!==!1&&(i==null&&typeof e!="function"?f=!1:e=="minLen"?(i=u(i),r=u(r),i.length>=r&&(f=!0)):e=="nonEmpty"?i!=null&&i!==""&&(f=!0):e=="maxLen"?(i=u(i),r=u(r),i.length<=r&&(f=!0)):e=="gt"?(i=u(i),r=u(r),i>r&&(f=!0)):e=="gte"?(i=u(i),r=u(r),i>=r&&(f=!0)):e=="lt"?(i=u(i),r=u(r),i<r&&(f=!0)):e=="lte"?(i=u(i),r=u(r),i<=r&&(f=!0)):e=="neq"?(i=u(i),r=u(r),i!==r&&(f=!0)):e=="regexp"?new RegExp(r).test(i)&&(f=!0):typeof e=="function"?(a={column:s,value:i,rowData:v,msg:l},y=e.call(p.element[0],a),y==!1?(f=!1,a.msg!=l&&(l=a.msg)):f=!0):f=!0,!f))return{valid:!1,msg:l,column:s,warn:o.warn,dataIndx:s.dataIndx,validation:o}}return{valid:!0}};e.isValidCell=function(t){var i=this.that,f=t.rowData,r=t.rowIndx,ft=t.value,g=t.valueDef,nt=t.column,h=i.options,et=t.allowInvalid,u=nt.dataIndx,ot=h.validation,st=h.warning,tt=h.editModel,it=tt.invalidClass,rt=tt.warnClass,ht=document.activeElement,l,d,ut,e,o;if(t.checkEditable&&i.isEditableCell({rowData:f,rowIndx:r,dataIndx:u})==!1)return{valid:!0};var s=this._isValidCell({column:nt,value:ft,rowData:f}),a=s.valid,v=s.warn,y=s.msg;if(a)i.data({rowData:f,dataIndx:u,data:"pq_valid"})&&(i.removeClass({rowData:f,rowIndx:r,dataIndx:u,cls:rt+" "+it}),i.removeData({rowData:f,dataIndx:u,data:"pq_valid"}));else var c=n.extend({},v?st:ot,s.validation),p=c.css,w=c.cls,b=c.icon,k=c.style;if(et||v)return a?{valid:!0}:(i.addClass({rowData:f,rowIndx:r,dataIndx:u,cls:v?rt:it}),i.data({rowData:f,dataIndx:u,data:{pq_valid:{css:p,icon:b,style:k,msg:y,cls:w}}}),s);if(!a){if(r=r==null?i.getRowIndx({rowData:f}).rowIndx:r,r==null)return s;if(g){if(n(ht).hasClass("pq-editor-focus")&&(l=h.editModel.indices,l)){if(d=l.rowIndx,ut=l.dataIndx,r!=null&&r!=d)throw"incorrect usage of isValid rowIndx: "+r;if(u!=ut)throw"incorrect usage of isValid dataIndx: "+u;i.editCell({rowIndx:d,dataIndx:u})}}else i.goToPage({rowIndx:r}),i.editCell({rowIndx:r,dataIndx:u});if(e=i.getEditCell(),e&&e.$cell){o=e.$cell;o.attr("title",y);try{o.tooltip("destroy")}catch(ct){}o.tooltip({position:{my:"left center+5",at:"right center"},content:function(){var n=b==""?"":"<span class='ui-icon "+b+" pq-tooltip-icon'><\/span>";return n+y},open:function(n,t){if(w&&t.tooltip.addClass(w),k){var i=t.tooltip.attr("style");t.tooltip.attr("style",i+";"+k).css("zIndex",o.zIndex()+5)}p&&t.tooltip.css(p)}}).tooltip("open")}return s}if(g&&(e=i.getEditCell(),e&&e.$cell)){o=e.$cell;o.removeAttr("title");try{o.tooltip("destroy")}catch(ct){}}return{valid:!0}};t.isValid=function(n){return this.iIsValid.isValid(n)};e.isValid=function(n){var f=this.that,n=n||{},t=n.allowInvalid,h=n.checkEditable,t=t==null?!1:t,s=n.dataIndx,e,b,l,r,u,c,i,v,a;if(s!=null){var e=f.columns[s],i=n.rowData||f.getRowData(n),y=n.hasOwnProperty("value"),p=y?n.value:i[s],o=this.isValidCell({rowData:i,checkEditable:h,rowIndx:n.rowIndx,value:p,valueDef:y,column:e,allowInvalid:t});return o.valid||o.warn?{valid:!0}:o}if(n.rowIndx!=null||n.rowIndxPage!=null||n.rowData!=null){var i=n.rowData||f.getRowData(n),w=f.colModel,r=[];for(u=0,c=w.length;u<c;u++)if(e=w[u],b=e.hidden,!b){var s=e.dataIndx,p=i[s],o=this.isValidCell({rowData:i,value:p,column:e,rowIndx:n.rowIndx,checkEditable:h,allowInvalid:t});if(!o.valid&&!o.warn)if(t)r.push({rowData:i,dataIndx:s,column:e});else return o}return t&&r.length?{cells:r,valid:!1}:{valid:!0}}if(l=n.data?n.data:f.options.dataModel.data,r=[],!l)return null;for(u=0,c=l.length;u<c;u++)if(i=l[u],!h||(v=this.getRowIndx({rowData:i}).rowIndx,f.isEditableRow({rowData:i,rowIndx:v})!=!1))if(a=this.isValid({rowData:i,rowIndx:v,checkEditable:h,allowInvalid:t}),t===!1){if(!a.valid)return a}else r=r.concat(a.cells);return t&&r.length?{cells:r,valid:!1}:{valid:!0}};t.isEditableRow=function(n){var u=this.options,t=u.editable,i,r;return t!=null?typeof t=="function"?(i=n.rowIndx,r=n.rowData||this.getRowData({rowIndx:i}),t.call(this.element[0],{rowData:r,rowIndx:i})):t:!0};t.isEditableCell=function(n){var u=n.colIndx,t=n.dataIndx,u=u==null?this.getColIndx({dataIndx:t}):u,i=this.colModel[u],t=t==null?i.dataIndx:t,r=i.editable,f,e;return n.checkVisible&&i.hidden?!1:r!=null?typeof r=="function"?(f=n.rowIndx,e=n.rowData||this.getRowData(n),r.call(this.element[0],{rowIndx:f,rowData:e,column:i,dataIndx:t})):r:!0};t._getRowPQData=function(n,t,i){var i=i==null?this.pdata[n]:i;return i?i[t]:null};t._setRowPQData=function(n,t,i){var i=i==null?this.pdata[n]:i,r;if(i)for(r in t)i[r]=t[r]};t._onContMouseDown=function(t){this.blurEditor({blurIfFocus:!0});var i=this,u=i.options.dataModel,f={dataModel:u};if(i._trigger("contMouseDown",t,f)===!1)return!1;var r=n(t.target),e=r.closest(".pq-grid-cell"),o=r.closest(".pq-grid-row");return e.length||o.length||this.$cont.attr("tabindex",0).focus(),!0};t._onCellMouseDown=function(t){var i=this,u=n(t.currentTarget),r=i.getCellIndices({$td:u});return(r.$td=u,r.dataModel=i.options.dataModel,i._trigger("cellMouseDown",t,r)==!1)?!1:!0};t._onRowMouseDown=function(t){var i=this,u=n(t.currentTarget),r=i.getRowIndx({$tr:u});return(r.$tr=u,r.dataModel=i.options.dataModel,i._trigger("rowMouseDown",t,r)==!1)?!1:!0};t._onCellMouseEnter=function(n,t){var r=t,f=this.options,i=this.getCellIndices({$td:r}),u=this;if(i.rowIndx!=null&&i.colIndx!=null)return u._trigger("cellMouseEnter",n,i)===!1?!1:(f.hoverMode=="cell"&&u.highlightCell(r),!0)};t._onRowMouseEnter=function(n,t){var u=t,f=this.options,i=this,r=i.getRowIndx({$tr:u}),e=r.rowIndxPage;return i._trigger("rowMouseEnter",n,r)===!1?!1:(f.hoverMode=="row"&&i.highlightRow(e),!0)};t._onCellMouseLeave=function(n,t){var r=t,i=this;return i.options.hoverMode=="cell"&&i.unHighlightCell(r),!0};t._onRowMouseLeave=function(n,t){var r=t,i=this,u=i.getRowIndx({$tr:r}),f=u.rowIndxPage;return i.options.hoverMode=="row"&&i.unHighlightRow(f),!0};t.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)};t.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(t){var r=t.target,i;if(r){if((i=n(t.target),i.is("input,textarea,select"))||i.closest(".pq-native-select").length)return!0;t.preventDefault()}})};t._onCellMouseUp=function(t){var i=this,u=n(t.currentTarget),r=i.getCellIndices({$td:u});return(r.$td=u,r.dataModel=i.options.dataModel,i._trigger("cellMouseUp",t,r)==!1)?!1:!0};t._onRowMouseUp=function(t){var i=this,r=n(t.currentTarget),u=i.getRowIndx({$tr:r});return i._trigger("rowMouseUp",t,u)==!1?!1:!0};t._onClickCell=function(t){var r=this,h=this.options,l=this.colModel,a=h.editModel,y=h.selectionModel,c=n(t.currentTarget),i=r.getCellIndices({$td:c}),e=i.rowIndxPage,v=r.rowIndxOffset,u=e+v,f=i.colIndx,o,s;if(i.rowIndx=u,f!=null){if(o=l[f],s=o.dataIndx,i.dataIndx=s,i.evt=t,r._trigger("cellClick",t,{$td:c,rowIndxPage:e,rowIndx:u,colIndx:f,dataIndx:s,column:o,rowData:r.pdata[e]})==!1)return!1;if(a.clicksToEdit==1&&this.isEditableRow({rowIndx:u})&&this.isEditableCell({colIndx:f,rowIndx:u})){r.editCell(i);return}}};t._onRightClickCell=function(t){var f=n(t.currentTarget),e=this.getCellIndices({$td:f}),s=this,i=e.rowIndxPage,h=this.rowIndxOffset,c=i+h,r=e.colIndx,l=this.colModel,a=this.options,v=a.DM,u,o;if(r!=null)return u=l[r],o=u.dataIndx,this._trigger("cellRightClick",t,{$td:f,rowIndxPage:i,rowIndx:c,colIndx:r,dataIndx:o,column:u,rowData:s.pdata[i]})==!1?!1:void 0};t.highlightCell=function(n){n.addClass("pq-grid-cell-hover ui-state-hover")};t.unHighlightCell=function(n){n.removeClass("pq-grid-cell-hover ui-state-hover")};t.highlightRow=function(n){if(!isNaN(n)){var t=this.getRow({rowIndxPage:n});t&&t.addClass("pq-grid-row-hover ui-state-hover")}};t.unHighlightRow=function(n){if(!isNaN(n)){var t=this.getRow({rowIndxPage:n});t&&t.removeClass("pq-grid-row-hover ui-state-hover")}};t._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}};t._findCellFromEvt=function(t){var u=n(t.target),i=u.closest(".pq-grid-cell"),r;return i==null||i.length==0?{rowIndxPage:null,colIndx:null,$td:null}:(r=this.getCellIndices({$td:i}),r.$td=i,r)};t._initPager=function(){var t=this.options.pageModel,n=this,i={change:function(t,i){n.blurEditor({force:!0});var r=n.options.pageModel;i.curPage!=undefined&&(r.prevPage=r.curPage,r.curPage=i.curPage);i.rPP!=undefined&&(r.rPP=i.rPP);r.type=="remote"?n.remoteRequest({callback:function(){n._onDataAvailable({apply:!0,header:!1})}}):n.refreshView({header:!1})},refresh:function(){n.refreshDataAndView()}};t.type&&this.$footer.pqPager(i)};t.generateLoading=function(){this.$loading&&this.$loading.remove();this.$loading=n("<div class='pq-loading'><\/div>").appendTo(this.element);n(["<div class='pq-loading-bg'><\/div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...<\/div><\/div>"].join("")).appendTo(this.$loading);this.$loading.find("div.pq-loading-bg").css("opacity",.2)};t._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)};t.showLoading=function(){this.showLoadingCounter==null&&(this.showLoadingCounter=0);this.showLoadingCounter++;this.$loading.show()};t.hideLoading=function(){this.showLoadingCounter>0&&this.showLoadingCounter--;this.showLoadingCounter||this.$loading.hide()};t.refreshDataFromDataModel=function(){var e,f,i;this._trigger("beforeRefreshData",null,{});var u=this.options,o=u.dataModel,n=u.pageModel,t=o.data,r=n.type;if(this.rowIndxOffset=0,t==null||t.length==0){r&&(n.curPage=0,n.totalPages=0,n.totalRecords=0);this.pdata=t;return}r&&r=="local"?(n.totalRecords=t.length,n.totalPages=Math.ceil(t.length/n.rPP),n.curPage>n.totalPages&&(n.curPage=n.totalPages),n.curPage<1&&n.totalPages>0&&(n.curPage=1),e=(n.curPage-1)*n.rPP,i=n.curPage*n.rPP,i>t.length&&(i=t.length),this.pdata=t.slice(e,i)):r=="remote"?(f=Math.ceil(n.totalRecords/n.rPP),n.totalPages=f,f&&!n.curPage&&(n.curPage=1),i=n.rPP,i>t.length&&(i=t.length),this.pdata=t.slice(0,i)):this.pdata=u.backwardCompat?t.slice(0):t;(r=="local"||r=="remote")&&(this.rowIndxOffset=n.rPP*(n.curPage-1))};n.paramquery.filter=function(){var n={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}};return{conditions:n,getAllConditions:function(){var t=[];for(var i in n)t.push(i);return t}(),getConditions:function(t){var i=[];for(var r in n)n[r][t]&&i.push(r);return i},getTRConditions:function(){var t=[];for(var i in n)n[i].TR&&t.push(i);return t}(),getWTRConditions:function(){var t=[];for(var i in n)n[i].TR||t.push(i);return t}()}}();n.paramquery.filter.rules={};n.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"};t.getQueryStringSort=function(){var n=this.iSort.sorters,i="",r=this.options,f=r.sql,e=r.stringify,t;if(f){for(t=0;t<n.length;t++){var u=n[t],o=u.dataIndx,s=u.dir=="up"?"asc":"desc";i+=(t>0?", ":"")+o+" "+s}return i}return n.length?e===!1?n:JSON.stringify(n):""};t.getQueryStringCRUD=function(){return""};t.getQueryStringFilter=function(){var o=this.options,a=o.sql,v=o.stringify,s=o.filterModel,l=s.mode,y=this.colModel,f=this.getFilterData({CM:y,location:"remote"}),t="",e,c;if(s&&s.on&&f)if(a){for(t=[],e=0;e<f.length;e++){var h=f[e],i=h.condition,r=h.dataIndx,u=n.trim(h.value);i==="contain"?t.push(r+" like '%"+u+"%'"):i==="notcontain"?t.push(r+" not like '%"+u+"%'"):i==="begin"?t.push(r+" like '"+u+"%'"):i==="end"?t.push(r+" like '%"+u+"'"):i==="equal"?t.push(r+"='"+u+"'"):i==="notequal"?t.push(r+"!='"+u+"'"):i==="empty"?t.push("isnull("+r+",'')=''"):i==="notempty"?t.push("isnull("+r+",'')!=''"):i==="less"?t.push(r+"<'"+u+"'"):i==="great"&&t.push(r+">'"+u+"'")}t=t.join(" "+l+" ")}else f.length?(c={mode:l,data:f},t=v===!1?c:JSON.stringify(c)):t="";return t};t.remoteRequest=function(t){var p,f,a,v,e,d;this.loading&&this.xhr.abort();var u=this,o="",c="",s=this.options,y=!1,h=this.colModel,i=s.dataModel,l=s.filterModel,r=s.pageModel;if(typeof i.getUrl=="function")p={colModel:h,dataModel:i,groupModel:s.groupModel,pageModel:r,filterModel:l},f=i.getUrl.call(this.element[0],p),f&&f.url&&(o=f.url),f&&f.data&&(c=f.data);else if(typeof i.url=="string"){o=i.url;var w={},b={},k={};i.sorting=="remote"&&(a=this.getQueryStringSort(),a&&(w={pq_sort:a}));r.type=="remote"&&(k={pq_curpage:r.curPage,pq_rpp:r.rPP});l.type!="local"&&(v=this.getQueryStringFilter(),v&&(y=!0,b={pq_filter:v}));e=i.postData;d=i.postDataOnce;e&&typeof e=="function"&&(e=e.call(this.element[0],{colModel:h,dataModel:i}));c=n.extend({pq_datatype:i.dataType},b,k,w,e,d)}o&&(this.loading=!0,this.showLoading(),this.xhr=n.ajax({url:o,dataType:i.dataType,async:i.async==null?!0:i.async,cache:i.cache,contentType:i.contentType,type:i.method,data:c,beforeSend:function(n,t){if(typeof i.beforeSend=="function")return i.beforeSend.call(u.element[0],n,t)},success:function(n,f,e){if(typeof i.getData=="function"){var o=i.getData.call(u.element[0],n,f,e);i.data=o.data;r.type&&r.type=="remote"&&(o.curPage&&(r.curPage=o.curPage),o.totalRecords&&(r.totalRecords=o.totalRecords))}else i.data=n.data,r.type&&r.type=="remote"&&(n.curPage&&(r.curPage=n.curPage),n.totalRecords&&(r.totalRecords=n.totalRecords));u.hideLoading();u.loading=!1;t&&t.callback&&t.callback();u._trigger("load",null,{dataModel:i,colModel:h});y&&u._trigger("filter",null,{type:"remote",dataModel:i,colModel:h,filterModel:l})},error:function(n,t,r){if(u.hideLoading(),u.loading=!1,typeof i.error=="function")i.error.call(u.element[0],n,t,r);else if(r!="abort")throw"Error : "+r;}}))};t._refreshTitle=function(){this.$title.html(this.options.title)};t._destroyDraggable=function(){var t=this.element,n=t.parent(".pq-wrapper");n.length&&n.data("draggable")&&(n.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),t.unwrap(".pq-wrapper"))};t._refreshDraggable=function(){var r=this.options,n=this.element,t=this.$title,i;r.draggable?(t.addClass("pq-draggable pq-no-capture"),i=n.parent(".pq-wrapper"),i.length||n.wrap("<div class='pq-wrapper' />"),n.parent(".pq-wrapper").draggable({handle:t})):this._destroyDraggable()};t._refreshResizable=function(){var f=this,r=this.element,t=this.options,e=(t.width+"").indexOf("%")>-1,o=(t.height+"").indexOf("%")>-1,s=t.width=="auto",h=t.width=="flex",c=t.height=="flex",i,u,l;!t.resizable||(c||o)&&(h||e||s)?this._destroyResizable():(i="e,s,se",c||o?i="e":(h||e||s)&&(i="s"),u=!0,r.hasClass("ui-resizable")&&(l=r.resizable("option","handles"),i==l?u=!1:this._destroyResizable()),u&&r.resizable({helper:"ui-state-default",handles:i,minWidth:t.minWidth,minHeight:t.minHeight?t.minHeight:100,delay:0,start:function(t,i){n(i.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(){},stop:function(){var i=f.element,r=t.width,e=t.height,o=(r+"").indexOf("%")>-1,s=(e+"").indexOf("%")>-1,h=r=="auto",c=r=="flex",l=e=="flex",u=!1;s||l||(u=!0,t.height=i.height());o||h||c||(u=!0,t.width=i.width());f.refresh();i.css("position","relative");u&&n(window).trigger("resize")}}))};t._refreshAfterResize=function(){var n=this.options,t=n.width,i=n.height,r=(t+"").indexOf("%")!=-1?!0:!1,u=t==="auto",f=(i+"").indexOf("%")!=-1?!0:!1;(r||u||f)&&this.refresh()};t.refresh=function(n){this.iRefresh._refresh(n)};t._refreshDataIndices=function(){for(var i,n,o,s=this.getDataType()=="JSON"?!0:!1,u={},f={},r={},e=this.colModel,h=e.length,t=0;t<h;t++)i=e[t],n=i.dataIndx,n==null&&(n=s?"dataIndx_"+t:t,i.dataIndx=n),u[n]=i,f[n]=t,o=i.validations,o&&(r[n]=r);this.columns=u;this.colIndxs=f;this.validations=r};t.refreshView=function(n){this.options.editModel.indices!=null&&this.blurEditor({force:!0});this.refreshDataFromDataModel();this.refresh(n)};t._refreshPager=function(){var t=this.options,i=t.pageModel,n=this.$footer,u=i.type?!0:!1,f=i.rPP,e=i.totalRecords,r;u?(r=t.pageModel,n.hasClass("pq-pager")==!1&&this._initPager(),n.pqPager("option",r),e>f&&this.$bottom.css("display","")):(n.hasClass("pq-pager")&&n.pqPager("destroy"),t.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none"))};t.getInstance=function(){return{grid:this}};t._addRowsData=function(n){var r=n.data,i=this.options.dataModel.data,u=n.rowIndx,t,f,e;if(i==null&&(i=[]),u==null)for(t=0,f=r.length;t<f;t++)e=r[t],i.push(e);else if(u<i.length)for(t=0,f=r.length;t<f;t++)e=r[t],i.splice(u,0,e),u++;else return!1;return!0};t.addRows=function(n){return this._addRowsData(n)?(this.refreshDataFromDataModel(),this.refresh(),!0):!1};t.refreshDataAndView=function(n){var i=this.options.dataModel,t;this.iSort._refreshSorters();i.location=="remote"?(t=this,this.remoteRequest({callback:function(){t._onDataAvailable(n)}})):this._onDataAvailable(n)};t.getColIndx=function(n){var r=n.dataIndx,i,t,u;if(r===undefined)throw"dataIndx NA";for(i=this.colModel,t=0,u=i.length;t<u;t++)if(i[t].dataIndx==r)return t};t.getColumn=function(n){if(n.dataIndx==null)throw"dataIndx N/A";return this.columns[n.dataIndx]};t._onDataAvailable=function(){};t._setOption=function(n,t){var u=this.options,i,r;n==="height"?(t==="flex"?(i=this.$vscroll,t&&i&&i.hasClass("pq-sb-vert")&&(u.virtualY?i.pqScrollBar("option","cur_pos",0):i.pqScrollBar("option","ratio",0)),this.$hscroll.css("position","relative")):u.height==="flex"&&this.$hscroll.css("position",""),this._super(n,t)):n==="width"&&t=="flex"?(this._super(n,t),r=this.$hscroll,t&&r&&r.hasClass("pq-sb-horiz")&&(u.virtualX?r.pqScrollBar("option","cur_pos",0):r.pqScrollBar("option","ratio",0))):n=="title"?(this._super(n,t),this._refreshTitle()):n=="roundCorners"?(this._super(n,t),t?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"))):n=="freezeCols"?(t=parseInt(t),!isNaN(t)&&t>=0&&t<=this.colModel.length-2&&this._super(n,t)):n=="freezeRows"?(t=parseInt(t),!isNaN(t)&&t>=0&&this._super(n,t)):n=="resizable"?(this._super(n,t),this._refreshResizable()):n=="draggable"?(this._super(n,t),this._refreshDraggable()):n=="scrollModel"?this._super(n,t):n=="dataModel"?this._super(n,t):n=="pageModel"?this._super(n,t):n==="selectionModel"?this._super(n,t):n==="colModel"||n=="columnTemplate"?(this._super(n,t),this._calcThisColModel()):n==="disabled"?(this._super(n,t),t===!0?this._disable():this._enable()):n==="numberCell"?(this._super(n,t),this.iRefresh.decidePanes()):n==="strLoading"?(this._super(n,t),this._refreshLoadingString()):n==="showTop"?(this._super(n,t),t===!0?this.$top.css("display",""):this.$top.css("display","none")):n==="showTitle"?(this._super(n,t),t===!0?this.$title.css("display",""):this.$title.css("display","none")):n==="showToolbar"?(this._super(n,t),t===!0?this.$toolbar.css("display",""):this.$toolbar.css("display","none")):n=="toolbar"?(this._super(n,t),this.$toolbar.remove(),this._super(n,t),this._createToolbar()):n==="collapsible"?(this._super(n,t),this._createCollapse()):n==="showBottom"?(this._super(n,t),t===!0?this.$bottom.css("display",""):this.$bottom.css("display","none")):this._super(n,t)};t._generateCellRowOutline=function(){var u=this.options,r=u.editModel,t,f,i;if(this.$div_focus){if(u.debug)throw"this.$div_focus already present assert failed";return}t=this.element;r.inline&&(t=this.getCell(r.indices),t.css("padding",0).empty());this.$div_focus=n("<div class='pq-editor-outer'><div class='pq-editor-inner'><\/div><\/div>").appendTo(t);this.$div_focus.css("zIndex",t.zIndex()+5);f=n.extend({all:!0},r.indices);i=this.getCell(f);i.css("height",i.height());i.empty();this.refreshEditorPos()};t._removeCellRowOutline=function(){function f(n){n.hasClass("hasDatepicker")&&n.datepicker("hide").datepicker("destroy")}var t,r,i,u;this.$div_focus&&(t=this.$div_focus.find(".pq-editor-focus"),f(t),t[0]==document.activeElement&&(r=this._blurEditMode,this._blurEditMode=!0,t.blur(),this._blurEditMode=r),this.$div_focus.remove(),delete this.$div_focus,i=this.options.editModel,u=n.extend({},i.indices),i.indices=null,this.refreshCell(u))};t.refreshEditorPos=function(){var f=this.options,i=f.editModel,n=i.cellBorderWidth,e=this.$div_focus,t=this.getCell(i.indices);if(!t)return!1;var o=t[0].offsetWidth-(n?n*2:1),s=t[0].offsetHeight-(n?n*2:1),r=this.element.offset(),u=t.offset(),h=u.left-r.left-1,c=u.top-r.top-1;e.css({height:s,width:o,borderWidth:n,left:h,top:c})};t.setEditorPosTimer=function(){var n=this,t=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null);this._refreshEditorPosTimer=window.setInterval(function(){var i=t.editModel;i.indices&&n.refreshEditorPos()},200)};t._selectRow=function(n,t){this.selectRow(n,t)};t._findfirstUnhiddenColIndx=function(){for(var n=0;n<this.colModel.length;n++)if(!this.colModel[n].hidden)return n};t.selectRow=function(n){var t=n.evt;if(t&&(t.type=="keydown"||t.type=="keypress")){if(this.iRows.replace(n)==!1)return!1}else if(this.iRows.add(n)==!1)return!1;return!0};t.get$Tbl=function(t,i){var r=this.$tbl,u=[];if(r&&r.length){var e=this.pqpanes,s=this.options,f=s.freezeRows,o=s.freezeCols;return e.h&&e.v?i==null?t>=f?u.push(r[2],r[3]):u.push(r[0],r[1]):u=i>=o&&t>=f?r[3]:i<o&&t>=f?r[2]:i>=o&&t<f?r[1]:r[0]:u=e.v?i==null?r:i>=o?r[1]:r[0]:e.h?t>=f?r[1]:r[0]:r[0],u?n(u):void 0}};t.scrollCell=function(n){this.scrollRow(n);this.scrollColumn(n)};t.scrollY=function(n){this.$vscroll.pqScrollBar("option","cur_pos",n).pqScrollBar("scroll")};t.scrollRow=function(n){var t=this.options;if(!this.pdata||n.rowIndxPage>=this.pdata.length||t.height==="flex")return!1;t.virtualY?this._scrollRowVirtual(n):this.iMouseSelection.scrollRowNonVirtual(n)};t._scrollRowVirtual=function(n){var tt=this.options,r=n.rowIndxPage,it=this.iHierarchy?!0:!1,rt=n.rowIndx,l=this.scrollCurPos,r=r==null?rt-this.rowIndxOffset:r,a=parseInt(tt.freezeRows),i,u,o,y,e,s;if(!(r<a)&&(i=this._calcCurPosFromRowIndxPage(r),i!=null)){if(i<l&&this.$vscroll.pqScrollBar("option","cur_pos",i).pqScrollBar("scroll"),u=this.get$Tbl(r),!u||!u.length)return null;var f=u.children("tbody").children("tr[pq-row-indx="+r+"]"),h=f.last(),v=h;if(f.length>1&&(v=f.first()),o=h[0],y=parseInt(u.css("marginTop")),o==undefined)this.$vscroll.pqScrollBar("option","cur_pos",i).pqScrollBar("scroll");else{var p=o.offsetTop+o.offsetHeight,w=this.$cont[0].offsetHeight,b=y,k=this._getSBHeight(),d=v.prev("tr");if(d.hasClass("pq-row-hidden")||d.hasClass("pq-last-frozen-row"))return;if(p>w-k-b){var g=p-(w-k-b),f=u.children().children("tr"),c=0,nt=0,t;a?(t=f.filter("tr.pq-last-frozen-row").last().next(),t.length==0&&(t=f.filter("tr.pq-row-hidden").next())):t=f.filter("tr.pq-row-hidden").next();do{if(c+=t[0].offsetHeight,t[0]==h[0])break;else if(it&&t.hasClass("pq-detail-child")!=!1){if(c>=g)break}else if(nt++,c>=g)break;t=t.next()}while(1);e=l+nt;e>i&&(e=i);s=this.$vscroll.pqScrollBar("option","num_eles");s<e+1&&(s=e+1);this.$vscroll.pqScrollBar("option",{num_eles:s,cur_pos:e}).pqScrollBar("scroll")}}}};t.blurEditor=function(n){if(this.$div_focus){var t=this.$div_focus.find(".pq-editor-focus");if(n&&n.blurIfFocus)document.activeElement==t[0]&&t.blur();else return t.triggerHandler("blur",n)}};t._scrollColumnVirtual=function(n){var t=n.colIndx,t=t==null?this.getColIndx({dataIndx:n.dataIndx}):t,r=this.options.freezeCols,l=this._calcRightEdgeCol(t).width,a=this._getSBWidth(),o=this.$cont[0].offsetWidth-a,i,e,c;if(l>o){var v=u.call(this,-1,t+1)-o,s=this.colModel,y=s.length,h=0,f=0;for(i=r;i<y;i++)if(e=s[i],e.hidden||(h+=e.outerWidth),i==t){f=i-r-this._calcNumHiddenUnFrozens(i);break}else if(h>=v){f=i-r-this._calcNumHiddenUnFrozens(i)+1;break}return this.$hscroll.pqScrollBar("option","cur_pos",f).pqScrollBar("scroll"),!0}return this.hidearrHS[t]?(this.hidearrHS[t]=!1,c=t-r-this._calcNumHiddenUnFrozens(t),this.$hscroll.pqScrollBar("option","cur_pos",c).pqScrollBar("scroll"),!0):!1};t.scrollColumn=function(n){var t=this.options,i=t.virtualX;return t.width==="flex"?!1:i?this._scrollColumnVirtual(n):this.iMouseSelection.scrollColumnNonVirtual(n)};t.selection=function(n){var t=n.method,i=n.type;return i=="row"?this.iRows[t](n):i=="cell"?this.iCells[t](n):void 0};t._bringPageIntoView=function(n){var t=n.rowIndx,o=this,i=this.options.pageModel;if(i.type=="local"&&t>=0){var u=i.curPage,r=i.rPP,f=(u-1)*r,e=u*r;t>=f&&t<e||(i.curPage=Math.ceil((t+1)/r),this.refreshDataFromDataModel(),this.refresh())}};t.goToPage=function(n){var t=this.options.pageModel;if(t.type=="local"||t.type=="remote"){var r=n.rowIndx,u=t.rPP,i=n.page==null?Math.ceil((r+1)/u):n.page,f=t.curPage;i!=f&&(t.curPage=i,t.type=="local"?(this.refreshDataFromDataModel(),this.refresh()):this.refreshDataAndView())}};t.setSelection=function(n){var u,t,r,f,i,o;if(n==null)return this.iRows.removeAll({raiseEvent:!0}),this.iCells.removeAll({raiseEvent:!0}),!1;if(u=this.pdata,n.rowData)f=this.getRowIndx(n),t=f.rowIndx;else var e=this.rowIndxOffset,t=n.rowIndx,r=n.rowIndxPage,t=t==null?r+e:t;return(i=n.colIndx==null&&n.dataIndx!==undefined?this.getColIndx({dataIndx:n.dataIndx}):n.colIndx,o=n.evt,t<0||i<0||i>=this.colModel.length)?!1:u==null||u.length==0?!1:(n.rowIndx=t,n.colIndx=i,this._bringPageIntoView(n),r=t-this.rowIndxOffset,n.rowIndxPage=r,this.scrollRow({rowIndxPage:r}),i==null?this._selectRow(n):(this.scrollColumn({colIndx:i}),this.selectCell(n)))};t.getColModel=function(){return this.colModel};t.saveEditCell=function(t){var s=this.options,v=s.editModel,i,c,l,e,a,k,o;if(!v.indices)return null;var y=n.extend({},v.indices),p=t?t.evt:null,d=this.rowIndxOffset,g=y.colIndx,r=y.rowIndxPage,w=r+d,nt=this.colModel,b=nt[g],h=b.dataIndx,f=this.pdata[r],tt=s.dataModel,u;if(f==null)return null;if(r!=null){if(i=this.getEditCellData(),n.isPlainObject(i)){u={};for(c in i)u[c]=f[c]}else u=f[h];if(i=="<br>"&&(i=""),u==null&&i===""&&(i=null),l={rowIndx:w,rowIndxPage:r,dataIndx:h,column:b,newVal:i,value:i,oldVal:u,rowData:f,dataModel:tt},this._trigger("cellBeforeSave",p,l)===!1)return!1;if(1){if(e={},a=!1,n.isPlainObject(i)?(e=i,a=!0):e[h]=i,k=this.updateRow({row:e,rowIndx:w,refresh:a,silent:!0,source:"edit",checkEditable:!1}),k===!1)return!1;this._trigger("cellSave",p,l);o=this;s.height=="flex"?(o.iRefresh.setContAndGridHeightFromTable(),o._fixIEFooterIssue()):t&&o.scrollRow({rowIndxPage:r})}return!0}};t._addInvalid=function(){};t._digestData=function(t){var k,ut,kt,c,dt,ni,y,h,i,v,g,nt,lt;if(this._trigger("beforeValidate",null,t)===!1)return!1;var l=this,e=l.options,et=e.editModel,at=e.dataModel,p=at.data,vt=e.colModel,ot=e.pageModel,ii=e.historyModel,st=t.validate,st=st==null?et.validate:st,tt=ot.type,w=t.allowInvalid,w=w==null?et.allowInvalid:w,oi=et.invalidClass,ri=e.trackModel,b=t.track,b=b==null?e.track==null?ri.on:e.track:b,ht=t.history,ht=ht==null?ii.on:ht,it=t.checkEditable,it=it==null?!0:it,ct=t.checkEditableAdd,ct=ct==null?it:ct,ui=this.columns,fi=this.colIndxs,yt=t.source,pt=this.rowIndxOffset,wt=n.paramquery.getValueFromDataType,a=t.rowList,rt=a.length;for(p||(p=e.dataModel.data=[]),k=[],h=0;h<rt;h++){var u=a[h],r=u.newRow,o=u.rowData,f=u.type,d=u.checkEditable,s=u.rowIndx,bt=u.oldRow;if(d==null&&(f=="update"?d=it:f=="add"&&(d=ct)),f=="update"){if(!bt||!o)throw"assert failed: oldRow and rowData required while update";if(d&&e.editable!==!0&&l.isEditableRow({rowIndx:s,rowData:o})===!1)continue}else if(f=="delete"){k.push(u);continue}if(f=="add")for(ut=0,kt=vt.length;ut<kt;ut++)c=vt[ut],i=c.dataIndx,r[i]=r[i];for(i in r){if(c=ui[i],dt=fi[i],c){if(d&&c.editable!=null&&l.isEditableCell({rowIndx:s,colIndx:dt,dataIndx:i})===!1){delete r[i];continue}var gt=c.dataType,v=wt(r[i],gt),ft=o?o[i]:undefined,ft=ft!==undefined?wt(ft,gt):undefined;if(r[i]=v,st&&c.validations)if(yt=="edit"&&w===!1){if(y=this.isValid({dataIndx:i,rowIndx:s,value:v}),y.valid==!1&&!y.warn)return!1}else ni=f=="add"?r:o,y=this.iIsValid.isValidCell({column:c,rowData:ni,allowInvalid:w,value:v}),y.valid===!1&&(w!==!1||y.warn||delete r[i]);if(f=="update"&&v===ft){if(yt=="edit")return null;delete r[i];continue}}f=="update"&&(bt[i]=ft)}if(r)if(f=="update")for(i in r){k.push(u);break}else k.push(u)}if(a=t.rowList=k,rt=a.length,!rt)return!1;for(ht&&(l.iHistory.increment(),l.iHistory.push({rowList:a})),h=0;h<rt;h++){var u=a[h],f=u.type,r=u.newRow,s=u.rowIndx,g=u.rowIndxPage,o=u.rowData;if(f=="update"){b&&this.iUCData.update({rowData:o,row:r,refresh:!1});for(i in r)v=r[i],o[i]=v}else if(f=="add")b&&this.iUCData.add({rowData:r}),s==null&&g==null?p.push(r):(g=s-pt,nt=tt=="remote"?g:s,p.splice(nt,0,r)),tt=="remote"&&ot.totalRecords++;else if(f=="delete"){var ti=l.getRowIndx({rowData:o}),ei=ti.uf,s=ti.rowIndx;b&&this.iUCData["delete"]({rowIndx:s,rowData:o});g=s-pt;nt=tt=="remote"?g:s;ei?at.dataUF.splice(nt,1):(lt=p.splice(nt,1),lt&&lt.length&&tt=="remote"&&ot.totalRecords--)}}return l._trigger("change",null,t),!0};t._fixTableViewPort=function(){var n,t;this.iGenerateView.setPanes();n=this.element[0];n.scrollTop=0;n.scrollLeft=0;t=this.$header_o[0];t.scrollLeft=0;t.scrollTop=0};t._fixIEFooterIssue=function(){n(".pq-grid-footer").css({position:"absolute"});n(".pq-grid-footer").css({position:"relative"})};t.refreshColumn=function(n){var u=this.colModel,t=n.colIndx,i=n.dataIndx,t=t==null?this.getColIndx({dataIndx:i}):t,i=i==null?u[t]:i,s=this.rowIndxOffset,f,e,r,o;for(n.colIndx=t,f=this.initV,e=this.finalV,r=f;r<=e;r++)o=r,n.rowIndx=o+s,n.rowIndxPage=o,n.colIndx=t,n.column=u[t],n.skip=!0,this.refreshCell(n);this._fixTableViewPort();this.iRefresh.refreshScrollbars();this._trigger("refreshColumn",null,{dataModel:this.options.dataModel,colModel:u,initV:f,finalV:e,colIndx:t,dataIndx:i})};t.refreshCell=function(n){var u,l;if(this.pdata){var o=this.rowIndxOffset,a=n.skip,r=n.rowIndx,t=n.rowIndxPage,r=n.rowIndx=r==null?t+o:r,t=n.rowIndxPage=t==null?r-o:t,s=n.dataIndx,i=n.colIndx,i=n.colIndx=i==null?this.getColIndx({dataIndx:s}):i,f=this.getCell({all:!0,rowIndxPage:t,colIndx:i}),h=n.column,c=this.colModel,h=n.column=h?h:c[i],v=this.options,y=v.treeModel,e=this.pdata[t];e&&(u=n,u.tree=y.labelIndx?!0:!1,u.rowData=e,f&&f.length>0&&(l=this.iGenerateView.renderCell(u),f.replaceWith(l),a||(this._fixTableViewPort(),this.iRefresh.refreshScrollbars(),this._trigger("refreshCell",null,{dataModel:this.options.dataModel,colModel:c,rowData:e,rowIndx:r,rowIndxPage:t,colIndx:i,dataIndx:s}))))}};t.refreshRow=function(t){var o,c,l;if(this.pdata){var a=this,s=this.rowIndxOffset,u=t.rowIndx,i=t.rowIndxPage,u=u==null?i+s:u,i=i==null?u-s:i,r=this.getRow({all:!0,rowIndxPage:i}),v=this.colModel,f=this.pdata[i],h=!1,e=document.activeElement,y=n(e);return((e==r[0]||r.length>1&&e==r[1])&&(h=!0),!f||!r||!r.length)?null:(o=[],a.iGenerateView.refreshRow(i,v,o,null,null,f.pq_detail&&f.pq_detail.show),c=o.join(""),r.replaceWith(c),this._fixTableViewPort(),this.iRefresh.refreshScrollbars(),h&&(l=this.getRow({all:!0,rowIndxPage:i}),l.attr("tabindex",0).focus()),this._trigger("refreshRow",null,{rowData:f,rowIndx:u,rowIndxPage:i}),!0)}};t.quitEditMode=function(n){if(!this._quitEditMode){var t=this,i=!1,r=!1,u=!1,s=this.options,f=s.editModel,e=f.indices,o=undefined;t._quitEditMode=!0;n&&(i=n.old,r=n.silent,u=n.fireOnly,o=n.evt);e&&(r||i||this._trigger("editorEnd",o,e),u||(this._removeCellRowOutline(n),f.indices=null));t._quitEditMode=null}};t._fixIE=function(){var n=this.$cont[0];n.scrollLeft=0;n.scrollTop=0};t.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}};t.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}};t.getRowIndxOffset=function(){return this.rowIndxOffset};t.selectCell=function(n){var t=n.evt;if(t&&(t.type=="keydown"||t.type=="keypress")){if(this.iCells.replace(n)==!1)return!1}else if(this.iCells.add(n)===!1)return!1;return!0};t.getEditCell=function(){var n=this.options.editModel;if(n.indices){var i=this.getCell(n.indices),t=this.$div_focus.children(".pq-editor-inner"),r=t.find(".pq-editor-focus");return{$td:i,$cell:t,$editor:r}}return null};t.editCell=function(n){this.scrollRow(n);this.scrollColumn(n);var t=this.getCell(n);if(t&&t.length)return this._editCell(n)};t.getFirstEditableColIndx=function(n){var i,t;if(n.rowIndx==null)throw"rowIndx NA";if(!this.isEditableRow(n))return-1;for(i=this.colModel,t=0;t<i.length;t++){if(n.colIndx=t,this.isEditableCell(n)){if(i[t].hidden)continue}else continue;return t}return-1};t.editFirstCellInRow=function(n){var f=this,r=this.rowIndxOffset,t=n.rowIndx,i=n.rowIndxPage,t=t==null?i+r:t,i=i==null?t-r:i,u=this.getFirstEditableColIndx({rowIndx:t});u!=-1&&this.editCell({rowIndxPage:i,colIndx:u})};t._editCell=function(t){var i=this,rt=t.evt,ct=this.rowIndxOffset,f=t.rowIndxPage,y=t.rowIndx,y=y==null?f+ct:y,f=f==null?y-ct:f,p=t.colIndx,e=t.dataIndx,p=p==null?this.getColIndx({dataIndx:e}):p,ri=this.colModel,o=ri[p],e=o.dataIndx,lt=o.editor,at=this.options,b=at.editModel,vt=at.editor,r=lt?n.extend({},vt,lt):vt,w=i.pdata[f],yt=!1,ut,l,pt,u,dt,gt,ni,c,ti,nt,ii,st,ht;if(!this.pdata||f>=this.pdata.length)return!1;if(b.indices){if(ut=b.indices,ut.rowIndxPage==f&&ut.colIndx==p)return this.refreshEditorPos(),l=this.$div_focus.find(".pq-editor-focus"),window.setTimeout(function(){l.focus()},0),!1;if(this.blurEditor({evt:rt})===!1)return!1;this.quitEditMode({evt:rt})}b.indices={rowIndxPage:f,rowIndx:y,colIndx:p,column:o,dataIndx:e};this._generateCellRowOutline();pt=this.$div_focus;u=pt.children(".pq-editor-inner");o.align=="right"?u.addClass("pq-align-right"):o.align=="center"?u.addClass("pq-align-center"):u.addClass("pq-align-left");var k=w[e],s,h=r.type,ui=t.select==null?r.select:t.select,wt=r.init,a=r.valueIndx,fi=r.dataMap,d=r.mapIndices,d=d?d:{},ei=r.cls?r.cls:"",ft="pq-editor-focus "+ei,tt=ft+" pq-cell-editor ",g=r.attr?r.attr:"",v=r.style,v=v?v:"",oi=v?"style='"+v+"'":"",bt=u.width()-8,et="style='width:"+bt+"px;"+v+"'",si=v?"style='"+v+"'":"",kt={rowIndx:y,rowIndxPage:f,$cell:u,cellData:k,rowData:w,cls:ft,dataIndx:e,column:o};typeof h=="function"?s=h.call(i.element[0],kt):h=="checkbox"?(dt=r.subtype,gt=k?"checked='checked'":"",s="<input "+gt+" class='"+tt+"' "+g+" "+si+" type=checkbox name='"+e+"' />",u.html(s),ni=u.children("input"),dt=="triple"&&(ni.pqval({val:k}),u.click(function(){n(this).children("input").pqval({incr:!0})}))):h=="textarea"||h=="select"||h=="textbox"?(h=="textarea"?s="<textarea class='"+tt+"' "+g+" "+et+" name='"+e+"' ><\/textarea>":h=="select"?(c=r.options,c=c?c:[],typeof c=="function"&&(c=c.call(i.element[0],{column:o,rowData:w})),ti=[g," class='",tt,"' ",et," name='",e,"'"].join(""),s=n.paramquery.select({options:c,attr:ti,prepend:r.prepend,labelIndx:r.labelIndx,valueIndx:a,groupIndx:r.groupIndx,dataMap:fi})):s="<input class='"+tt+"' "+g+" "+et+" type=text name='"+e+"' />",n(s).appendTo(u).width(bt).val(h=="select"&&a!=null&&(d[a]||this.columns[a])?d[a]?w[d[a]]:w[a]:k)):(s="<div contenteditable='true' tabindx='0' "+oi+" "+g+" class='pq-editor-default "+ft+"'><\/div>",u.html(s),u.children().html(k),yt=!0);typeof wt=="function"&&wt.call(i.element[0],kt);var i=this,l=u.children(".pq-editor-focus"),it=b.filterKeys,ot=o.editModel;ot&&ot.filterKeys!==undefined&&(it=ot.filterKeys);nt={$cell:u,$editor:l,dataIndx:e,column:o,colIndx:p,rowIndx:y,rowIndxPage:f,rowData:w};b.indices=nt;l.data({FK:it}).on("click",function(){n(this).focus()}).on("keydown",function(n){i.iKeyNav._keyDownInEdit(n)}).on("keypress",function(n){return i.iKeyNav._keyPressInEdit(n,{FK:it})}).on("keyup",function(n){return i.iKeyNav._keyUpInEdit(n,{FK:it})}).on("blur",function(t,r){var a=i.options,f=a.editModel,e=f.onBlur,v=e=="save",s=e=="validate",h=f.cancelBlurCls,o=r?r.force:!1,u,c,l;if(!i._quitEditMode&&!i._blurEditMode&&f.indices){if(u=n(t.target),!o){if(i._trigger("editorBlur",t,nt)===!1)return;if(!e)return;if(h&&u.hasClass(h))return;if(u.hasClass("hasDatepicker")){if(c=u.datepicker("widget"),c.is(":visible"))return!1}else if(u.hasClass("ui-autocomplete-input")){if(u.autocomplete("widget").is(":visible"))return}else if(u.hasClass("ui-multiselect")){if(n(".ui-multiselect-menu").is(":visible")||n(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(u.hasClass("pq-select-button")&&(n(".pq-select-menu").is(":visible")||n(document.activeElement).closest(".pq-select-menu").length))return}if(i._blurEditMode=!0,l=o||v||!s,!i.saveEditCell({evt:t,silent:l})&&!o&&s)return i._deleteBlurEditMode(),!1;i.quitEditMode({evt:t});i._deleteBlurEditMode()}}).on("focus",function(n){i._trigger("editorFocus",n,nt)});if(i._trigger("editorBegin",rt,nt),l.focus(),window.setTimeout(function(){var r=n(document.activeElement),t;r.hasClass("pq-editor-focus")===!1&&(t=i.element.find(".pq-editor-focus"),t.focus())},0),i.element[0].scrollLeft=0,i.element[0].scrollTop=0,ui)if(yt)try{ii=l[0];st=document.createRange();st.selectNodeContents(ii);ht=window.getSelection();ht.removeAllRanges();ht.addRange(st)}catch(hi){}else l.select()};t._deleteBlurEditMode=function(n){var t=this,n=n?n:{};t._blurEditMode&&(n.timer?window.setTimeout(function(){delete t._blurEditMode},0):delete t._blurEditMode)};t.getRow=function(n){var t=n.rowIndxPage,f=n.rowIndx,e=this.rowIndxOffset,t=t==null?f-e:t,r=n.all?this.$tbl:this.get$Tbl(t),i,u;return r&&r.length&&(u=r.children("tbody"),t!=null&&(i=u.children("tr[pq-row-indx="+t+"]"),i.length>r.length&&(i=i.filter(".pq-detail-master")))),i};t.getCell=function(t){var i=t.rowIndxPage,f=t.rowIndx,i=i==null?f-this.rowIndxOffset:i,r=t.colIndx,e=t.dataIndx,r=r==null?this.getColIndx({dataIndx:e}):r,u=t.all?this.$tbl:this.get$Tbl(i,r);return u&&u.length?u.children().children("tr[pq-row-indx="+i+"]").children("td[pq-col-indx="+r+"]"):n()};t.getCellHeader=function(t){var r=t.colIndx,f=t.dataIndx,r=r==null?this.getColIndx({dataIndx:f}):r,i=this.$tbl_header,e=this.options,o=e.freezeCols,u;return(i!=undefined&&(i.length>1&&(i=r>=o?n(i[1]):n(i[0])),u=i.children().children("tr.pq-grid-title-row:last").children("td[pq-col-indx="+r+"]")),u.length==0||u[0].style.visibility=="hidden")?null:u};t.getEditorIndices=function(){var t=this.options.editModel.indices;return t?n.extend({},t):null};t.getEditCellData=function(){var w=this.options,e=w.editModel.indices,h,y,c,p,l,s,t;if(!e)return null;var g=e.colIndx,nt=e.rowIndxPage,tt=e.rowIndx,a=this.colModel[g],b=a.editor,k=w.editor,u=b?n.extend({},k,b):k,f=u.valueIndx,v=u.labelIndx,r=u.mapIndices,r=r?r:{},d=a.dataIndx,it=this.$div_focus,o=it.children(".pq-editor-inner"),i,rt=u.getData;if(typeof rt=="function")i=u.getData.call(this.element[0],{$cell:o,rowData:e.rowData,dataIndx:d,rowIndx:tt,rowIndxPage:nt,column:a});else if(h=u.type,h=="checkbox")y=o.children(),i=u.subtype=="triple"?y.pqval():y.is(":checked")?!0:!1;else if(h=="contenteditable")i=o.children().html();else if(t=o.find('*[name="'+d+'"]'),t&&t.length)if(h=="select"&&f!=null)if(r[f]||this.columns[f]){if(i={},i[r[f]?r[f]:f]=t.val(),i[r[v]?r[v]:v]=t.find("option:selected").text(),c=u.dataMap,c&&(p=t.find("option:selected").data("map"),p))for(l=0;l<c.length;l++)s=c[l],i[r[s]?r[s]:s]=p[s]}else i=t.val();else i=t.val();else t=o.find(".pq-editor-focus"),t&&t.length&&(i=t.val());return i};t.getCellIndices=function(n){var r=n.$td,u,t,f,i,e;return r==null||r.length==0||r.closest(".pq-grid")[0]!=this.element[0]?{rowIndxPage:null,colIndx:null}:(u=r.parent("tr"),t=u.attr("pq-row-indx"),t!=null&&(t=parseInt(t),f=t+this.rowIndxOffset),i=r.attr("pq-col-indx"),i!=null&&(i=parseInt(i),e=this.colModel[i].dataIndx),{rowIndxPage:t,rowIndx:f,colIndx:i,dataIndx:e})};t.getRowsByClass=function(n){var e=this.options,s=e.dataModel,h=e.pageModel,c=h.type,l=c=="remote"?!0:!1,a=this.rowIndxOffset,i=s.data,r=[],t,o,u,f;if(i==null)return r;for(t=0,o=i.length;t<o;t++)u=i[t],n.rowData=u,this.hasClass(n)&&(f={rowData:u},f.rowIndx=l?t+a:t,r.push(f));return r};t.getCellsByClass=function(n){var f=this.options,h=f.dataModel,c=f.pageModel,l=c.type,a=l=="remote"?!0:!1,v=this.rowIndxOffset,i=h.data,e=this.colModel,y=e.length,r=[],o=function(n){for(var u,i,f,t=0;t<y;t++)u=e[t],i=u.dataIndx,n.dataIndx=i,this.hasClass(n)&&(f={rowData:n.rowData,dataIndx:i,colIndx:t,rowIndx:n.rowIndx},r.push(f))},t,s,u;if(i==null)return r;if(n.rowIndx!=null||n.rowIndxPage!=null||n.rowData!=null)n.rowData=n.rowData||this.getRowData(n),n.rowIndx==null&&(n.rowIndx=this.getRowIndx({rowData:u})),o(n);else for(t=0,s=i.length;t<s;t++)u=i[t],n.rowData=u,n.rowIndx=a?t+v:t,o(n);return r};t.data=function(t){var u=t.dataIndx,i=t.data,c=i==null||typeof i=="string"?!0:!1,r=t.rowData||this.getRowData(t),f,s,e,h,o;if(!r)return null;if(u==null){if(f=r.pq_rowdata,c)return f!=null&&(e=i==null?f:f[i]),{data:e};o=n.extend(!0,r.pq_rowdata,i);r.pq_rowdata=o}else{if(s=r.pq_celldata,c)return s!=null&&(h=s[u],e=i==null||h==null?h:h[i]),{data:e};s||(r.pq_celldata={});o=n.extend(!0,r.pq_celldata[u],i);r.pq_celldata[u]=o}};t.attr=function(t){var u=t.rowIndx,e=t.dataIndx,r=t.attr,l=r==null||typeof r=="string"?!0:!1,p=this.rowIndxOffset,a=t.refresh,i=t.rowData||this.getRowData(t),o,v,h,s,c,f,y;if(!i)return null;if(l||a===!1||u!=null||(u=this.getRowIndx({rowData:i}).rowIndx),e==null){if(o=i.pq_rowattr,l)return o!=null&&(s=r==null?o:o[r]),{attr:s};f=n.extend(i.pq_rowattr,r);i.pq_rowattr=f;a!==!1&&u!=null&&(v=this.getRow({rowIndxPage:u-p}),v&&v.attr(f))}else{if(h=i.pq_cellattr,l)return h!=null&&(c=h[e],s=r==null||c==null?c:c[r]),{attr:s};h||(i.pq_cellattr={});f=n.extend(i.pq_cellattr[e],r);i.pq_cellattr[e]=f;a!==!1&&u!=null&&(y=this.getCell({rowIndxPage:u-p,dataIndx:e}),y&&y.attr(f))}};t.removeData=function(t){var e=t.dataIndx,u=t.data,u=u==null?[]:u,c=typeof u=="string"?u.split(" "):u,r=c.length,o=t.rowData||this.getRowData(t),s,f,l,i,h;if(o)if(e==null){if(s=o.pq_rowdata,s){if(r)for(i=0;i<r;i++)h=c[i],delete s[h];(!r||n.isEmptyObject(s))&&delete o.pq_rowdata}}else if(f=o.pq_celldata,f&&f[e]){if(l=f[e],r)for(i=0;i<r;i++)h=c[i],delete l[h];(!r||n.isEmptyObject(l))&&delete f[e]}};t.removeAttr=function(t){var o=t.rowIndx,s=t.dataIndx,i=t.attr,i=i==null?[]:i,r=typeof i=="string"?i.split(" "):i,e=r.length,w=o-this.rowIndxOffset,v=t.refresh,h=t.rowData||this.getRowData(t),c,y,l,a,u,f,p;if(h)if(v!==!1&&o==null&&(o=this.getRowIndx({rowData:h}).rowIndx),s==null){if(c=h.pq_rowattr,c){if(e)for(u=0;u<e;u++)f=r[u],delete c[f];else for(f in c)r.push(f);(!e||n.isEmptyObject(c))&&delete h.pq_rowattr}v!==!1&&o!=null&&r.length&&(i=r.join(" "),y=this.getRow({rowIndxPage:w}),y&&y.removeAttr(i))}else{if(l=h.pq_cellattr,l&&l[s]){if(a=l[s],e)for(u=0;u<e;u++)f=r[u],delete a[f];else for(f in a)r.push(f);(!e||n.isEmptyObject(a))&&delete l[s]}v!==!1&&o!=null&&r.length&&(i=r.join(" "),p=this.getCell({rowIndxPage:w,dataIndx:s}),p&&p.removeAttr(i))}};n.paramquery.uniqueArray=function(t){for(var u,i=[],f=n.inArray,r=0,e=t.length;r<e;r++)u=t[r],f(u,i)==-1&&i.push(u);return i};t.addClass=function(t){var u=t.rowIndx,i=t.dataIndx,p=n.paramquery.uniqueArray,f=t.cls,w=this.rowIndxOffset,c=t.refresh,e=t.rowData||this.getRowData(t),l,a,o,s,h,b,v,r,y;if(e)if(c!==!1&&u==null&&(u=this.getRowIndx({rowData:e}).rowIndx),i==null)l=e.pq_rowcls,r=l?l+" "+f:f,r=p(r.split(/\s+/)).join(" "),e.pq_rowcls=r,c!==!1&&u!=null&&(a=this.getRow({rowIndxPage:u-w}),a&&a.addClass(f));else for(o=[],typeof i.push!="function"?o.push(i):o=i,s=e.pq_cellcls,s||(s=e.pq_cellcls={}),h=0,b=o.length;h<b;h++)i=o[h],v=s[i],r=v?v+" "+f:f,r=p(r.split(/\s+/)).join(" "),s[i]=r,c!==!1&&u!=null&&(y=this.getCell({rowIndxPage:u-w,dataIndx:i}),y&&y.addClass(f))};t.removeClass=function(n){var i=n.rowIndx,r=this.getRowData(n),t=n.dataIndx,f=n.cls,o=n.refresh,s,h,c,u,e,v,l,a;if(r)if(s=r.pq_cellcls,h=r.pq_rowcls,o!==!1&&i==null&&(i=this.getRowIndx({rowData:r}).rowIndx),t==null)h&&(r.pq_rowcls=this._removeClass(h,f),i!=null&&o!==!1&&(c=this.getRow({rowIndx:i}),c&&c.removeClass(f)));else if(s)for(u=[],typeof t.push!="function"?u.push(t):u=t,e=0,v=u.length;e<v;e++)t=u[e],l=s[t],l&&(r.pq_cellcls[t]=this._removeClass(l,f),i!=null&&o!==!1&&(a=this.getCell({rowIndx:i,dataIndx:t}),a&&a.removeClass(f)))};t.hasClass=function(n){var i=n.dataIndx,e=n.cls,r=this.getRowData(n),f=new RegExp("\\b"+e+"\\b"),u,t;return r?i==null?(u=r.pq_rowcls,u&&f.test(u)?!0:!1):(t=r.pq_cellcls,t&&t[i]&&f.test(t[i])?!0:!1):null};t._removeClass=function(n,t){var r,h,f,e,u,c,l;if(n&&t){var o=n.split(/\s+/),s=t.split(/\s+/),i=[];for(r=0,h=o.length;r<h;r++){for(f=o[r],e=!1,u=0,c=s.length;u<c;u++)if(l=s[u],f===l){e=!0;break}e||i.push(f)}return i.length>1?i.join(" "):i.length===1?i[0]:null}};t.getRowIndx=function(n){var f=n.$tr,e=n.rowData,t,u,i;if(e){var c=this.options,l=c.dataModel,y=c.pageModel,p=y.type,a=p=="remote"?!0:!1,o=l.data,s=!1,h=l.dataUF,r=!1;if(o)for(t=0,u=o.length;t<u;t++)if(o[t]==e){r=!0;break}if(!r&&h)for(s=!0,t=0,u=h.length;t<u;t++)if(h[t]==e){r=!0;break}if(r){var v=this.rowIndxOffset,i=a?t:t-v,w=a?t+v:t;return{rowIndxPage:s?undefined:i,uf:s,rowIndx:w}}return{}}return f==null||f.length==0?{rowIndxPage:null}:(i=f.attr("pq-row-indx"),i==null)?{rowIndxPage:null}:(i=parseInt(i),{rowIndxPage:i,rowIndx:i+this.rowIndxOffset})};h=function(n){this.options=n.options;this.that=n;var t=this,i=n.widgetEventPrefix.toLowerCase(),r=n.eventNamespace;n.element.on(i+"celleditkeyup"+r,function(n,i){return t.filterKeys(n,i)})};i=h.prototype;i._incrRowIndx=function(n,t){for(var e,o=this.that,r=n,t=t==null?1:t,u=o.pdata,f=0,i=n+1,s=u.length;i<s;i++)if(e=u[i].pq_hidden,!e&&(f++,r=i,f==t))return r;return r};i._decrRowIndx=function(n,t){for(var f,e=this.that,r=n,o=e.pdata,t=t==null?1:t,u=0,i=n-1;i>=0;i--)if(f=o[i].pq_hidden,!f&&(u++,r=i,u==t))return r;return r};t.addColumn=function(n){var i=this.options,f=i.colModel,r=i.dataModel.data,t,u;for(f.push(n),this._calcThisColModel(),t=0;t<r.length;t++)u=r[t],u.push("")};t.rowNextSelect=function(){var t=this.selection({type:"row",method:"getSelection"}),i,n,r=this.rowIndxOffset;return t&&t[0]&&(i=t[0].rowIndx,n=i-r,n=this.iKeyNav._incrRowIndx(n)),n!=null&&(this.setSelection(null),this._setSelection({rowIndxPage:n})),n};t.rowPrevSelect=function(){var t=this.selection({type:"row",method:"getSelection"}),i,n,r=this.rowIndxOffset;return t&&t[0]&&(i=t[0].rowIndx,n=i-r,n=this.iKeyNav._decrRowIndx(n)),n!=null&&(this.setSelection(null),this.setSelection({rowIndxPage:n})),n};i._incrIndx=function(n,t){var i=this.that,u=i._getLastVisibleRowIndxPage(i.pdata),f=i.colModel,e=f.length,r;if(t==null)return n==u?null:(n=this._incrRowIndx(n),{rowIndxPage:n});do{if(t++,t>=e){if(n==u)return null;n=this._incrRowIndx(n);t=0}r=f[t]}while(r&&r.hidden);return{rowIndxPage:n,colIndx:t}};i._decrIndx=function(n,t){var i=this.that,u=i.colModel,e=u.length,f=i._getFirstVisibleRowIndxPage(i.pdata),r;if(t==null)return n==f?null:(n=this._decrRowIndx(n),{rowIndxPage:n});do{if(t--,t<0){if(n==f)return null;n=this._decrRowIndx(n);t=e-1}r=u[t]}while(r&&r.hidden);return{rowIndxPage:n,colIndx:t}};i._incrEditIndx=function(n,t){var i=this.that,e=i.colModel,c=e.length,u,o=i.rowIndxOffset,s=i._getLastVisibleRowIndxPage(i.pdata),f,r,h;do{if(t++,t>=c){if(n==s)return null;do if(n=this._incrRowIndx(n),r=n+o,f=i.isEditableRow({rowIndx:r}),n==s&&f==!1)return null;while(f==!1);t=0}u=e[t];r=n+o;h=i.isEditableCell({rowIndx:r,colIndx:t,checkVisible:!0})}while(u&&(u.hidden||h==!1));return{rowIndxPage:n,colIndx:t}};i._decrEditIndx=function(n,t){var i=this.that,e=i.colModel,c=e.length,u,o=i.rowIndxOffset,s=i._getFirstVisibleRowIndxPage(i.pdata),f,r,h;do{if(t--,t<0){if(n==s)return null;do if(n=this._decrRowIndx(n),r=n+o,f=i.isEditableRow({rowIndx:r}),n==s&&f==!1)return null;while(f==!1);t=c-1}u=e[t];r=n+o;h=i.isEditableCell({rowIndx:r,colIndx:t,checkVisible:!0})}while(u&&(u.hidden||h==!1));return{rowIndxPage:n,colIndx:t}};i._incrEditRowIndx=function(n,t){var i=this.that,e=i.rowIndxOffset,r=i._getLastVisibleRowIndxPage(i.pdata);if(n==r)return null;do{n=this._incrRowIndx(n);var u=n+e,o=i.isEditableRow({rowIndx:u}),s=i.isEditableCell({rowIndx:u,colIndx:t}),f=o&&s;if(n==r&&!f)return null}while(!f);return{rowIndxPage:n,colIndx:t}};i._decrEditRowIndx=function(n,t){var i=this.that,e=i.rowIndxOffset,r=i._getFirstVisibleRowIndxPage(i.pdata);if(n==r)return null;do{n=this._decrRowIndx(n);var u=n+e,o=i.isEditableRow({rowIndx:u}),s=i.isEditableCell({rowIndx:u,colIndx:t}),f=o&&s;if(n==r&&!f)return null}while(!f);return{rowIndxPage:n,colIndx:t}};t._onKeyPressDown=function(t){var r=n(t.target).closest(".pq-grid-header"),i;return r.length>0?this._trigger("headerKeyDown",t,{dataModel:this.options.dataModel})==!1?!1:!0:(i=this.iKeyNav._bodyKeyPressDown(t),i===!1)||this._trigger("keyDown",t,{dataModel:this.options.dataModel})==!1?!1:void 0};i._saveAndMove=function(n,t){var f;if(n==null)return t.preventDefault(),!1;var i=this.that,e=this.options,o=e.selectionModel,s=e.editModel,h=i.colModel,r=n.rowIndxPage,u=n.colIndx;return(i._blurEditMode=!0,i.saveEditCell({evt:t})===!1||!i.pdata)?(i.pdata||i.quitEditMode(t),i._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),t.preventDefault(),!1):(i.quitEditMode(t),n.incr&&(f=t.shiftKey?this._decrEditIndx(r,u):this._incrEditIndx(r,u),r=f?f.rowIndxPage:r,u=f?f.colIndx:u),o.type=="row"?(i.setSelection(null),i.setSelection({rowIndxPage:r}),i.scrollColumn({colIndx:u})):o.type=="cell"?(i.setSelection(null),i.setSelection({rowIndxPage:r,colIndx:u})):(i.scrollRow({rowIndxPage:r}),i.scrollColumn({colIndx:u})),n.edit!==!1&&i._editCell({rowIndxPage:r,colIndx:u}),i._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"}),t.preventDefault(),!1)};i._keyPressInEdit=function(t,i){var f=this.that,s=f.options,e=s.editModel.indices,i=i?i:{},h=i.FK,c=e.column,r=c.dataType;if(t.key&&n.inArray(t.key,["Backspace","Left","Right","Up","Down","Del","Home","End"])!==-1)return!0;if(f._trigger("editorKeyPress",t,n.extend({},e))===!1)return!1;if(h&&(r=="float"||r=="integer")){var l=r=="float"?"0123456789.-":"0123456789-",u=t.charCode,u=u?u:t.keyCode,o=String.fromCharCode(u);if(o&&l.indexOf(o)==-1)return!1}return!0};i.getValText=function(t){var r=t[0].nodeName.toLowerCase(),i="text";return n.inArray(r,["input","textarea","select"])!=-1&&(i="val"),i};i._keyUpInEdit=function(t,i){var h=this.that,v=h.options,i=i?i:{},y=i.FK,o=v.editModel,c=o.indices,l,u,s;if(h._trigger("editorKeyUp",t,n.extend({},c)),l=c.column,u=l.dataType,y&&(u=="float"||u=="integer")){var r=n(t.target),a=u=="integer"?o.reInt:o.reFloat,f=this.getValText(r),e=r.data("oldVal"),p=r[f]();a.test(p)==!1&&(a.test(e)?r[f](e):(s=u=="float"?parseFloat(e):parseInt(e),isNaN(s)?r[f](0):r[f](s)))}};i._keyDownInEdit=function(t){var u=this.that,o=u.options,c=o.editModel.indices,y,p,i;if(c){var s=n(t.target),f=n.ui.keyCode,l=o.selectionModel,a=o.editModel,i=n.extend({},c),r=i.rowIndxPage,e=i.colIndx,w=i.column,v=w.editModel,h=v?n.extend({},a,v):a,b=this.getValText(s);if((s.data("oldVal",s[b]()),u._trigger("cellEditKeyDown",t,i)==!1)||u._trigger("editorKeyDown",t,i)==!1)return!1;if(t.keyCode==f.TAB)return i={rowIndxPage:r,colIndx:e,incr:!0},this._saveAndMove(i,t);if(t.keyCode==h.saveKey)return i=h.onSave=="next"?{rowIndxPage:r,colIndx:e,incr:!0}:{rowIndxPage:r,colIndx:e,edit:!1},this._saveAndMove(i,t);if(t.keyCode==f.ESCAPE)return u.quitEditMode({evt:t}),l.type=="cell"?(y=u.getCell({rowIndxPage:r,colIndx:e}),y.attr("tabindex",0).focus()):l.type=="row"&&(p=u.getRow({rowIndxPage:r}),n(p[0]).attr("tabindex",0).focus()),t.preventDefault(),!1;if(t.keyCode==f.PAGE_UP||t.keyCode==f.PAGE_DOWN)return t.preventDefault(),!1;if(h.keyUpDown){if(t.keyCode==f.DOWN)return i=this._incrEditRowIndx(r,e),this._saveAndMove(i,t);if(t.keyCode==f.UP)return i=this._decrEditRowIndx(r,e),this._saveAndMove(i,t)}return}};i.select=function(n){var t=this.that,i=n.rowIndx,u=n.colIndx,f=t.options.selectionModel,r=n.evt;r.shiftKey&&f.mode!="single"?f.type=="row"?(t.scrollRow({rowIndx:i}),t.iRows.extendSelection({rowIndx:i,evt:r})):f.type=="cell"&&(t.scrollCell({rowIndx:i,colIndx:u}),t.iCells.extendSelection({rowIndx:i,colIndx:u,evt:r})):t.setSelection({rowIndx:i,colIndx:u,evt:r,setFirst:!0})};i._bodyKeyPressDown=function(t){var r=this.that,it=this,v,y,e=r.rowIndxOffset,b=this.options,tt=r.colModel,o=b.selectionModel,k=b.editModel,l=t.ctrlKey||t.metaKey,f,h=n.ui.keyCode,s=t.keyCode,u,i,c,p,w,a;if(k.indices){r.$div_focus.find(".pq-cell-focus").focus();return}if(o.type=="row"){if(y=l?r.iRows.getFocusSelection({old:!0}):r.iRows.getFocusSelection({old:!1}),y==null)return;if(u=y.rowIndx,i=u-e,u==null)return;if(r._trigger("rowKeyDown",t,{rowData:r.pdata[i],rowIndx:u,rowIndxPage:i})==!1)return!1}else if(o.type=="cell"){if(v=l?r.iCells.getFocusSelection({old:!0}):r.iCells.getFocusSelection({old:!1}),v==null)return;var c=v,u=c.rowIndx,i=u-e,d=c.dataIndx,f=r.getColIndx({dataIndx:d});if(u==null||f==null)return;if(r._trigger("cellKeyDown",t,{rowData:r.pdata[i],rowIndx:u,rowIndxPage:i,colIndx:f,dataIndx:d,column:tt[f]})==!1)return!1;if(t.cancelBubble)return}else return;if(s==h.LEFT){c=this._decrIndx(i,f);c&&(u=c.rowIndxPage+e,this.select({rowIndx:u,colIndx:c.colIndx,evt:t}));t.preventDefault();return}if(s==h.RIGHT){c=this._incrIndx(i,f);c&&(u=c.rowIndxPage+e,this.select({rowIndx:u,colIndx:c.colIndx,evt:t}));t.preventDefault();return}if(s==h.UP){i=this._decrRowIndx(i);i!=null&&(u=i+e,this.select({rowIndx:u,colIndx:f,evt:t}));t.preventDefault();return}if(s==h.DOWN){i=this._incrRowIndx(i);i!=null&&(u=i+e,this.select({rowIndx:u,colIndx:f,evt:t}));t.preventDefault();return}if(s==h.PAGE_DOWN||s==h.SPACE){p=this.pageDown(i);p&&(i=p.rowIndxPage,i!=null&&(u=i+e,this.select({rowIndx:u,colIndx:f,evt:t})));t.preventDefault();return}if(s==h.PAGE_UP){w=this.pageUp(i);w&&(i=w.rowIndxPage,i!=null&&(u=i+e,this.select({rowIndx:u,colIndx:f,evt:t})));t.preventDefault();return}if(s==h.HOME){o.type=="row"||l?(u=r._getFirstVisibleRowIndxPage(r.pdata)+e,this.select({rowIndx:u,colIndx:f,evt:t})):o.type=="cell"&&(f=r._getFirstVisibleColIndx(),this.select({rowIndx:u,colIndx:f,evt:t}));t.preventDefault();return}if(s==h.END){o.type=="row"||l?(u=r._getLastVisibleRowIndxPage(r.pdata)+e,this.select({rowIndx:u,colIndx:f,evt:t})):o.type=="cell"&&(f=r._getLastVisibleColIndx(),this.select({rowIndx:u,colIndx:f,evt:t}));t.preventDefault();return}if(s==h.ENTER){if(o.type=="row")y!=null&&r.editFirstCellInRow({rowIndx:i+e});else if(v!=null&&(a=r.getCell({rowIndxPage:i,colIndx:f}),a&&a.length>0)){var u=i+e,g=r.isEditableRow({rowIndx:u}),nt=r.isEditableCell({rowIndx:u,colIndx:f});g&&nt&&r.editCell({rowIndxPage:i,colIndx:f})}t.preventDefault();return}if(l&&s=="65"){o.type=="row"&&o.mode!="single"?r.iRows.selectAll({all:o.all}):o.type=="cell"&&o.mode!="single"&&r.iCells.selectAll({all:o.all});t.preventDefault();return}if(k.pressToEdit&&s>=32&&s<=127&&!l&&v!=null&&(a=r.getCell({rowIndxPage:i,colIndx:f}),a&&a.length>0)){var u=i+e,g=r.isEditableRow({rowIndx:u}),nt=r.isEditableCell({rowIndx:u,colIndx:f});g&&nt&&r.editCell({rowIndxPage:i,colIndx:f,select:!0})}};i.incrPageSize=function(){for(var r,e,t=this.that,u=t.$tbl,f=u.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),o=parseInt(u.css("marginTop")),s=t.iRefresh.getEContHt()-o,i=f.length-1;i>=0;i--)if(r=f[i],r.offsetTop<s)break;return e=t.getRowIndx({$tr:n(r)}).rowIndxPage,{rowIndxPage:e}};i.pageNonVirtual=function(t,i){var u=this.that,l=u.$cont[0].offsetHeight-u._getSBHeight(),f=u.getRow({rowIndxPage:t}),o=0,r=0,s,e=n(f[0])[i]("tr.pq-grid-row"),h=e.length,c;if(h>0){do{if(s=e[r],c=s.offsetHeight,o+=c,o>=l)break;r++}while(r<h);r=r>0?r-1:r;do if(f=n(e[r]),t=u.getRowIndx({$tr:f}).rowIndxPage,t!=null)break;else r--;while(r>=0)}return t};i.pageDown=function(n){var t=this.that,e=t.options,r=t.$vscroll.pqScrollBar("option"),o=r.cur_pos,s=r.num_eles,h=r.ratio,n,i,f,u;if(e.virtualY){if(o<s-1){if(n=this.incrPageSize().rowIndxPage,i=t._calcCurPosFromRowIndxPage(n),i==null)return;t.$vscroll.pqScrollBar("option","cur_pos",i).pqScrollBar("scroll")}}else n!=null?n=this.pageNonVirtual(n,"nextAll"):h<1&&(f=t.iRefresh.getEContHt(),u=t.iMouseSelection,u.updateTableY(-1*f),u.syncScrollBarVert());return{rowIndxPage:n,curPos:i}};i.pageUp=function(n){var t=this.that,e=t.options,u=t.$vscroll.pqScrollBar("option"),o=u.cur_pos,s=u.ratio,n,i,f,r;if(e.virtualY){if(o>0){if(n=this.decrPageSize().rowIndxPage,i=t._calcCurPosFromRowIndxPage(n),i==null)return;t.$vscroll.pqScrollBar("option","cur_pos",i).pqScrollBar("scroll")}}else n!=null?n=this.pageNonVirtual(n,"prevAll"):s>0&&(f=t.iRefresh.getEContHt(),r=t.iMouseSelection,r.updateTableY(f),r.syncScrollBarVert());return{rowIndxPage:n,curPos:i}};i.decrPageSize=function(){var r=this.that,f=r.$tbl,u=f.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),e=r.options.freezeRows,i=0,t;return u.length&&(e?(t=u.filter("tr.pq-last-frozen-row"),t.length&&(t=t.next())):u.length>=2&&(t=n(u[1])),t&&t.length&&(i=r.getRowIndx({$tr:t}).rowIndxPage,i=i-r.pageSize+4,i<0&&(i=0))),{rowIndxPage:i}};t._calcNumHiddenFrozens=function(){for(var t=0,i=this.options.freezeCols,n=0;n<i;n++)this.colModel[n].hidden&&t++;return t};t._calcNumHiddenUnFrozens=function(n){for(var i=0,r=this.options.freezeCols,u=n!=null?n:this.colModel.length,t=r;t<u;t++)this.colModel[t].hidden&&i++;return i};t._getSBHeight=function(){return this.iRefresh.getSBHeight()};t._getSBWidth=function(){return this.iRefresh.getSBWidth()};t._getFirstVisibleRowIndxPage=function(n){for(var r,t=0,i=n.length;t<i;t++)if(r=n[t].pq_hidden,!r)return t};t._getLastVisibleRowIndxPage=function(n){for(var i,t=n.length-1;t>=0;t--)if(i=n[t].pq_hidden,!i)return t;return null};t._getFirstVisibleColIndx=function(){for(var i,t=this.colModel,r=t.length,n=0;n<r;n++)if(i=t[n].hidden,!i)return n;return null};t._getLastVisibleColIndx=function(){for(var i,t=this.colModel,r=t.length,n=r-1;n>=0;n--)if(i=t[n].hidden,!i)return n;return null};t.getTotalVisibleColumns=function(){for(var r,u,t=this.colModel,f=t.length,i=0,n=0;n<f;n++)r=t[n],u=r.hidden,u||i++;return i};t._calcCurPosFromRowIndxPage=function(n){var o=this.options,s=o.groupModel,h=s?this.dataGM:this.pdata,u=o.freezeRows,t,f,i,e,r,c;if(n<u)return 0;for(t=0,f=u,i=u,e=h.length;i<e;i++){if(r=h[i],!s||!(r.groupSummary||r.groupTitle)){if(f==n)break;f++}c=r.pq_hidden;c||t++}return t>=e?null:t};t._calcCurPosFromColIndx=function(n){var h=this.options,c=this.pdata,e=this.colModel,r=h.freezeCols,t,u,i,f,o,s;if(n<r)return 0;for(t=0,u=r,i=r,f=e.length;i<f;i++){if(o=e[i],u==n)break;u++;s=o.hidden;s||t++}return t>=f?null:t};u=function(n,t,i){var f=0,o=this.options,h=o.columnBorders,c=h?1:0,e=o.numberCell,s=this.colModel,u,r;if(n==-1&&(e.show&&(f+=i?parseInt(e.width)+1:e.outerWidth),n=0),i){for(u=n;u<t;u++)if(r=s[u],r&&!r.hidden){if(!r._width)throw"assert failed";f+=r._width+c}}else for(u=n;u<t;u++)r=s[u],r&&!r.hidden&&(f+=r.outerWidth);return f};n.paramquery.pqgrid.calcWidthCols=u;t.calcHeightFrozenRows=function(){var i=this.$tbl,u=0,t,r;return i&&i.length&&(t=n(i[0]).find("tr.pq-last-frozen-row"),t&&t.length&&(r=t[0],u=r.offsetTop+r.offsetHeight)),u};t._calcRightEdgeCol=function(n){var i=0,r=0,e=this.colModel,o=this.hidearrHS,f=this.options.numberCell,t,u;for(f.show&&(i+=f.outerWidth,r++),t=0;t<=n;t++)u=e[t],u.hidden||o[t]!=!1||(i+=u.outerWidth,r++);return{width:i,cols:r}};t.nestedCols=function(n,t,i){var c=n.length,f=[],e,r,u;t==null&&(t=1);var o=t,s=0,h=0;for(e=0;e<c;e++)r=n[e],(i===!0||i===!1)&&(r.hidden=i),r.colModel!=null&&r.colModel.length>0?(u=this.nestedCols(r.colModel,t+1,r.hidden),f=f.concat(u.colModel),u.colSpan>0?(u.depth>o&&(o=u.depth),r.colSpan=u.colSpan,s+=u.colSpan):(r.colSpan=0,r.hidden=!0),r.childCount=u.childCount,h+=u.childCount):(r.hidden?r.colSpan=0:(r.colSpan=1,s++),r.childCount=0,h++,f.push(r));return{depth:o,colModel:f,colSpan:s,width:0,childCount:h}};t.getHeadersCells=function(){for(var n,r,e,u,f,a,s=this.options.colModel,v=this.colModel.length,y=this.depth,i=[],t=0;t<y;t++){i[t]=[];var o=0,h=0;for(n=0;n<v;n++){if(t==0)r=s[o];else if(e=i[t-1][n],u=e.colModel,u==null||u.length==0)r=e;else{var p=n-e.leftPos,c=0,l=0;for(f=0;f<u.length;f++)if(c+=u[f].childCount>0?u[f].childCount:1,p<c){l=f;break}r=u[l]}a=r.childCount?r.childCount:1;n==h?(r.leftPos=n,i[t][n]=r,h+=a,s[o+1]&&o++):i[t][n]=i[t][n-1]}}return this.headerCells=i,i};t.getDataType=function(){var n=this.colModel,t;if(n&&n[0])return t=n[0].dataIndx,typeof t=="string"?"JSON":"ARRAY";throw"dataType unknown";};t.assignRowSpan=function(){for(var n,r,f,u,o,h=this.options.colModel,s=this.colModel.length,i=this.headerCells,e=this.depth,t=0;t<s;t++)for(n=0;n<e;n++){if(r=i[n][t],t>0&&r==i[n][t-1])continue;else if(n>0&&r==i[n-1][t])continue;for(f=1,u=n+1;u<e;u++)o=i[u][t],r==o&&f++;r.rowSpan=f}return i};t._calcThisColModel=function(){var u=this.options,f=u.columnTemplate,h=u.colModel,e=this.nestedCols(h),i,o,t,r,s;if(this.colModel=e.colModel,this.depth=e.depth,i=this.colModel,o=i.length,f)for(t=0;t<o;t++)r=i[t],s=n.extend({},f,r,!0),n.extend(r,s,!0);this.getHeadersCells();this.assignRowSpan();this._refreshDataIndices()};t._createHeader=function(){this.iHeader.createHeader()};t.createTable=function(n){this.iGenerateView.generateView(n);this.iRefresh.setContAndHeaderHeight();this.iGenerateView.setPanes();this.iRefresh.refreshScrollbars()};n.widget("paramquery._pqGrid",n.ui.mouse,t)}(jQuery),function(n){function o(n){this.that=n}var e=n.paramquery.pqgrid.calcWidthCols,s=n.paramquery._pqGrid.prototype,i,u,r,f,t;s.getHeaderColumnFromTD=function(n){var t=n.attr("pq-col-indx"),i=n.attr("pq-row-indx"),r,u;return t!=null&&i!=null&&(t=parseInt(t),i=parseInt(i),r=this.headerCells[i][t]),u=!0,(!r||r.colModel&&r.colModel.length)&&(u=!1),{column:r,colIndx:t,rowIndx:i,leaf:u}};n.paramquery.cHeader=o;i=o.prototype;i.createHeader=function(){var t=this.that,w=this,o=t.options,et=o.hwrap,nt=t.pqpanes,c=parseInt(o.freezeCols),l=o.numberCell,tt=t.colModel,v=t.depth,it=o.virtualX,rt=o.virtualXHeader,f=rt===!1?t.initHH:t.initH,s=rt===!1?t.finalHH:t.finalH,ot=t.headerCells,st=t.hidearrHS,u=t.$header,h=t.$header_o,b,r,k,d,a,i,p,y,g,ut,ft;if(s==null)throw"finalH required for _createHeader";if(o.showHeader===!1){u&&u.empty();h.css("display","none");return}if(h.css("display",""),b="pq-grid-header-table ",b+=et?"pq-wrap ":"pq-no-wrap ",r=["<table class='"+b+"' cellpadding=0 cellspacing=0 >"],v>=1){for(r.push("<tr>"),l.show&&r.push("<td style='width:"+(l.width+1)+"px;' ><\/td>"),i=0;i<=s;i++){if(i<f&&i>=c&&it&&(i=f,i>s))throw"initH>finalH";(k=tt[i],k.hidden)||(y=k.outerWidth,r.push("<td style='width:"+y+"px;' pq-col-indx="+i+"><\/td>"))}r.push("<\/tr>")}for(d="pq-grid-col ",a=0;a<v;a++){for(r.push("<tr class='pq-grid-title-row'>"),a==0&&l.show&&r.push(["<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='",v,"'>","<div class='pq-td-div'>",l.title?l.title:"&nbsp;","<\/div><\/td>"].join("")),i=0;i<=s;i++){if(i<f&&i>=c&&it&&(i=f,i>s))throw"initH>finalH";w.createHeaderCell(a,i,ot,r,d,c,f,v)}r.push("<\/tr>")}t.ovCreateHeader(r,d);r.push("<\/table>");p=r.join("");h.empty();nt.vH?h.append(["<span class='pq-grid-header pq-grid-header-left ui-state-default'>",p,"<\/span>","<span class='pq-grid-header ui-state-default'>",p,"<\/span>"].join("")):h.append(["<span class='pq-grid-header ui-state-default'>",p,"<\/span>"].join(""));u=t.$header=n(".pq-grid-header",h);t.$tbl_header=u.children("table");y=e.call(t,-1,c);g=t.$header_left=n(u[0]);nt.vH&&(g=t.$header_left=n(u[0]),ut=t.$header_right=n(u[1]),g.css({width:y,zIndex:1}),ft=e.call(t,c,f),ut.css({left:-1*ft+"px"}));u.click(function(n){return w._onHeaderClick(n)});w._refreshResizeColumn(f,s,tt);t._trigger("refreshHeader",null,null)};i._onHeaderClick=function(t){var i=this.that,o=this,f,e,r,u;if(!i.iDragColumns||i.iDragColumns.status=="stop"){if(e=n(t.target),r=e.closest("td.pq-grid-col"),r.length){if(t.stopImmediatePropagation(),u=i.getHeaderColumnFromTD(r),f=u.colIndx,u.leaf==!1)return}else return;return o._onHeaderCellClick(f,t)}};i.createHeaderCell=function(n,t,i,r,u,f,e,o){var s=i[n][t],b=s.colSpan,a=s.halign,v=s.align,c=s.title,c=c?c:"",h,l,y,p,w;n>0&&s==i[n-1][t]||t>0&&s==i[n][t-1]||s.hidden||(h=u,a!=null?h+=" pq-align-"+a:v!=null&&(h+=" pq-align-"+v),t==f-1&&o==1&&(h+=" pq-last-frozen-col"),t<=f-1?h+=" pq-left-col":t>=e&&(h+=" pq-right-col"),l=s.cls,l&&(h=h+" "+l),y="",(s.colModel==null||s.colModel.length==0)&&(h+=" pq-grid-col-leaf"),p="pq-row-indx="+n,w="pq-col-indx="+t,r.push(["<td ",y," ",w," ",p," "," class='",h,"' rowspan=",s.rowSpan," colspan=",b,">","<div class='pq-td-div'>",c,"<span class='pq-col-sort-icon'>&nbsp;<\/span><\/div><\/td>"].join("")))};i._onHeaderCellClick=function(n,t){var i=this.that,r=i.colModel[n],f=i.options,u=r.dataIndx;i._trigger("headerCellClick",t,{column:r,colIndx:n,dataIndx:u})!==!1&&f.sortable&&r.sortable!=!1&&i.sort({colIndx:n,column:r,dataIndx:u})};i._refreshResizeColumn=function(n,t,i){var f=this.that,s=f.options,p=s.filterModel.ficon?!0:!1,h=s.numberCell,a=parseInt(s.freezeCols),c=[],l=[],w=f.pqpanes.vH,e=0,o=0,r,u;for(h.show&&(e=h.outerWidth,h.resizable&&(o=e-5,c.push("<div pq-col-indx='-1' style='left:",o,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;<\/div>"))),r=0;r<=t;r++){if(r<n&&r>=a&&(r=n,r>t))throw"initH>finalH";if(u=i[r],!u.hidden){var v=u.ficon,b=v||v==null&&p,y=c;e+=u.outerWidth;(u.resizable!==!1||b)&&(w&&r>=a&&(y=l),o=e-5,y.push("<div pq-col-indx='",r,"' style='left:",o,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;<\/div>"))}}l.length&&f.$header_right.append(l.join(""));f.$header_left.append(c.join(""))};i.refreshHeaderSortIcons=function(){var i=this.that,r=i.iSort.sorters,n=i.$header,u,t;if(n)for(u=n.find(".pq-grid-col-leaf"),u.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active"),n.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s"),t=0;t<r.length;t++){var f=r[t],s=f.dataIndx,e=i.getColIndx({dataIndx:s}),o=f.dir,h="ui-state-active pq-col-sort-"+(o=="up"?"asc":"desc"),c="ui-icon ui-icon-triangle-1-"+(o=="up"?"n":"s");n.find(".pq-grid-col-leaf[pq-col-indx="+e+"]").addClass(h);n.find(".pq-grid-col-leaf[pq-col-indx="+e+"] .pq-col-sort-icon").addClass(c)}};u=function(t){this.that=t;var i=this;t.$header_o.on({mousedown:function(t){var r,u;t.pq_composed||(r=n(t.target),i.setDraggables(t),t.pq_composed=!0,u=n.Event("mousedown",t),r.trigger(u))}},".pq-grid-col-resize-handle")};n.paramquery.cResizeColumns=u;r=u.prototype;r.setDraggables=function(t){var e=n(t.target),o=this.that,i=this,r,u,f;e.draggable({axis:"x",helper:function(t,r){var u=n(t.target),f=parseInt(u.attr("pq-col-indx"));return i._setDragLimits(f),i._getDragHelper(t,r),u},start:function(n,t){r=t.position.left;f=parseInt(i.$cl[0].style.left)},drag:function(n,t){u=t.position.left;var e=u-r;i.$cl[0].style.left=f+e+"px"},stop:function(n,t){return i.resizeStop(n,t,r)}})};r._getDragHelper=function(t){var i=this.that,o=i.options,s=parseInt(o.freezeCols),h=n(t.target),u,f,e,r;this.$cl=n("<div class='pq-grid-drag-bar'><\/div>").appendTo(i.$grid_inner);this.$clleft=n("<div class='pq-grid-drag-bar'><\/div>").appendTo(i.$grid_inner);u=parseInt(h.attr("pq-col-indx"));f=i.$grid_inner.outerHeight();this.$cl.height(f);this.$clleft.height(f);e=n("td[pq-col-indx="+u+"]",i.$header)[0];r=e.offsetLeft;i.pqpanes.vH?u>=s&&(r+=i.$header[1].offsetLeft):r+=i.$header[0].offsetLeft;this.$clleft.css({left:r});r=r+e.offsetWidth;this.$cl.css({left:r})};r._setDragLimits=function(n){if(!(n<0)){var t=this.that,e=t.colModel,i=e[n],u=t.options,c=u.numberCell,r=t.$header_left;n>=u.freezeCols&&t.pqpanes.vH&&(r=t.$header_right);var o=r.find("td[pq-col-indx='"+n+"']"),f=o.offset().left+i._minWidth,s=f+i._maxWidth-i._minWidth,h=r.find("div.pq-grid-col-resize-handle[pq-col-indx="+n+"]");h.draggable("option","containment",[f,0,s,0])}};r.resizeStop=function(t,i,r){var e=this.that,a=e.colModel,v=e.options,c=this,s=v.numberCell,f,o;c.$clleft.remove();c.$cl.remove();var y=i.position.left,l=y-r,p=n(i.helper),h=parseInt(p.attr("pq-col-indx")),u;h==-1?(u=null,f=parseInt(s.width),o=f+l,s.width=o):(u=a[h],f=parseInt(u.width),o=f+l,u.width=o,u._resized=!0);e.refresh();e._trigger("columnResize",t,{colIndx:h,column:u,dataIndx:u?u.dataIndx:null,oldWidth:f,newWidth:u?u.width:s.width})};f=function(t){this.that=t;this.$drag_helper=null;var i=t.options.dragColumns,r=i.topIcon,u=i.bottomIcon,f=this;if(this.status="stop",this.$arrowTop=n("<div class='pq-arrow-down ui-icon "+r+"'><\/div>").appendTo(t.element),this.$arrowBottom=n("<div class='pq-arrow-up ui-icon "+u+"' ><\/div>").appendTo(t.element),this.hideArrows(),i&&i.enabled)t.$header_o.on("mousedown","td.pq-grid-col",function(t,i){if(!n(t.target).is("input,select,textarea")&&!t.pq_composed){f.setDraggables(t,i);t.pq_composed=!0;var r=n.Event("mousedown",t);n(t.target).trigger(r)}})};n.paramquery.cDragColumns=f;t=f.prototype;t.showFeedback=function(n,t){var r=this.that,i=n[0],f=i.offsetParent.offsetParent,u=i.offsetLeft+f.offsetLeft+(t?0:i.offsetWidth)-8,e=r.$grid_inner[0].offsetTop+i.offsetTop-16,o=r.$grid_inner[0].offsetTop+r.$header[0].offsetHeight;this.$arrowTop.css({left:u,top:e,display:""});this.$arrowBottom.css({left:u,top:o,display:""})};t.showArrows=function(){this.$arrowTop.show();this.$arrowBottom.show()};t.hideArrows=function(){this.$arrowTop.hide();this.$arrowBottom.hide()};t.updateDragHelper=function(n){var f=this.that,i=f.options.dragColumns,r=i.acceptIcon,u=i.rejectIcon,t=this.$drag_helper;t&&(n?(t.children("span.pq-drag-icon").addClass(r).removeClass(u),t.removeClass("ui-state-error")):(t.children("span.pq-drag-icon").removeClass(r).addClass(u),t.addClass("ui-state-error")))};t.setDraggables=function(t){var u=n(t.currentTarget),r=this.that,e=r.options.dragColumns,o=e.rejectIcon,i=this,f;u.hasClass("ui-draggable")||(f=r.getHeaderColumnFromTD(u),f.leaf!==!1)&&u.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:r.element,revert:"invalid",helper:function(){var t=n(this),f,e,s,u;return i.status="helper",i.setDroppables(t),r.$header.find(".pq-grid-col-resize-handle").hide(),f=t.attr("pq-col-indx"),e=t.attr("pq-row-indx"),t.droppable("destroy"),s=r.headerCells[e][f],u=n("<div class='pq-col-drag-helper ui-widget-content ui-corner-all' ><span class='pq-drag-icon ui-icon "+o+"'><\/span>"+s.title+"<\/div>"),i.$drag_helper=u,u[0]},drag:function(t){var u,f,e;i.status="drag";u=n("td.pq-drop-hover",r.$header);u.length>0?(i.showArrows(),i.updateDragHelper(!0),f=u.width(),e=t.clientX-u.offset().left+n(document).scrollLeft(),e<f/2?(i.leftDrop=!0,i.showFeedback(u,!0)):(i.leftDrop=!1,i.showFeedback(u,!1))):(i.hideArrows(),r.$toolbar.hasClass("pq-drop-hover")?i.updateDragHelper(!0):i.updateDragHelper())},stop:function(){i.status="stop";r.$header.find(".pq-grid-col-resize-handle").show();i.hideArrows()}})};t._columnIndexOf=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]==t)return i;return-1};t.setDroppables=function(){var t=this.that,i=this,u={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(r,u){if(!i.dropPending){var c=parseInt(u.draggable.attr("pq-col-indx")),e=parseInt(u.draggable.attr("pq-row-indx")),l=n(this),a=parseInt(l.attr("pq-col-indx")),o=parseInt(l.attr("pq-row-indx")),v=t.options.colModel,f=t.headerCells,y=f[e][c],s,h;s=e==0?v:f[e-1][c].colModel;h=o==0?v:f[o-1][a].colModel;var p=f[o][a],w=i._columnIndexOf(s,y),b=s.splice(w,1)[0],k=i._columnIndexOf(h,p),d=i.leftDrop?1:0;h.splice(k+1-d,0,b);i.dropPending=!0;window.setTimeout(function(){t._calcThisColModel();t.refresh();i.dropPending=!1},0)}}},r=t.$header_left.find("td.pq-left-col"),f=t.pqpanes.v||t.pqpanes.vH?t.$header_right.find("td.pq-right-col"):t.$header_left.find("td.pq-right-col");r=r.add(f);r.each(function(t,i){var r=n(i);r.hasClass("ui-droppable")||r.droppable(u)});return}}(jQuery),function(n){function i(t){var i=this,r,u;this.that=t;this.type="detail";this.refreshComplete=!0;this.detachView=!1;r=t.widgetEventPrefix.toLowerCase();u=t.eventNamespace;t.element.on(r+"cellclick"+u,function(n,t){if(i.belongs(n))return i.toggle(n,t)}).on(r+"cellkeydown"+u,function(t,r){if(i.belongs(t)&&t.keyCode==n.ui.keyCode.ENTER)return i.toggle(t,r)}).on(r+"refresh"+u,function(n){if(i.belongs(n))return i.aftertable()}).on(r+"beforetableview"+u,function(n,t){if(i.belongs(n))return i.beforeTableView(n,t)}).on(r+"tablewidthchange"+u,function(n,t){if(i.belongs(n))return i.tableWidthChange(n,t)})}n.paramquery.cHierarchy=i;var t=i.prototype=new n.paramquery.cClass;t.tableWidthChange=function(){var f,r,t,e,i,s,u;if(this.refreshComplete){for(this.refreshComplete=!1,f=this.that,r=f.$tbl.children("tbody").children("tr.pq-detail-child").children("td.pq-detail-child"),t=0,e=r.length;t<e;t++){var h=r[t],c=n(h),o=c.find(".pq-grid");for(i=0,s=o.length;i<s;i++)u=n(o[i]),u.is(":visible")&&u.pqGrid("onWindowResize")}this.refreshComplete=!0}};t.aftertable=function(t){var r=this.that,c=r.options.detailModel.init,p=r.pdata,u,l,s,h,o,y,i;if(this.refreshComplete){for(this.refreshComplete=!1,t=t?t:r.$tbl.children("tbody").children("tr.pq-detail-child"),u=0,l=t.length;u<l;u++){var w=t[u],a=n(w),b=a.attr("pq-row-indx"),f=p[b],v=!1,e=f.pq_detail.child;for(e||typeof c=="function"&&(v=!0,e=c.call(r.element[0],{rowData:f}),f.pq_detail.child=e,f.pq_detail.height=25),s=a.children("td.pq-detail-child"),s.append(e),h=s.find(".pq-grid"),o=0,y=h.length;o<y;o++)i=n(h[o]),v?i.hasClass("pq-pending-refresh")&&i.is(":visible")&&(i.removeClass("pq-pending-refresh"),i.pqGrid("refresh")):i.is(":visible")&&i.pqGrid("onWindowResize")}this.refreshComplete=!0;this.detachView=!1}};t.beforeTableView=function(){this.detachView||(this.detachInitView(),this.detachView=!0)};t.detachInitView=function(t){var u=this.that,r=u.$tbl,i;if(r&&r.length)for(t=t?t:r.children("tbody").children("tr.pq-detail-child"),i=0;i<t.length;i++){var f=t[i],e=n(f),o=e.children("td.pq-detail-child").children();o.detach()}};t.toggle=function(n,t){var u=this.that,f=t.column,e=t.rowData,o=t.rowIndx,s=this.type,r,i;f&&f.type===s&&(r="pq_detail",i={rowIndx:o,focus:!0},e[r]==null?u.rowExpand(i):e[r].show===!1?u.rowExpand(i):this.rowCollapse(i))};t.rowExpand=function(n){var f,e;this.normalize(n);var t=this.that,s=t.options,i=n.rowData,u=n.rowIndx,o=n.rowIndxPage,h=s.detailModel,r="pq_detail";if(i!=null){if(t._trigger("beforeRowExpand",null,n)===!1)return!1;i[r]==null?i[r]={show:!0}:i[r].show===!1&&(i[r].show=!0);h.cache||this.rowInvalidate(n);t.refreshRow({rowIndx:u});f=[];t.iGenerateView._generateDetailRow(i,o,t.colModel,f,null,!1);e=t.getRow({rowIndxPage:o});e.after(f.join(""));this.aftertable(e.next());n.focus&&t.getCell({rowIndx:u,dataIndx:r}).attr("tabindex","0").focus();n.scrollRow&&this.scrollRow({rowIndx:u})}};t.rowInvalidate=function(n){var f=this.that,t=f.getRowData(n),i="pq_detail",r=t[i],u=r?r.child:null;u&&(u.remove(),t[i].child=null,t[i].height=0)};t.normalize=function(n){var r=this.that,t=n.rowIndx,i=n.rowIndxPage,u=r.rowIndxOffset;n.rowIndx=t==null?i+u:t;n.rowIndxPage=i==null?t-u:i;n.rowData=r.getRowData(n)};t.rowCollapse=function(n){var f,r;this.normalize(n);var t=this.that,e=t.options,i=n.rowData,r=n.rowIndx,o=n.rowIndxPage,s=e.detailModel,u="pq_detail";i!=null&&i[u]!=null&&i[u].show===!0&&(s.cache||this.rowInvalidate(n),i[u].show=!1,e.virtualY?t.refresh():(f=t.getRow({rowIndxPage:o}).next("tr.pq-detail-child"),f.length&&(this.detachInitView(f),f.remove(),t.refreshRow({rowIndx:r})),n.focus&&t.getCell({rowIndx:r,dataIndx:u}).attr("tabindex","0").focus()),n.scrollRow&&(r=n.rowIndx,this.scrollRow({rowIndx:r})))}}(jQuery),function(n){var i=n.paramquery.pqgrid.calcWidthCols,r=function(n){this.that=n},t;n.paramquery.cRefresh=r;t=r.prototype;t._computeOuterWidths=function(){for(var r,n=this.that,u=n.options,e=u.columnBorders,o=e?1:0,t=u.numberCell,f=n.colModel,h=n.outerWidths,s=f.length,i=0;i<s;i++)r=f[i],r.outerWidth=r._width+o;t.show&&(t.outerWidth=t.width+1)};t.autoFit=function(){var s=this.that,k=s.options,tt=k.columnBorders?1:0,h=s.colModel,a=h.length,v=i.call(s,-1,a,!0),y=this.contWd-this.getSBWidth(),r,u,o,f,t,c,e;if(v!==y){for(r=v-y,o=[],t=0;t<a;t++){var n=h[t],d=n._percent,it=n.resizable!==!1,p=n._resized,g=n.hidden;g||d||p||(r<0?(f=n._maxWidth-n._width,f&&o.push({availWd:-1*f,colIndx:t})):(f=n._width-n._minWidth,f&&o.push({availWd:f,colIndx:t})));p&&(u=n,delete n._resized)}for(o.sort(function(n,t){return n.availWd>t.availWd?1:n.availWd<t.availWd?-1:0}),t=0,c=o.length;t<c;t++){var w=o[t],f=w.availWd,nt=w.colIndx,l=Math.round(r/(c-t)),n=h[nt],e,b=n._width;Math.abs(f)>Math.abs(l)?(e=b-l,r=r-l):(e=b-f,r=r-f);n.width=n._width=e}r!=0&&u&&(e=u._width-r,e>u._maxWidth?e=u._maxWidth:e<u._minWidth&&(e=u._minWidth),u.width=u._width=e)}};t.autoLastColumn=function(){var u=this.that,l=u.options,w=l.columnBorders?1:0,o=u.colModel,b=o.length,a=l.freezeCols,k=this.contWd-this.getSBWidth(),d=i.call(u,-1,a,!0),n=k-d,v=!1,y=u._getLastVisibleColIndx(),t,e,h,c;if(y!=null&&(t=o[y],!t._percent)){var f=t._width,r,s=t._minWidth,p=t._maxWidth;for(e=b-1;e>=a;e--)if((h=o[e],!h.hidden)&&(c=h._width+w,n=n-c,n<0)){v=!0;r=f+n>=s?f+n:f+c+n;break}v||(r=f+n);r>p?r=p:r<s&&(r=s);t.width=t._width=r}};t.numericVal=function(n,t){var i;return i=(n+"").indexOf("%")>-1?parseInt(n)*t/100:parseInt(n),Math.round(i)};t.refreshColumnWidths=function(){var h=this.that,i=h.options,r=i.numberCell,o=i.width==="flex",g=i.columnBorders,nt=g?1:0,v=h.colModel,y=i.scrollModel,tt=y.lastColumn,it=y.autoFit,rt=this.contWd,ut=v.length,ft=this.getSBWidth(),p=i._minColWidth,w=i._maxColWidth,b=0,c,n,k,a,t;r.show&&(r.width<r.minWidth&&(r.width=r.minWidth),r.outerWidth=r.width+1,b=r.outerWidth);var f=o?null:rt-ft-b,p=Math.floor(this.numericVal(p,f)),w=Math.ceil(this.numericVal(w,f)),l=0;if(!o&&f<5||isNaN(f)){if(i.debug)throw"availWidth N/A";return}for(delete h.percentColumn,c=0;c<ut;c++)if(n=v[c],k=n.hidden,!k){var s=n.width,d=(s+"").indexOf("%")>-1?!0:null,u=n.minWidth,e=n.maxWidth,u=u?this.numericVal(u,f):p,e=e?this.numericVal(e,f):w;e<u&&(e=u);s!=undefined?(t=0,!o&&d?(h.percentColumn=!0,n.resizable=!1,n._percent=!0,a=this.numericVal(s,f)-nt,t=Math.floor(a),l+=a-t,l>=1&&(t+=1,l-=1)):s&&(t=parseInt(s)),t<u?t=u:!o&&t>e&&(t=e),n._width=t):n._width=u;d||(n.width=n._width);n._minWidth=u;n._maxWidth=o?1e3:e}o===!1&&(it&&this.autoFit(),tt==="auto"&&i.virtualX&&this.autoLastColumn());this._computeOuterWidths()};t.estRowsInViewPort=function(){var n=Math.ceil(this.contHt/this.rowHt);return this.that.pageSize=n,n};t._refreshFrozenLine=function(){var t=this.that,u=t.options,f=u.numberCell,o=t.$cont_o,e=u.freezeCols,r;t.$freezeLine&&t.$freezeLine.remove();e&&(r=i.call(t,-1,e)-1,isNaN(r)||r===0||r>0&&f.show&&r===f.width||(t.$freezeLine=n(["<div class='pq-grid-vert-frozen-line' "," style = 'height:100%;top:0;left:",r,"px;' >","<\/div>"].join("")).appendTo(o)))};t._refreshHideArrHS=function(){for(var e,t=this.that,o=t.colModel,i=t.hidearrHS,r=t.initH,u=t.finalH,f=parseInt(t.options.freezeCols),n=0;n<f;n++)i[n]=!1;for(n=f;n<r;n++)i[n]=!0;for(n=r;n<=u;n++)i[n]=!1;for(n=u+1,e=o.length;n<e;n++)i[n]=!0};t._setScrollVNumEles=function(){var i=this.that,e=i.$vscroll,l=i.options,u,f;if(l.height==="flex")return e.pqScrollBar("option","num_eles",0),0;var a=i.iHierarchy?!0:!1,v=e.pqScrollBar("option"),r=parseInt(v.num_eles),b=parseInt(v.cur_pos),k=this.getSBHeight(),d=this.contHt,y=d-k+1,g=l.groupModel,nt=g?i.dataGM:i.pdata,o=nt?i.totalVisibleRows:0,s,p,h=0;if(i.$tbl&&i.$tbl.length>0&&(s=i.$tbl[i.$tbl.length-1],h=s.offsetHeight,p=n(s)),h>0&&h>y){var c=p.children().children("tr"),w=0,t=0;for(u=0;u<c.length;u++)if(f=c[u],w+=f.offsetHeight,w>=y){a&&n(f).hasClass("pq-detail-child")?(t--,t=t>1?t-1:1):t=t>1?t-1:0;break}else a?n(f).hasClass("pq-detail-child")===!1&&t++:t++;t===0&&(t=c.length-1);r=o-t+1}else r=b+1;return r>o&&(r=o),e.pqScrollBar("option","num_eles",r),r};t._setScrollVLength=function(){var t=this.that,r=t.options,n,i;r.height!=="flex"&&(n=this.getSBHeight(),i=this.contHt-n,t.$vscroll.css("bottom",n).pqScrollBar("option","length",i))};t.setContAndHeaderHeight=function(){var i=this.that,h=i.options,t=i.$header,r,f,u,e,o,s;t&&t.length?(t.length>1?(r=t[0].offsetHeight,f=t[1].offsetHeight,u=Math.max(r,f),r!==f&&(e=n(t[0]).find(".pq-grid-header-search-row"),o=n(t[1]).find(".pq-grid-header-search-row"),e.css("height",""),o.css("height",""),r=t[0].offsetHeight,f=t[1].offsetHeight,u=Math.max(r,f),r<u?e.height(o[0].offsetHeight-1):o.height(e[0].offsetHeight-1))):(r=t[0].offsetHeight,u=r),i.$header_o.height(u-2),this.headerHt=u):(i.$header_o.height(0),this.headerHt=0);h.height!=="flex"&&(s=this.height-i.$header_o[0].offsetHeight-(h.showTop?i.$top[0].offsetHeight:0)-i.$bottom[0].offsetHeight,i.$cont.height(s),this.contHt=s)};t.setContAndGridHeightFromTable=function(){var r=0,t=this.that,u=this.getSBHeight(),i=t.$tbl;r=i&&i.length?n(i[0]).data("offsetHeight"):23;this.contHt=r+u-1;t.$cont.height("");t.element.height("");t.$grid_inner.height("")};t.setContAndGridWidthFromTable=function(){var n=this.that,t=i.call(n,-1,n.colModel.length),r=n.element,u=this.getSBWidth();this.contWd=t+u;r.width(this.contWd+"px")};t.getTotalVisibleRows=function(n,t,i){var d=this.that,p=this.estRowsInViewPort(),h=0,r=i?i.length:0,e=t,u=0,v=0,c=null,g=!1,nt=!1,tt=d.iHierarchy?!0:!1,it=d.options,w=it.detailModel.offset,y=0,b=this.rowHt,rt=tt?d.$cont[0].offsetHeight:undefined,f,k,l,a,o,s;if(i==null||r==0)return{initV:null,finalV:null,tvRows:h,lastFrozenRow:null};for(f=0,k=r>t?t:r;f<k;f++)l=i[f],a=l.pq_hidden,a||(c=f,h++,tt&&(o=l.pq_detail,o&&o.show?(s=o.height||0,s>w&&(s=w),y+=s+b):y+=b));if(r<t)return{initV:c,finalV:c,tvRows:h,lastFrozenRow:c};if(r>1e4&&it.groupModel==null)return u=n+p,u>=r&&(u=r-1),{initV:n+t,finalV:u,tvRows:r,lastFrozenRow:c};for(p=p-h,f=t,k=r;f<k;f++)l=i[f],a=l.pq_hidden,g?nt||(a?u++:v===p?nt=!0:(u++,v++)):a?e++:v===n?(g=!0,u=e,v=0):(e++,v++),a||(h++,tt&&g&&(o=l.pq_detail,o&&o.show?(s=o.height||0,s>w&&(s=w),y+=s+b):y+=b,y>rt&&(nt=!0)));return e>=r&&(e=r-1),u<e&&(u=e),{initV:e,finalV:u,tvRows:h,lastFrozenRow:c}};t.calcInitFinal=function(){var n=this.that,u=n.options,o=u.virtualY,f=u.freezeRows,s=u.height==="flex",h=u.groupModel,c=h?!0:!1,i=c?n.dataGM:n.pdata,l=u.treeModel,e,r,t;if(i==null||i.length===0)t=this.getTotalVisibleRows(r,f,i),n.totalVisibleRows=t.tvRows,n.initV=t.initV,n.finalV=t.finalV,n.lastFrozenRow=t.lastFrozenRow;else if(o){if(e=n.$vscroll.pqScrollBar("option"),r=parseInt(e.cur_pos),isNaN(r)||r<0)throw"cur_pos NA";n.scrollCurPos=r;t=this.getTotalVisibleRows(r,f,i);n.totalVisibleRows=t.tvRows;n.initV=t.initV;n.lastFrozenRow=t.lastFrozenRow;n.finalV=s?i.length-1:t.finalV}else{t=this.getTotalVisibleRows(0,f,i);n.lastFrozenRow=t.lastFrozenRow;n.totalVisibleRows=t.tvRows;n.initV=0;n.finalV=i.length-1;return}};t.calcInitFinalH=function(){var n=this.that,f=n.options,a=f.virtualX,o=n.colModel,t=o.length,h,y,r,c,l,e;if(!a){n.initH=0;n.finalH=t-1;return}f.virtualXHeader===!1&&(n.initHH=0,n.finalHH=t-1);var p=parseInt(n.$hscroll.pqScrollBar("option","cur_pos")),s=parseInt(f.freezeCols),w=f.width==="flex",u=s,v=0;for(r=s;r<t;r++)if(o[r].hidden)u++;else if(v===p)break;else u++,v++;if(u>t-1&&(u=t-1),n.initH=u,w||!a)n.finalH=t-1;else{for(h=i.call(n,-1,s),y=this.getEContWd(),r=u;r<t;r++)if(c=o[r],!c.hidden){if(l=c.outerWidth,!l&&f.debug)throw"outerwidth N/A";if(h+=l,h>y)break}e=r;e>t-1&&(e=t-1);n.finalH=e}};t._calcOffset=function(n){var t=/(-|\+)([0-9]+)/.exec(n);return t&&t.length===3?parseInt(t[1]+t[2]):0};t.refreshGridWidthAndHeight=function(){var a=this.that,i=a.options,t,u,o=(i.width+"").indexOf("%")>-1?!0:!1,s=(i.height+"").indexOf("%")>-1?!0:!1,f=a.element,r,h,c,l;if(o||s){if(r=f.parent(),!r.length)return;r[0]==document.body||f.css("position")=="fixed"?(h=n(window).width(),c=window.innerHeight?window.innerHeight:n(window).height()):(h=r.width(),c=r.height());var e=null,v=this._calcOffset,y=o?v(i.width):0,p=s?v(i.height):0;if(h==0){while(r[0].tagName.toUpperCase()!="BODY")if(l=r.parent(),l[0]==null){e=r;break}else r=l;if(e){var w=e.css("position"),b=e.css("left"),k=e.css("top");e.css({position:"absolute",left:"-2000",top:"-2000"}).appendTo(n(document.body));r=f.parent();o&&(h=r.width());s&&(c=r.height());e.css({position:w,left:b,top:k})}}o&&(t=parseInt(i.width)*h/100+y);s&&(u=parseInt(i.height)*c/100+p)}o||(t=i.width);s||(u=i.height);parseFloat(t)==t?(t=t<i.minWidth?i.minWidth:t,f.width(t)):t==="auto"&&f.width(t);parseFloat(u)==u&&(u=u<i.minHeight?i.minHeight:u,f.height(u));this.width=parseFloat(t)==t?Math.round(t):t==="auto"?Math.round(f.width()):null;this.height=parseFloat(u)==u?Math.round(u):null};t.decidePanes=function(){var i=this.that,n=i.pqpanes={v:!1,h:!1,vH:!1},t=i.options,r=t.virtualX,u=t.virtualXHeader,f=t.virtualY,e=t.height=="flex",o=t.width=="flex",s=t.numberCell,h=t.freezeRows,c=t.freezeCols;h&&!e&&(c||s.show)&&!o?(f||(n.h=!0),r||(n.v=!0,n.vH=!0),u===!1&&(n.vH=!0)):h&&!e?f||(n.h=!0):(c||s.show)&&!o&&(r||(n.v=!0,n.vH=!0),u===!1&&(n.vH=!0))};t._storeColumnWidths=function(n){for(var i=this.that,r=i.colModel,u=!1,e=n||u?0:i.initH,o=n||u?r.length-1:i.finalH,f=[],t=e;t<=o;t++)f[t]={outerWidth:r[t].outerWidth};return f};t._isColumnWidthChanged=function(n){for(var i=this.that,r=i.colModel,u=!1,f=u?0:i.initH,e=u?r.length-1:i.finalH,t=f;t<=e;t++)if(r[t].outerWidth!==n[t].outerWidth)return!0;return!1};t.refreshScrollbars=function(){var u=this.that,t=u.options,f=t.height==="flex",e=t.width==="flex",n,i,r;(f||this.contHt)&&(e||this.contWd)&&u.totalVisibleRows!==null&&(n=this._setScrollVNumEles(!0),i=n>1?!0:!1,f||i===this.vscroll||(this.vscroll=i,(t.scrollModel.autoFit||t.virtualX)&&(r=this._storeColumnWidths(),this.refreshColumnWidths(),this._isColumnWidthChanged(r)&&(this.ignoreTResize=!0,this._refreshTableWidths(r,{table:!0,header:!0}),delete this.ignoreTResize,t.virtualX&&(this.setContAndHeaderHeight(),u.iGenerateView.setPanes(),n=this._setScrollVNumEles(!0),i=n>1?!0:!1,this.vscroll=i)),r=null)),n=this._setScrollHNumEles(),this.hscroll=n>1?!0:!1,this._setScrollHLength(),this._setScrollVLength(),this._setScrollHVLength())};t._setScrollHVLength=function(){var n=this.that;this.vscroll&&this.hscroll||n.$hvscroll.css("visibility","hidden")};t._setScrollHLength=function(){var t=this.that,n=t.$hscroll,r=t.$hvscroll,f=t.options,u,i;if(f.scrollModel.horizontal)n.css("visibility",""),r.css("visibility","");else{n.css("visibility","hidden");r.css("visibility","hidden");return}u=this.contWd;i=this.getSBWidth();n.css("right",i===0?0:"");n.pqScrollBar("option","length",u-i)};t.estVscroll=function(){var t=this.that,n;if(t.totalVisibleRows==null||this.contHt==null)throw"failed";n=!0;t.totalVisibleRows*this.rowHt<this.contHt&&(n=!1);this.vscroll=n};t.getSBWidth=function(){return this.that.options.height==="flex"?0:(this.vscroll==null&&this.estVscroll(),this.vscroll?17:0)};t.estHscroll=function(){var i=this.that,n,t;if(this.contWd==null)throw"failed";n=!1;t=this.calcColsOutsideCont(i.colModel)+1;t>1&&(n=!0);this.hscroll=n};t.getSBHeight=function(){return this.that.options.width==="flex"?0:(this.hscroll==null&&this.estHscroll(),this.hscroll?17:0)};t.getEContHt=function(){if(this.contHt==null)throw"contHt N/A";return this.contHt-this.getSBHeight()};t.getEContWd=function(){if(this.contWd==null)throw"contWd N/A";return this.contWd-this.getSBWidth()};t.calcColsOutsideCont=function(n){var c=this.that,e=c.options,o=e.numberCell,l=e.freezeCols,s=this.contWd-this.getSBWidth(),r=0,t,i;for(o.show&&(r+=o.outerWidth),t=0;t<n.length;t++)i=n[t],i.hidden||(r+=i.outerWidth);var h=0,u=0,f=Math.round(r);for(f>s&&u++,t=l;t<n.length;t++)if(i=n[t],!i.hidden)if(h+=i.outerWidth,f=r-h,f>s)u++;else break;return u};t._setScrollHNumEles=function(){var n=this.that,t=n.options,r=n.colModel,u=t.scrollModel,i=0;return t.width!=="flex"&&(i=u.lastColumn==="fullScroll"?r.length-t.freezeCols-n._calcNumHiddenUnFrozens():this.calcColsOutsideCont(r)+1),n.$hscroll.pqScrollBar("option","num_eles",i),i};t.init=function(){var n=this.that,t=n.options;this.hscroll=this.vscroll=this.contHt=this.contWd=null;n.initH=n.initV=n.finalH=n.finalV=null;n.totalVisibleRows=n.lastFrozenRow=null;this.rowHt=22+(t.rowBorders?1:0);this.headerHt=0};t.initContHtAndWidth=function(){var t=this.that,n=t.options;n.width!=="flex"&&(this.contWd=this.width);n.height!=="flex"&&(this.contHt=this.height-(n.showHeader?this.rowHt:0)-(n.showTop?t.$top[0].offsetHeight:0)-(n.showBottom?t.$bottom[0].offsetHeight:0))};t._refresh=function(n){var i,r;n=n||{};var t=this.that,u=n.header,f=n.table,e=t.element;if(!e[0].offsetWidth){e.addClass("pq-pending-refresh");return}t.iMouseSelection.resetMargins();this.init();t.$grid_inner[0].scrollTop=0;i=t.options;this.decidePanes();i.collapsible._collapsed=!1;this.refreshGridWidthAndHeight();this.initContHtAndWidth();this.calcInitFinal();(u===!1||f===!1)&&(r=this._storeColumnWidths(!0));this.refreshColumnWidths();this.calcInitFinalH();this._refreshHideArrHS();u!==!1?t._createHeader():this._isColumnWidthChanged(r)&&this._refreshTableWidths(r,{header:!0});t._refreshHeaderSortIcons();t._refreshPager();this.setContAndHeaderHeight();f!==!1?t.iGenerateView.generateView():(this._refreshTableWidths(r,{table:!0}),t._saveDims(),t.iGenerateView.scrollView());this.refreshScrollbars();i.height=="flex"&&this.setContAndGridHeightFromTable();i.width=="flex"&&this.setContAndGridWidthFromTable();this._refreshFrozenLine();t._createCollapse();i.dataModel.postDataOnce=undefined};t._refreshTableWidths=function(n,t){for(var s,w,h,u,c,b,i=this.that,k=i.colModel,l=i.$tbl_header,f=t.header&&l,a=i.$tbl,d=t.table&&a,g=i.initH,nt=i.finalH,tt=f?l.find("tr:nth-child(1):first"):null,it=f?i.$header.find("div.pq-grid-col-resize-handle"):null,v=d?a.find(".pq-row-hidden:first"):null,y,e,p=!1,o=0,r=g;r<=nt;r++)(s=k[r],w=n[r],s.hidden)||(h=w.outerWidth,u=s.outerWidth,u!==h&&(f&&(y=tt.find("td[pq-col-indx="+r+"]"),y.width(u)),v&&(e=v.find("td[pq-col-indx="+r+"]"),e.length&&(p=!0,e.width(u)))),o+=u-h,f&&o!==0&&(c=it.filter("[pq-col-indx="+r+"]"),b=parseInt(c.css("left")),c.css("left",b+o)));p&&i._trigger("tableWidthChange");i._saveDims()}}(jQuery),function(n){var l=n.paramquery.cClass,a=n.paramquery.pqgrid.calcWidthCols,t={},s,r,f,h,i,c,e,u,o;t.getFocusElement=function(){var r=document.activeElement,i,t;if(r&&(i=n(r),t=i.closest(".pq-grid"),t.length))return t[0]==this.element[0]?{$ae:i,$grid:t}:{$ae:i,$childGrid:t}};t.rowExpand=function(n){this.iHierarchy.rowExpand(n)};t.rowInvalidate=function(n){this.iHierarchy.rowInvalidate(n)};t.rowCollapse=function(n){this.iHierarchy.rowCollapse(n)};s=function(t){function f(n,i,r){t.filter({data:[{dataIndx:n,value:i,value2:r}]})}var i,r,u;this.that=t;i=this;this.dataHS={};r=t.widgetEventPrefix.toLowerCase();u=t.eventNamespace;t.element.on(r+"headerkeydown"+u,function(t,r){if(i.belongs(t)){var u=n(t.originalEvent.target);return u.hasClass("pq-grid-hd-search-field")?i.onKeyDown(t,r,u):!0}});t.element.on(r+"createheader"+u,function(n){if(i.belongs(n))return i._onCreateHeader()});this.changeListener={change:function(n,t){f(t.dataIndx,t.value,t.value2)}};this.keyupListener={keyup:function(n,t){f(t.dataIndx,t.value,t.value2)}};this.clickListener={click:function(n,t){f(t.dataIndx,t.value)}}};r=s.prototype=new l;r.get$Ele=function(t,i){var r=this.that,f=r.options.freezeCols,e=n(r.$tbl_header[0]),u=".pq-grid-hd-search-field[name='"+i+"']",o=n(r.$tbl_header[r.$tbl_header.length==2?1:0]);return t>=f?o.find(u):e.find(u)};r.onKeyDown=function(t,i,r){var o=this.that,v=t.keyCode,y=n.ui.keyCode,c,e,a,s,f;if(v===y.TAB){var s=r.attr("name"),u=o.getColIndx({dataIndx:s}),l=o.colModel,f,h=t.shiftKey,e=l[u];if(e.filter.condition=="between"&&(o.scrollColumn({colIndx:u}),c=this.get$Ele(u,s),c[0]==r[0]?h||(f=c[1]):h&&(f=c[0]),f))return f.focus(),t.preventDefault(),!1;do{if(h?u--:u++,u<0||u>=l.length)break;if((e=l[u],a=e.filter,!e.hidden)&&a){if(o.scrollColumn({colIndx:u}),s=e.dataIndx,f=this.get$Ele(u,s),a.condition=="between"&&(f=h?n(f[1]):n(f[0])),f)return f.focus(),t.preventDefault(),!1;break}}while(1)}else return!0};r._bindFocus=function(){function f(i){var f,e;t._fixTableViewPort();var o=n(i.target),s=o.closest(".pq-grid-hd-search-field"),r=s.attr("name");t.scrollColumn({dataIndx:r})&&(f=t.getColIndx({dataIndx:r}),e=u.get$Ele(f,r),e.focus())}for(var t=this.that,u=this,r=t.$header.find(".pq-grid-header-search-row"),i=0;i<r.length;i++)n(r[i]).on("focusin",f)};r._onCreateHeader=function(){var et=this,i=this.that,s=i.options,ct=s.columnBorders,ot=s.filterModel,t,f,r,c,w,e,b,l,a,o,k,ft;if(ot.header){this._bindFocus();var d=i.colModel,v=s.freezeCols,st=s.virtualX,g=s.virtualXHeader,nt=g===!1?i.initHH:i.initH,tt=g===!1?i.finalHH:i.finalH,h=i.$tbl_header,y=n(h[0]),it=n(h[1]),p="input,select";if(h.length>1)for(y.find(p).css("visibility","hidden"),t=0;t<v;t++){var f=d[t],ht=f.dataIndx,p="*[name='"+ht+"']";y.find(p).css("visibility","visible");it.find(p).css("visibility","hidden")}for(t=0;t<=tt;t++){if(t<nt&&t>=v&&st&&(t=nt,t>tt))throw"initH>finalH";if((f=d[t],!f.hidden)&&(r=f.filter,r)&&(c=f.dataIndx,w=y,t>=v&&h.length>1&&(w=it),e=w.find("*[name='"+c+"']"),e.length!=0)){var rt=r.type,u=r.value,ut=r.value2;if(rt=="checkbox"&&r.subtype=="triple"?e.pqval({val:u}):rt=="select"&&u!=null&&e.val(u),b=r.init,b&&b.call(e,{dataIndx:c,column:f}),l=r.listeners,l)for(a=0;a<l.length;a++){o=l[a];typeof o=="string"&&(o=et[o+"Listener"]);for(k in o)ft=o[k],function(t,r,f){t.bind(k,function(e){var s=i.getColumn({dataIndx:f}),o=s.filter;return o.type=="checkbox"?u=o.subtype=="triple"?t.pqval({incr:!0}):t.is(":checked")?!0:!1:o.condition=="between"?(u=n(t[0]).val(),ut=n(t[1]).val()):u=t.val(),r.call(this,e,{column:s,dataIndx:f,value:u,value2:ut})})}(e,ft,c)}}}}};r.createDOM=function(t,i){var l=this.that,ct=this,k=l.options,et=k.virtualX,nt=k.virtualXHeader,tt=nt===!1?l.initHH:l.initH,it=nt===!1?l.finalHH:l.finalH,ot=k.freezeCols,st=l.colModel,lt=this.dataHS,ht=k.numberCell,rt=function(n,t){return["<div class='pq-from-div'>",n,"<\/div>","<span class='pq-from-to-center'>-<\/span>","<div class='pq-to-div'>",t,"<\/div>"].join("")},a,h,y,w,d,u,p,b,ut,ft;for(t.push("<tr class='pq-grid-header-search-row'>"),ht.show&&t.push("<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='1'><div class='pq-td-div'>&nbsp;<\/div><\/td>"),a=0;a<=it;a++){if(a<tt&&a>=ot&&et&&(a=tt,a>it))throw"initH>finalH";if(h=st[a],!h.hidden)if(y=i,w=h.halign,w||(w=h.align),w=="right"?y+=" pq-align-right":w=="center"&&(y+=" pq-align-center"),d=h.cls,d&&(y=y+" "+d),u=h.filter,u){var s=h.dataIndx,v=u.type,f=u.value,g=u.condition,r=u.cls,r="pq-grid-hd-search-field "+(r?r:""),e=u.style,e=e?e:"",o=u.attr,o=o?o:"",c="";g=="between"&&(p=u.value2,p=p!=null?p:"");v==="textbox"?(f=f?f:"",r=r+" ui-corner-all pq-search-txt",c=g=="between"?rt(this._input(s,f,r+" pq-from",e,o),this._input(s,p,r+" pq-to",e,o)):this._input(s,f,r,e,o)):v==="textarea"?(f=f?f:"",r=r+" ui-corner-all pq-search-txt",c=g=="between"?rt(this._textarea(s,f,r+" pq-from",e,o),this._textarea(s,p,r+" pq-to",e,o)):this._textarea(s,f,r,e,o)):v==="select"?u.cache?c=u.cache:(b=u.options,typeof b=="function"&&(b=b.call(l.element[0],{column:h,value:f,dataIndx:s,cls:r,style:e,attr:o})),r=r+" ui-corner-all",ut=["name='",s,"' class='",r,"' style='",e,"' ",o].join(""),c=n.paramquery.select({options:b,attr:ut,prepend:u.prepend,valueIndx:u.valueIndx,labelIndx:u.labelIndx,groupIndx:u.groupIndx}),u.cache=c):v=="checkbox"?(ft=f==null||f==!1?"":"checked=checked",c=["<input ",ft," name='",s,"' type=checkbox class='"+r+"' style='"+e+"' "+o+"/>"].join("")):typeof v=="string"?c=v:typeof v=="function"&&(c=v.call(l.element[0],{width:wd,value:f,value2:p,column:h,dataIndx:s,cls:r,attr:o,style:e}));t.push(["<td class='",y,"'><div class='pq-td-div' >","",c,"<\/div><\/td>"].join(""))}else t.push(["<td class='",y,"'><div class='pq-td-div' >","&nbsp;","<\/div><\/td>"].join(""))}t.push("<\/tr>")};r._input=function(n,t,i,r,u){return['<input value="',t,"\" name='",n,"' type=text style='"+r+"' class='"+i+"' "+u+" />"].join("")};r._textarea=function(n,t,i,r,u){return["<textarea name='",n,"' style='"+r+"' class='"+i+"' "+u+" >",t,"<\/textarea>"].join("")};n.paramquery.select=function(n){var nt=n.attr,u=n.options,y=n.groupIndx,o=n.labelIndx,s=n.valueIndx,tt=o!=null&&s!=null,p=y!=null,h=n.prepend,c=n.dataMap,f,l,a,it=function(){for(var i,r={},n=0;n<c.length;n++)i=c[n],r[i]=t[i];return"data-map='"+JSON.stringify(r)+"'"},i=["<select ",nt," >"],e,w,t,d,g,r;if(h)for(r in h)i.push('<option value="',r,'">',h[r],"<\/option>");if(u&&u.length){for(e=0,w=u.length;e<w;e++)if(t=u[e],tt){var v=t[s],b=t.pq_disabled?'disabled="disabled" ':"",k=t.pq_selected?'selected="selected" ':"";if(v==null)continue;a=c?it():"";p&&(d=t.pq_disabled_group?'disabled="disabled" ':"",f=t[y],l!=f&&(l!=null&&i.push("<\/optgroup>"),i.push('<optgroup label="',f,'" ',d," >"),l=f));o==s?i.push("<option ",k,b,a,">",v,"<\/option>"):(g=t[o],i.push("<option ",k,b,a,' value="',v,'">',g,"<\/option>"))}else if(typeof t=="object")for(r in t)i.push('<option value="',r,'">',t[r],"<\/option>");else i.push("<option>",t,"<\/option>");p&&i.push("<\/optgroup>")}return i.push("<\/select>"),i.join("")};n.fn.pqval=function(n){var t;return n?n.incr?(t=this.data("pq_value"),this.prop("indeterminate",!1),t?(t=!1,this.prop("checked",!1)):t===!1?(t=null,this.prop("indeterminate",!0),this.prop("checked",!1)):(t=!0,this.prop("checked",!0)),this.data("pq_value",t),t):(t=n.val,this.data("pq_value",t),this.prop("indeterminate",!1),t==null?(this.prop("indeterminate",!0),this.prop("checked",!1)):t?this.prop("checked",!0):this.prop("checked",!1),this):this.data("pq_value")};f={};f._generateTitleRow=function(n,t,i){var c=this.that,l=c.options,a=l.numberCell,u=t.groupTitle,e=t.level,v=t.GMRowIndx,f=n.title,r=n.icon,r=r?r[e]:null,r=r&&r.length&&r.length==2&&typeof r.push=="function"?r:["ui-icon-minus","ui-icon-plus"],s,o,h;if(f&&f[e]!=null){if(f=f[e],f===!1)return;typeof f=="function"?u=f(t):(u=f.replace("{0}",u),u=u.replace("{1}",t.items))}else u=u+" - "+t.items+" item(s)";s='pq-group-row pq-grid-row",(lastFrozenRow?" pq-last-frozen-row":""),"';o=n.titleCls;o&&(o=o[e])&&(s+=" "+o);i.push(["<tr class='",s,"' title=\"",t.groupTitle,"\" level='",e,"' GMRowIndx='",v,"'>"].join(""));a.show&&i.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;<\/td>");h=r[0];t.collapsed&&(h=r[1]);i.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",e*16,"px;'>","<span class='ui-icon ",h,"'><\/span>",u,"<\/div><\/td>");i.push("<\/tr>")};f._generateSummaryRow=function(n,t,i,r,u){var y=t.level,nt=t.rowData,p="pq-summary-row pq-grid-row"+(u?" pq-last-frozen-row":""),c=n.summaryCls,e,o,v,d,s,f,h,g;c&&(c=c[y])&&(p+=" "+c);var l=this.that,a=l.options,tt=a.virtualX,w=l.initH,b=l.finalH,k=a.freezeCols,it=a.numberCell,rt=a.columnBorders,ft=this.offset,ut="<tr class='"+p+"'>";for(r.push(ut),it.show&&r.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;<\/td>"),e=0;e<=b;e++){if(e<w&&e>=k&&tt&&(e=w,e>b))throw"initH>finalH";(o=i[e],v=o.dataIndx,o.hidden)||(d="",s="pq-grid-cell ",o.align=="right"?s+=" pq-align-right":o.align=="center"&&(s+=" pq-align-center"),e==k-1&&rt&&(s+=" pq-last-frozen-col"),o.cls&&(s=s+" "+o.cls),f=nt[v],f&&(h=o.summary.title)&&(h=h[y])&&(typeof h=="function"?(t.dataIndx=v,t.cellData=f,f=h.call(l.element[0],t)):f=h.replace("{0}",f)),f=f==null?"&nbsp;":f,g=["<td class='",s,"' style='",d,"' >",f,"<\/td>"].join(""),r.push(g))}return r.push("<\/tr>"),r};f._generateDetailRow=function(n,t,i,r,u,f){var e="pq-grid-row pq-detail-child",s;f&&(e+=" pq-last-frozen-row");var c=this.that,o=c.options,l=o.numberCell,a=i.length,v=this.offset,h="pq-grid-cell ";return(!o.wrap||u)&&(h+="pq-wrap-text "),o.stripeRows&&t/2==parseInt(t/2)&&(e+=" pq-grid-oddRow"),n.pq_rowselect&&(e+=" pq-row-select ui-state-highlight"),s=n.pq_rowcls,s!=null&&(e+=" "+s),r.push("<tr pq-row-indx='"+t+"' class='"+e+"' >"),l.show&&r.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;<\/td>"),r.push("<td class='"+h+" pq-detail-child' colSpan='20'><\/td>"),r.push("<\/tr>"),r};h=function(n){this.that=n};i=h.prototype;i._refreshDataFromDataModel=function(){this._groupData();this.initcollapsed()};i.bindEvents=function(){var n=this;this.that.$cont.on("click","tr.pq-group-row",function(t){return n.onClickGroupRow(t)})};i.showHideRows=function(n,t,i){for(var r,f,e=[],s=this.that,o=s.dataGM,u=n,h=o.length;u<h;u++)if(r=o[u],f=r,f.groupSummary)if(r.level<t)break;else r.pq_hidden=i;else if(f.groupTitle)if(r.collapsed&&e.push({indx:u,level:r.level}),r.level<=t)break;else r.pq_hidden=i;else r.pq_hidden=i;return e};i.onClickGroupRow=function(t){var s=n(t.currentTarget),h=this.that,r=parseInt(s.attr("level")),f=parseInt(s.attr("GMRowIndx")),l=h.dataGM,e=!0,o=l[f],u,i,c;if(o.collapsed?(o.collapsed=!1,e=!1):(o.collapsed=!0,e=!0),e)this.showHideRows(f+1,r,!0);else for(u=this.showHideRows(f+1,r,!1),i=0;i<u.length;i++)c=u[i].indx,r=u[i].level,this.showHideRows(c+1,r,!0);h.refresh()};i.initcollapsed=function(){var o=this.that,i=o.dataGM,n,r,t,u,f,e;if(i)for(n=0,r=i.length;n<r;n++)t=i[n],u=t.groupTitle,u!==undefined&&(f=t.level,e=t.collapsed,e&&this.showHideRows(n+1,f,!0))};i.max=function(n,t){var i;return t=="integer"||t=="float"?(i=Math.max.apply(Math,n),t==="float"&&(i=i.toFixed(2))):t=="date"?(n=n.sort(function(n,t){return n=Date.parse(n),t=Date.parse(t),n-t}),i=n[n.length-1]):(n=n.sort(),i=n[n.length-1]),i};i.min=function(n,t){var i;return t=="integer"||t=="float"?(i=Math.min.apply(Math,n),t==="float"&&(i=i.toFixed(2))):t=="date"?(n=n.sort(function(n,t){return n=Date.parse(n),t=Date.parse(t),n-t}),i=n[0]):(n=n.sort(),i=n[0]),i};i.count=function(n){return n.length};i.sum=function(n,t){var i=0,u,r,f;for(u=t==="float"?parseFloat:t==="integer"?parseInt:function(n){return n},r=0,f=n.length;r<f;r++)i+=u(n[r]);return t==="float"&&(i=i.toFixed(2)),i};i._groupData=function(){for(var g,c,e,u,b,k,ct,nt,lt,tt,it,i,rt,r,s,y=this.that,p=y.pdata,at=y.options,ut=at.groupModel,ft=at.pageModel,h=y.colModel,pt=ft.type?(ft.curPage-1)*ft.rPP:0,d=h.length,vt=ut.dataIndx,f=vt.length,et=ut.collapsed,ot=[],t=0;t<f;t++)for(ot[t]=!1,g=0;g<d;g++)if((r=h[g],c=r.summary,c)&&(e=c.type,e&&typeof e.push=="function")&&e[t]){ot[t]=!0;break}if(ut&&p&&p.length>0){var o=[],yt=[],w=[],st=[],l=[];for(t=0;t<f;t++)st[t]="",w[t]="",l[t]={};for(u=0,b=p.length;u<=b;u++){var a=p[u],ht=!1,v=null;for(t=0;t<f;t++)w[t]=u<b?n.trim(a[vt[t]]):"",st[t]!=w[t]&&(ht=!0),ht&&v==null&&(v=t);if(ht){for(k=0;k<f;k++)st[k]=w[k];if(u>0){for(t=f-1;t>=v;t--)if(ot[t]){for(ct=[],nt=0;nt<d;nt++){var r=h[nt],c=r.summary,e=c?c.type?c.type[t]:null:null;e&&(s=r.dataIndx,lt="",lt=typeof e=="function"?e(l[t][s],r.dataType):this[e](l[t][s],r.dataType),ct[s]=lt)}o.push({groupSummary:!0,level:t,prevRowData:p[u-1],rowData:ct})}for(i=v;i<f;i++)o[yt[i]].items=l[i][h[0].dataIndx].length}if(u==b)break;for(tt=f-1;tt>=v;tt--)for(it=0;it<d;it++)r=h[it],l[tt][r.dataIndx]=[];for(i=v;i<f;i++)o.push({groupTitle:w[i],level:i,nextRowData:a,GMRowIndx:o.length,collapsed:et&&et[i]!=null?et[i]:!1}),yt[i]=o.length-1}if(u==b)break;for(a.rowIndx=u+pt,a.pq_hidden=!1,o.push(a),rt=0;rt<d;rt++)for(r=h[rt],s=r.dataIndx,t=0;t<f;t++)l[t][s].push(a[s])}y.dataGM=o}else y.dataGM=null};t.options={detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check",rejectIcon:"ui-icon-closethick",topIcon:"ui-icon-circle-arrow-s",bottomIcon:"ui-icon-circle-arrow-n"},track:null,treeModel:{collapsed:!0,indent:15,leafIcon:"ui-icon-radio-off",expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},filterModel:{on:!0,mode:"AND",header:!1}};t._create=function(){n.extend(n.paramquery.cGenerateView.prototype,f);var i=this,t=this.options;this.iHistory=new n.paramquery.cHistory(this);this.iGroupView=new h(this);this.iHeaderSearch=new s(this);this.iUCData=new n.paramquery.cUCData(this);this.iMouseSelection=new n.paramquery.cMouseSelection(this);this._super();this.iGroupView.bindEvents();this.iDragColumns=new n.paramquery.cDragColumns(this);this._createToolbar();t.dataModel.location==="remote"&&this.refresh({table:!0});this.refreshDataAndView({header:!0})};t._createToolbar=function(){var h=this,e=this.options,o=e.toolbar;if(o){var t=o,i=t.cls,i=i?i:"",r=t.style,r=r?r:"",u=t.attr,u=u?u:"",s=t.items,f=n("<div class='"+i+"' style='"+r+"' "+u+" ><\/div>").appendTo(n(".pq-grid-top",this.element));f.pqToolbar({items:s,gridInstance:this});e.showToolbar||f.css("display","none");this.$toolbar=f}};t.isLeftOrRight=function(n){var i=this.options,t=this.freezeCols;return n>t?"right":"left"};t.ovCreateHeader=function(n,t){this.options.filterModel.header&&this.iHeaderSearch.createDOM(n,t)};t._createHeader=function(){this._super();this.options.showHeader&&this._trigger("createHeader")};t.exportExcel=function(t){return t.format="xml",n.paramquery.pqgrid.exportToExcel.call(this,t)};t.exportCsv=function(t){return t.format="csv",n.paramquery.pqgrid.exportToExcel.call(this,t)};t.filter=function(t){var b=this,k=this.options,v=t.apply===undefined?!0:t.apply,it=t.sort===undefined?!0:t.sort,rt=k.dataModel,ut=k.filterModel,h,f,y,c,e,s,l,tt,w,a;if(t!=undefined){var ft=t.oper=="replace"?!0:!1,d=t.data,u=this.colModel,u=v?u:n.extend(!0,[],u),g=0,et=u.length,nt=d.length;for(h=0;h<et;h++){for(f=u[h],y=!1,c=0;c<nt;c++){if(g==nt)break;if(e=d[c],e.dataIndx==f.dataIndx){y=!0;g++;var r=f.filter,o=e.condition,i=e.value;if(r?r.on=!0:r=f.filter={on:!0},o&&(r.condition=o),o=r.condition,r.value=i,o=="between")r.value2=e.value2;else if(o=="range"){if(s=[],i)if(typeof i=="string"){var p=r.options,ot=i.indexOf('"'),st=i.lastIndexOf('"');if(i=i.substr(ot,st+1),i=JSON.parse("["+i+"]"),p)for(l=0,tt=p.length;l<tt;l++)w=p[l],n.inArray(w,i)!=-1&&s.push(w);else s=i.split(",s*")}else typeof i.push=="function"&&(s=i);r.value=s}break}}ft&&!y&&f.filter&&(f.filter.on=!1)}}if(a={header:!1,apply:v,sort:it,CM:u},rt.location=="remote"&&ut.type!="local")this.remoteRequest({apply:v,CM:u,callback:function(){return b._onDataAvailable(a)}});else return a.source="filter",b._onDataAvailable(a)};t._initTypeColumns=function(){for(var t,r,u=this.colModel,i=0,f=u.length;i<f;i++)t=u[i],r=t.type,r==="checkBoxSelection"?new n.paramquery.cCheckBoxColumn(this,t):r==="detail"&&(t.dataIndx="pq_detail",this.iHierarchy=new n.paramquery.cHierarchy(this))};t.refreshHeader=function(){this._createHeader()};t.refreshDataFromDataModel=function(){this._super.apply(this);var n=this.options,t=n.groupModel,i=t?!0:!1;i&&this.iGroupView._refreshDataFromDataModel()};c=n.paramquery.cSort=function(n){this.that=n};e=c.prototype;e._refreshSorters=function(t,i){var d=this.that,p=d.options,r=p.dataModel,h=r.sortIndx,w=n.isArray(h),o=p.groupModel,b=o?o.dataIndx:null,c=o?o.dir:null,s=-1,f=[],l,k,a,e,v,u,y;if(o)for(u=0;u<b.length;u++)l=b[u],l==t&&(s=u),f.push({dataIndx:l,dir:c&&c[u]?c[u]:"up"});if(s!==-1?(k=f[s].dir,a=k==="up"?"down":"up",f[s].dir=a,c[s]=a):t!=null&&(w?(e=n.inArray(t,r.sortIndx),e!=-1?r.sortDir[e]=="up"?r.sortDir[e]="down":h.length==1?r.sortDir[e]="up":(r.sortIndx.splice(e,1),r.sortDir.splice(e,1)):(v=r.sortIndx.length,r.sortIndx[v]=t,r.sortDir[v]="up")):r.sortIndx==t?r.sortDir=i?i:r.sortDir=="up"?"down":"up":(r.sortIndx=t,r.sortDir=i?i:"up")),r.sortIndx!=null)if(w)for(u=0;u<h.length;u++)y=h[u],this.inSorters(f,y)==-1&&f.push({dataIndx:y,dir:r.sortDir[u]});else this.inSorters(f,r.sortIndx)==-1&&f.push({dataIndx:r.sortIndx,dir:r.sortDir});this.sorters=f};e.inSorters=function(n,t){for(var u,r=-1,i=0;i<n.length;i++)if(u=n[i],u.dataIndx==t){r=i;break}return r};e.sortLocalData=function(n){for(var u=this.that,e=u.colModel,t=this.sorters,i=0;i<t.length;i++){var r=t[i],o=r.dataIndx,s=u.getColIndx({dataIndx:o}),f=e[s],h=f.sortType,c=f.dataType;r.dataType=c;r.sortType=h}return this._sortLocalData(t,n)};e._sortLocalData=function(n,t){function i(n,t,i,r){var u=n[i],f=t[i];return u=u?parseInt(u,10):0,f=f?parseInt(f,10):0,(u-f)*r}function r(n,t,i,r){var u=n[i],f=t[i];return u=u?Date.parse(u):0,f=f?Date.parse(f):0,(u-f)*r}function u(n,t,i,r,u){var f=n[i],e=t[i];return u(f,e)*r}function f(n,t,i,r,u){return u(n,t,i)*r}function e(n,t,i,r){var u=(n[i]+"").replace(/,/g,""),f=(t[i]+"").replace(/,/g,"");return u=u?parseFloat(u):0,f=f?parseFloat(f):0,(u-f)*r}function o(n,t,i,r){var u=n[i],f=t[i],e;return u=u?u:"",f=f?f:"",e=0,u>f?e=1:u<f&&(e=-1),e*r}function s(n,t,i,r){var u=n[i],f=t[i],e;return u=u?u.toUpperCase():"",f=f?f.toUpperCase():"",e=0,u>f?e=1:u<f&&(e=-1),e*r}function h(n,t,i,r){var u=n[i],f=t[i],e=0;return u&&!f||u===!1&&f===null?e=1:(f&&!u||f===!1&&u===null)&&(e=-1),e*r}function c(){function k(n,t){for(var r=0,i=0;i<w;i++)if(r=v[i](n,t,y[i],p[i]),r!=0)break;return r}for(var v=[],y=[],p=[],w=n.length,l=0;l<w;l++){var a=n[l],d=a.dataIndx,g=a.dir=="up"?1:-1,b=a.sortType,c=a.dataType;y[l]=d;p[l]=g;v[l]=c=="integer"?i:c=="float"?e:typeof c=="function"?function(n){return function(t,i,r,f){return u(t,i,r,f,n)}}(c):b?function(n){return function(t,i,r,u){return f(t,i,r,u,n)}}(b):c=="date"?r:c=="stringi"?s:c=="bool"?h:o}t=t.sort(k)}return t==null||t.length==0?[]:!n||!n.length?t:(c(),t)};t._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()};t.getIndxInSorters=function(n){for(var i=this.sorters,t=0,r=i.length;t<r;t++)if(i[t].dataIndx==n)return t;return-1};t.getLargestRowCol=function(n){for(var i,u,t,r=0;r<n.length;r++)i=n[r],u=i.rowIndx,t==null?t=i.rowIndx:u>t&&(t=u),t=i.rowIndx};t.bringCellToView=function(n){this._bringCellToView(n)};t._setUrl=function(n){this.options.dataModel.getUrl=function(){return{url:this.url+(n!=null?n:"")}}};t.getDataPage=function(){return this.pdata};t.getData=function(n){var u=n.dataIndx,a=u.length,v=n.data,y=this.options.dataModel,p=y.data,w=y.dataUF,t=[],f=function(n){for(var s,f,r,e,i=0,o=n.length;i<o;i++){for(s=n[i],f={},r=0;r<a;r++)e=u[r],f[e]=s[e];t.push(f)}},e,i,o,b,s,h,r,c,l;for(v?f(v):(p&&f(p),w&&f(w)),e=[],i=0;i<a;i++)o=u[i],b=this.getColumn({dataIndx:o}),e.push({dataIndx:o,dir:"up",dataType:b.dataType});for(t=this.iSort._sortLocalData(e,t),s=[],h=undefined,r=0;r<t.length;r++)c=t[r],l=JSON.stringify(c),l!==h&&(s.push(c),h=l);return s};t.getFilterData=function(t){var y=t.CM,a,c,l,e,nt;if(!y)throw"CM N/A";var tt=y.length,p=t.location,it=this.options.filterModel,rt=it.multiple,ut=n.paramquery.filter.getAllConditions,ft=n.paramquery.filter.getTRConditions,w=[],b=function(t,i,r){return t=="between"?(i==null||i==="")&&(r==null||r==="")?!1:!0:n.inArray(t,ut)!=-1?(i==null||i==="")&&n.inArray(t,ft)!=-1?!1:!0:!0},o=function(n,t){return p=="remote"?(n=n==null?"":n,n.toString()):u.convert(n,t)};for(a=0;a<tt;a++){var v=y[a],k=v.dataIndx,r=v.dataType,r=!r||typeof r=="function"?"string":r,s=v.filter;if(rt){if(c=v.filterModel,c&&c.on){var d=[],et=c.mode,g=c.filters;for(e=0;e<g.length;e++){var s=g[e],i=s.value,f=s.condition;b(f,i)&&(i=o(i,r),d.push({value:i,condition:f}))}w.push({dataIndx:k,mode:et,dataType:r,filters:d})}}else if(s&&s.on){var i=s.value,h=s.value2,f=s.condition;if(b(f,i,h)){if(f=="between")i===""||i==null?(f="lte",i=o(h,r)):h===""||h==null?(f="gte",i=o(i,r)):(i=o(i,r),h=o(h,r));else if(f=="regexp"){if(p=="remote")i=i.toString();else if(typeof i=="string")try{l=s.modifiers;l=l?l:"gi";i=new RegExp(i,l)}catch(ot){i=/.*/}}else if(f=="range"){if(i==null)continue;else if(typeof i=="string")i=o(i,r),i=i.split(/\s*,\s*/);else if(i&&typeof i.push=="function"){if(i.length==0)continue;for(i=i.slice(),e=0,nt=i.length;e<nt;e++)i[e]=o(i[e],r)}}else i=o(i,r);w.push({dataIndx:k,value:i,value2:h,condition:f,dataType:r,cbFn:p=="remote"?"":u.conditions[f]})}}}return w};u=function(n){this.that=n};o=u.prototype;u.conditions={equal:function(n,t){if(n==t)return!0},contain:function(n,t){if(n.indexOf(t)!=-1)return!0},notcontain:function(n,t){if(n.indexOf(t)==-1)return!0},empty:function(n){if(n.length==0)return!0},notempty:function(n){if(n.length>0)return!0},begin:function(n,t){if((n+"").indexOf(t)==0)return!0},notbegin:function(n,t){if(n.indexOf(t)!=0)return!0},end:function(n,t){var i=n.lastIndexOf(t);if(i!=-1&&i+t.length==n.length)return!0},notend:function(n,t){var i=n.lastIndexOf(t);if(i==-1||i+t.length!=n.length)return!0},regexp:function(n,t){if(t.test(n))return t.lastIndex=0,!0},notequal:function(n,t){if(n!=t)return!0},great:function(n,t){if(n>t)return!0},gte:function(n,t){if(n>=t)return!0},between:function(n,t,i){if(n>=t&&n<=i)return!0},range:function(t,i){if(n.inArray(t,i)!=-1)return!0},less:function(n,t){if(n<t)return!0},lte:function(n,t){if(n<=t)return!0}};u.convert=function(t,i){return t=t==null?"":t,i=="string"?t=n.trim(t).toUpperCase():i=="date"?t=Date.parse(t):i=="integer"?t=parseInt(t):i=="float"?t=parseFloat(t):i=="bool"&&(t=String(t).toLowerCase()),t};o.isMatchCellSingle=function(n,t){var r=n.dataIndx,f=n.dataType,e=n.value,o=n.value2,s=n.condition,h=n.cbFn,i=t[r];return i=s=="regexp"?i==null?"":i:u.convert(i,f),h(i,e,o)?!0:!1};o.isMatchCellMultiple=function(n,t){var s=n.dataIndx,h=n.dataType,i=n.mode,e=n.filters,u=e.length,r;if(u==0)return!0;for(r=0;r<u;r++){var o=e[r],c=o.value,l=o.condition,a=t[s],f=this.isMatchRule(a,l,c,h);if(i=="OR"&&f)return!0;if(i=="AND"&&!f)return!1}return u===1?f:i=="AND"?!0:i=="OR"?!1:void 0};o.isMatchRow=function(n,t,i){var r,f,u;if(t.length==0)return!0;for(r=0;r<t.length;r++){if(f=t[r],u=this.isMatchCell(f,n),i=="OR"&&u)return!0;if(i=="AND"&&!u)return!1}return i=="AND"?!0:i=="OR"?!1:void 0};t.filterLocalData=function(n){var t,r,i;n=n?n:{};var v=n.apply,y=v===!1?n.CM:this.colModel,p=this.getFilterData({CM:y}),w=this.options,s=w.dataModel,f=s.data,e=s.dataUF,o=[],l=[],h=w.filterModel,b=h.multiple,a=h?h.mode:null,c=new u;if(c.isMatchCell=b?c.isMatchCellMultiple:c.isMatchCellSingle,h.on&&a){if(f)for(t=0,r=f.length;t<r;t++)i=f[t],c.isMatchRow(i,p,a)?o.push(i):l.push(i);if(e)for(t=0,r=e.length;t<r;t++)i=e[t],c.isMatchRow(i,p,a)?o.push(i):l.push(i)}else{if(f)for(t=0,r=f.length;t<r;t++)i=f[t],o.push(i);if(e)for(t=0,r=e.length;t<r;t++)i=e[t],o.push(i)}return v&&(s.data=o,s.dataUF=l,this._trigger("filter",null,{type:"local",dataModel:s,colModel:y,filterModel:h})),{data:o,dataUF:l}};t._onDataAvailable=function(n){n=n?n:{};var u=this.options,f=n.apply,o=n.source,s=n.sort,i=[],r=u.filterModel,t=u.dataModel,e=t.location;if(f!==!1&&this._trigger("dataAvailable",n.evt,{dataModel:t,source:o}),i=r&&r.on&&(e=="local"&&r.type!="remote"||e=="remote"&&r.type=="local")?this.filterLocalData(n).data:t.data,t.sorting&&t.sorting=="local"&&s!==!1&&(i=this.iSort.sortLocalData(i)),f===!1)return i;t.data=i;this.refreshView(n)};t.sort=function(n){var f;n=n?n:{};var r=this,o=this.options,u=n.colIndx,s=o.editModel,t=n.dataIndx,h=n.dir,e=n.evt,i=o.dataModel;(u!=null||t!=null||(t=i.sortIndx,t!=null))&&(u=u==null?this.getColIndx({dataIndx:t}):u,f=this.colModel[u],t=t==null?f.dataIndx:t,r._trigger("beforeSort",e,{dataModel:i,column:f,dataIndx:t})!=!1)&&(s.indices&&r.blurEditor({force:!0}),this.iSort._refreshSorters(t,h),i.sorting=="local"?(this.iSort.sortLocalData(i.data),r._trigger("sort",e,{dataModel:i,column:f,dataIndx:t}),this.refreshView()):i.sorting=="remote"&&this.remoteRequest({callback:function(){r._trigger("sort",e,{dataModel:i,column:f,dataIndx:t});r._onDataAvailable()}}))};n.widget("paramquery.pqGrid",n.paramquery._pqGrid,t);n.paramquery.pqGrid.regional={};n.paramquery.pqGrid.regional.en=t._regional}(jQuery),function(n){n.paramquery=n.paramquery==null?{}:n.paramquery;n.paramquery.pqgrid=n.paramquery.pqgrid==null?{}:n.paramquery.pqgrid;n.paramquery.pqgrid.exportToExcel=function(t){var i=this,f=t.urlPost===undefined?t.url:t.urlPost,r=t.url,e=t.sheetName==null?"pqGrid":t.sheetName,u=t.format,o=function(){for(var l,s,t,a,v,o=i.colModel,h=o.length,y=i.options,p=y.dataModel,c=p.data,w=c.length,u,f=[],r=[],n=0;n<h;n++)t=o[n],t.copy!==!1&&(u=t._width,u||(u=parseInt(t.width),u||(u=100)),r.push('<Column ss:AutoFitWidth="1"  ss:Width="'+u+'" />'));for(r.push("<Row>"),n=0;n<h;n++)t=o[n],t.copy!==!1&&r.push('<Cell><Data ss:Type="String">'+t.title+"<\/Data><\/Cell>");for(r.push("<\/Row>"),r=r.join("\n"),n=0;n<w;n++){for(l=c[n],f.push("<Row>"),s=0;s<h;s++)t=o[s],t.copy!==!1&&(a=t.dataIndx,f.push('<Cell><Data ss:Type="String"><![CDATA['+l[a]+"]\]><\/Data><\/Cell>"));f.push("<\/Row>")}return f=f.join("\n"),v=['<?xml version="1.0"?>','<?mso-application progid="Excel.Sheet"?>','<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:o="urn:schemas-microsoft-com:office:office"',' xmlns:x="urn:schemas-microsoft-com:office:excel"',' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:html="http://www.w3.org/TR/REC-html40">','<Worksheet ss:Name="',e,'">',"<Table>",r,f,"<\/Table>","<\/Worksheet>","<\/Workbook>"],v.join("\n")},s=function(){for(var l,a,r,t,v,u,f=i.colModel,s=f.length,y=i.options,p=y.dataModel,h=p.data,w=h.length,e=[],c=[],o=[],n=0;n<s;n++)t=f[n],t.copy!==!1&&(l=t.title.replace(/\"/g,'""'),c.push('"'+l+'"'));for(e.push(c.join(",")),n=0;n<w;n++){for(a=h[n],r=0;r<s;r++)t=f[r],t.copy!==!1&&(v=t.dataIndx,u=a[v]+"",u=u.replace(/\"/g,'""'),o.push('"'+u+'"'));e.push(o.join(","));o=[]}return e.join("\n")},h=u=="xml"?o():s();n.ajax({url:f,type:"POST",cache:!1,data:{extension:u,excel:h},success:function(t){var i=r+((r.indexOf("?")>0?"&":"?")+"filename="+t);n(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+i+"><\/iframe>")}})}}(jQuery),function(n){var r=n.paramquery.pqGrid.prototype.options,u,t,i;r.trackModel=r.trackModel||{on:!1,dirtyClass:"pq-cell-dirty"};u=n.paramquery.cUCData=function(n){this.that=n;this.udata=[];this.ddata=[];this.adata=[];this.options=n.options;var t=this,i=n.eventNamespace,r=n.widgetEventPrefix.toLowerCase();n.element.on(r+"dataavailable"+i,function(n,i){t.belongs(n)&&i.source!="filter"&&(t.udata=[],t.ddata=[],t.adata=[])})};t=u.prototype=new n.paramquery.cClass;t.add=function(n){for(var f,e,s,n,o=this.that,i=this.adata,t=n.rowData,h=this.options.trackModel,c=h.dirtyClass,r=o.getRecId({rowData:t}),u=0,l=i.length;u<l;u++){if(f=i[u],r!=null&&f.recId==r)throw"primary key violation";if(f.rowData==t)throw"same data can't be added twice.";}e=[];for(s in t)e.push(s);o.removeClass({rowData:t,dataIndx:e,cls:c});n={recId:r,rowData:t};i.push(n)};t.update=function(t){var e=this.that,nt=this.options.trackModel,s=nt.dirtyClass,u=t.rowData||e.getRowData(t),y=e.getRecId({rowData:u}),i=t.dataIndx,h=t.refresh,tt=e.columns,p=n.paramquery.getValueFromDataType,c=t.row,l=this.udata,a=l.slice(0),w=!1,o,b,v,r,f;if(y!=null){for(o=0,b=l.length;o<b;o++)if(v=l[o],r=v.oldRow,v.rowData==u){w=!0;for(i in c){var it=tt[i],k=it.dataType,d=c[i],d=p(d,k),g=r[i],g=p(g,k);r.hasOwnProperty(i)&&g===d?(f={rowData:u,dataIndx:i,refresh:h,cls:s},e.removeClass(f),delete r[i]):(f={rowData:u,dataIndx:i,refresh:h,cls:s},e.addClass(f),r.hasOwnProperty(i)||(r[i]=u[i]))}n.isEmptyObject(r)&&a.splice(o,1);break}if(!w){r={};for(i in c)r[i]=u[i],f={rowData:u,dataIndx:i,refresh:h,cls:s},e.addClass(f);f={rowData:u,recId:y,oldRow:r};a.push(f)}this.udata=a}};t["delete"]=function(n){for(var u=this.that,t=n.rowIndx,i=n.rowIndxPage,e=u.rowIndxOffset,t=t==null?i+e:t,i=i==null?t-e:i,s=u.options.pageModel.type,h=s=="remote"?i:t,f=this.adata,c=this.ddata,o=u.getRowData(n),r=0,l=f.length;r<l;r++)if(f[r].rowData==o){f.splice(r,1);return}c.push({indx:h,rowData:o,rowIndx:t})};t.isDirty=function(n){var e=this.that,i=this.udata,o=this.adata,s=this.ddata,r=!1,u=e.getRowData(n),t,f;if(u){for(t=0;t<i.length;t++)if(f=i[t],u==f.rowData){r=!0;break}}else(i.length||o.length||s.length)&&(r=!0);return r};t.getChangesValue=function(){for(var e,r,u,t,w=this.that,o=this.udata,s=this.adata,h=this.ddata,f={updateList:[],addList:[],deleteList:[]},c=[],l=[],a=[],v=[],y=[],i=0,p=h.length;i<p;i++){var e=h[i],r=e.rowData,u={};v.push(r);for(t in r)t.indexOf("pq_")!=0&&(u[t]=r[t]);y.push(u)}for(i=0;i<o.length;i++)if((e=o[i],r=e.rowData,n.inArray(r,v)==-1)&&n.inArray(r,c)==-1){u={};for(t in r)t.indexOf("pq_")!=0&&(u[t]=r[t]);c.push(r);l.push(u)}for(i=0;i<s.length;i++){var e=s[i],r=e.rowData,u={};for(t in r)t.indexOf("pq_")!=0&&(u[t]=r[t]);a.push(u)}return f.updateList=l,f.addList=a,f.deleteList=y,f};t.getChanges=function(){for(var r,i,a=this.that,s=this.udata,h=this.adata,c=this.ddata,f={updateList:[],addList:[],deleteList:[]},e=[],l=[],o=[],t=0,u=c.length;t<u;t++)r=c[t],i=r.rowData,o.push(i);for(t=0,u=s.length;t<u;t++)(r=s[t],i=r.rowData,n.inArray(i,o)==-1)&&n.inArray(i,e)==-1&&e.push(i);for(t=0,u=h.length;t<u;t++)r=h[t],i=r.rowData,l.push(i);return f.updateList=e,f.addList=l,f.deleteList=o,f};t.getChangesRaw=function(){var u=this.that,t=this.udata,i=this.adata,r=this.ddata,n={updateList:[],addList:[],deleteList:[]};return n.updateList=t,n.addList=i,n.deleteList=r,n};t.commitAdd=function(t,i){for(var h,c,e,v,y,p,r,u,w=this.that.colModel,rt=w.length,f=this.adata,b=n.inArray,k=f.length,d=n.paramquery.getValueFromDataType,g=[],ut=t.length,o=[],s=0;s<ut;s++)for(h=t[s],r=0;r<k;r++)if(u=f[r].rowData,c=!0,b(u,o)==-1){for(e=0;e<rt;e++){var l=w[e],ft=l.hidden,nt=l.dataType,a=l.dataIndx;if(!ft&&a!=i){var tt=u[a],tt=d(tt,nt),it=h[a],it=d(it,nt);if(tt!==it){c=!1;break}}}if(c){v={};y={};v[i]=h[i];y[i]=u[i];g.push({type:"update",rowData:u,oldRow:y,newRow:v});o.push(u);break}}for(p=[],r=0;r<k;r++)u=f[r].rowData,b(u,o)==-1&&p.push(f[r]);return this.adata=p,g};t.commitUpdate=function(t,i){for(var e,p,o,w,h,c,u,l=this.that,b=this.options.trackModel.dirtyClass,a=l.colModel,k=a.length,f=this.udata,v=f.length,d=t.length,s=[],r=0;r<v;r++){var y=f[r],u=y.rowData,g=y.oldRow;if(n.inArray(u,s)==-1)for(e=0;e<d;e++)if(p=t[e],u[i]==p[i]){for(s.push(u),o=0;o<k;o++)w=a[o],h=w.dataIndx;for(h in g)l.removeClass({rowData:u,dataIndx:h,cls:b})}}for(c=[],r=0;r<v;r++)u=f[r].rowData,n.inArray(u,s)==-1&&c.push(f[r]);return this.udata=c,[]};t.commitDelete=function(t,i){for(var e,c,o,u,f=this.ddata,s=f.length,l=t.length,h=[],r=0;r<s;r++)for(u=f[r].rowData,e=0;e<l;e++)c=t[e],u[i]==c[i]&&h.push(u);for(o=[],r=0;r<s;r++)u=f[r].rowData,n.inArray(u,h)==-1&&o.push(f[r]);this.ddata=o};t.commitUpdateAll=function(){for(var r,u=this.that,f=this.options.trackModel.dirtyClass,t=this.udata,n=0,e=t.length;n<e;n++){var i=t[n],o=i.oldRow,s=i.rowData;for(r in o)u.removeClass({rowData:s,dataIndx:r,cls:f})}this.udata=[]};t.commitAddAll=function(){this.adata=[]};t.commitDeleteAll=function(){this.ddata=[]};t.commit=function(n){var r=this.that,u=n?n.history:null,u=u==null?!1:u,h=r.options.dataModel,f=[],o=[],s=[],e=h.recIndx,i,t;n==null?(this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll()):(i=n.type,t=n.rows,i=="add"?t?o=this.commitAdd(t,e):this.commitAddAll():i=="update"?t?s=this.commitUpdate(t,e):this.commitUpdateAll():i=="delete"&&(t?this.commitDelete(t,e):this.commitDeleteAll()));f=o.concat(s);f.length&&(r._digestData({source:"commit",checkEditable:!1,track:!1,history:u,rowList:f}),r.refreshView())};t.rollbackAdd=function(n){for(var u,f,i=this.adata,r=[],o=n.type,t=0,e=i.length;t<e;t++)u=i[t],f=u.rowData,r.push({type:"delete",rowData:f});return this.adata=[],r};t.rollbackDelete=function(n){for(var r=this.ddata,u=[],o=n.type,t=r.length-1;t>=0;t--){var i=r[t],s=i.indx,f=i.rowIndx,e=i.rowData;u.push({type:"add",rowIndx:f,newRow:e})}return this.ddata=[],u};t.rollbackUpdate=function(){for(var u,n,h=this.that,c=this.options.trackModel.dirtyClass,f=this.udata,e=[],t=0,l=f.length;t<l;t++){var i=f[t],a=i.recId,r=i.rowData,o={},s=i.oldRow;if(a!=null){u=[];for(n in s)o[n]=r[n],u.push(n);h.removeClass({rowData:r,dataIndx:u,cls:c,refresh:!1});e.push({type:"update",rowData:r,newRow:s,oldRow:o})}}return this.udata=[],e};t.rollback=function(n){var i=this.that,h=i.options.dataModel,r=i.options.pageModel,c=n&&n.refresh!=null?n.refresh:!0,t=n&&n.type!=null?n.type:null,f=[],e=[],o=[],s=[],u=h.data;(t==null||t=="update")&&(o=this.rollbackUpdate(r,u));(t==null||t=="delete")&&(e=this.rollbackDelete(r,u));(t==null||t=="add")&&(s=this.rollbackAdd(r,u));f=e.concat(s,o);i._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:f});c&&i.refreshView()};i=n.paramquery.pqGrid.prototype;i.getChanges=function(n){if(this.blurEditor({force:!0}),n){var t=n.format;if(t){if(t=="byVal")return this.iUCData.getChangesValue();if(t=="raw")return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()};i.rollback=function(n){this.blurEditor({force:!0});this.iUCData.rollback(n)};i.isDirty=function(n){return this.iUCData.isDirty(n)};i.commit=function(n){this.iUCData.commit(n)};i._getRowIndx=function(){var n=this,t=n.selection({type:"row",method:"getSelection"});if(t&&t.length>0){var i=t[0].rowIndx,f=n.rowIndxOffset,r=n.options.pageModel,e=r.type,u=i-f,o=r.rPP;if(e){if(u>=0&&u<o)return i}else return i}else return null};i.updateRow=function(n){var f=this,t=n.rowIndx,e=n.row,i=n.rowData||f.getRowData({rowIndx:t}),r,u,o;if(!i)return!1;r={};for(u in e)r[u]=i[u];if(o=this._digestData({source:n.source||"update",history:n.history,checkEditable:n.checkEditable,track:n.track,allowInvalid:n.allowInvalid,rowList:[{newRow:e,oldRow:r,rowData:i,rowIndx:t,type:"update"}]}),o===!1)return!1;n.refresh!==!1&&f.refreshRow({rowIndx:t})};i.updateElseAdd=function(n){var t=this,i=n.rowIndx,r=n.row,u=t.getRowData({rowIndx:i});u==null?(n.rowData=r,t.addRow(n)):t.updateRow(n)};i._fillForm=function(n){var t=this,c=t.options.dataModel,l=t.options.pageModel,a=l.type,v=c.data,r=t.colModel,u=t.rowIndxOffset,f=n.rowIndxPage==null?n.rowIndx-u:n.rowIndxPage,e=n.rowIndx==null?f+u:n.rowIndx,y=a=="remote"?f:e,o=v[y],s,i;for(this.rowData=o,this.$crudDialog.dialog("option","title","Edit Record ("+(e+1)+")"),s=this.$crudForm,i=0;i<r.length;i++){var p=r[i],h=p.dataIndx,w=o[h];s.find("*[name='"+h+"']").val(w)}};i.getRecId=function(n){var i=this,r=i.options.dataModel,t;return n.dataIndx=r.recIndx,t=i.getCellData(n),t==null?null:t};i.getCellData=function(n){var t=n.rowData||this.getRowData(n),i=n.dataIndx;return t?t[i]:null};i.getRowData=function(n){var e,i,c,r;if(!n)return null;if(e=n.rowData,e!=null)return e;var o=this.options,s=o.dataModel,a=o.pageModel,v=a.type,y=s.recIndx,h=n.recId,t=s.data;if(h!=null){for(i=0,c=t.length;i<c;i++)if(r=t[i],r[y]==h)return r}else{var u=n.rowIndx,f=n.rowIndxPage,l=this.rowIndxOffset,u=u!=null?u:f+l,f=f!=null?f:u-l,p=v=="remote"?f:u,r=t?t[p]:null;return r}return null};i.deleteRow=function(n){var r=this,t=n.rowIndx,u=n.rowIndxPage,f=r.rowIndxOffset,t=u!=null?u+f:t,i;t!=null&&(i=n.rowData||this.getRowData({rowIndx:t}),this._digestData({source:n.source||"delete",history:n.history,track:n.track,rowList:[{rowIndx:t,rowData:i,oldRow:i,type:"delete"}]}),n.refresh!==!1&&r.refreshView())};i.addRow=function(n){var u=this,f=n.rowData||n.row,t=n.rowIndx,e=n.rowIndxPage,s=u.rowIndxOffset,t=e!=null?e+s:t,h=u.options,i=h.dataModel,r=i.data,o;return f==null?null:(r==null&&(i.data=[],r=i.data),o=this._digestData({source:n.source||"add",history:n.history,track:n.track,checkEditable:n.checkEditable,rowList:[{newRow:f,rowIndx:t,type:"add"}]}),o===!1)?!1:(n.refresh!==!1&&this.refreshView(),t==null?r.length-1:t)}}(jQuery),function(n){var t={};t.options={items:[],gridInstance:null};t._create=function(){var rt=this,i=this.options,v=i.gridInstance,w=v.colModel,b=i.items,r=this.element,ut=r.closest(".pq-grid"),c,k,l,a,o,p;for(r.addClass("pq-toolbar"),c=0,k=b.length;c<k;c++){var t=b[c],u=t.type,it=t.icon,i=t.options,d=t.label,o=t.listener,y=o?[o]:t.listeners,g=t.cls,e="ui-corner-all "+(g?g:""),nt=t.style,s=nt?'style="'+nt+'"':"",tt=t.attr,h=tt?tt:"",f;if(u=="textbox"?f=n("<input type='text' class='"+e+"' "+h+" "+s+">").appendTo(r):u=="checkbox"?f=n("<input type='checkbox' class='"+e+"' "+h+" "+s+">").appendTo(r):u=="separator"?n("<span class='pq-separator '"+e+"' "+h+" "+s+"><\/span>").appendTo(r):u=="button"?(i=t.options?t.options:{},n.extend(i,{text:d?!0:!1,icons:{primary:it}}),f=n("<button type='button' class='"+e+"' "+h+" "+s+">"+d+"<\/button>").button(i).appendTo(r)):u=="select"?(i=t.options?t.options:[],typeof i=="function"&&(i=i.call(v.element[0],{colModel:w})),l=n.paramquery.select({options:i,attr:" class='"+e+"' "+h+" "+s,prepend:t.prepend,groupIndx:t.groupIndx,valueIndx:t.valueIndx,labelIndx:t.labelIndx}),f=n(l).appendTo(r)):typeof u=="string"?f=n(u).appendTo(r):typeof u=="function"&&(l=u.call(v.element[0],{colModel:w,cls:e}),f=n(l).appendTo(r)),y)for(a=0;a<y.length;a++){o=y[a];for(p in o)f.bind(p,o[p])}}};t._destroy=function(){this.element.empty().removeClass("pq-toolbar").enableSelection()};t._disable=function(){this.$disable==null&&(this.$disable=n("<div class='pq-grid-disable'><\/div>").css("opacity",.2).appendTo(this.element))};t._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)};t._setOption=function(n,t){n=="disabled"&&(t==!0?this._disable():this._enable())};n.widget("paramquery.pqToolbar",t)}(jQuery),function(n){var e=function(){this.focusSelection=null},r=e.prototype,u,f,t,i;r.triggerSelectChange=function(t){var i=this.that,f=i.options.selectionModel;if(f.fireSelectChange){var e=i.iRows.getSelection(),o=i.iCells.getSelection(),s=t.evt,r=t.ui,u={rows:e,cells:o};r=r==null?u:n.extend(u,r);i._trigger("selectChange",s,r)}};r.getOldRowSel=function(){var i=this.that,n,t;if((n=this.focusSelection)&&this.isSelected(n))return t=i.getRowIndx(n),t.rowData=n.rowData,t};r.getOldCellSel=function(){var r=this.that,n,i,t;if((n=this.focusSelection)&&this.isSelected(n))return i=n.rowData,t=r.getRowIndx({rowData:i}),t.rowData=i,t.dataIndx=n.dataIndx,t};r.getNewRowSel=function(){var r=this.that,t=document.activeElement?n(document.activeElement):null,u,i;if(t&&t.hasClass("pq-grid-row")&&(u=t.closest(".pq-grid"),u[0]==r.element[0]))return i=r.getRowIndx({$tr:t}),i.$tr=t,i};r.getNewCellSel=function(){var r=this.that,t=document.activeElement?n(document.activeElement):null,u,i;if(t&&t.hasClass("pq-grid-cell")&&(u=t.closest(".pq-grid"),u[0]==r.element[0]))return i=r.getCellIndices({$td:t}),i.$td=t,i};r.getFocusSelection=function(n){return this instanceof u?n&&n.old===!0?this.getOldRowSel():this.getNewRowSel():this instanceof f?n&&n.old===!0?this.getOldCellSel():this.getNewCellSel():void 0};r.getFirstSelection=function(){var t=this.firstSelection,n;return t&&this.isSelected(t)?t:(this.refresh(),n=this.selection,n.length)?(this.firstSelection=n[0],n[0]):void 0};r.getLastSelection=function(){var n=this.lastSelection;if(n){var t=this.that,i=n.rowData,r=t.getRowData({rowIndx:rowIndx});return i==r&&this.isSelected(n)?n:!1}return null};r.getLastSelectionCurPage=function(){var n=this.lastSelection,i,t,r,u;return n&&this.isSelected(n)?(i=n.rowIndx,t=this.that.options.pageModel,t.type?(r=t.curPage,u=t.rPP,Math.ceil((i+1)/u)==r?n:null):n):null};r.getSelection=function(){return this.refresh(),this.selection};r.getSelectionCurPage=function(){var s=this.that,t=this.getSelection(),u=[],h=s.options,i=h.pageModel,f,e,n,r,o;if(i.type){for(f=i.curPage,e=i.rPP,n=0;n<t.length;n++)r=t[n],o=r.rowIndx,Math.ceil((o+1)/e)==f&&u.push(r);return u}return t};r.inViewRow=function(n){var t=this.that,f=this.options,h=f.groupModel,c=t.rowIndxOffset,l=f.freezeRows,e=t.initV,o=t.finalV,i,r,s,u;if(n<l)return!0;if(h){if(i=t.dataGM,i&&i.length)for(r=e;r<=o;r++)if(s=i[r],u=s.rowIndx-c,u!=null&&u==n)return!0;return!1}return n>=e&&n<=o};r.setDirty=function(){};u=function(n){this.that=n;this.options=n.options;this.selection=[]};n.paramquery.cRows=u;f=function(n){this.options=n.options;this.that=n;this.selection=[]};n.paramquery.cCells=f;t=f.prototype=new e;i=u.prototype=new e;i.extendSelection=function(n){var r=this.that,t=n.rowIndx,o=r.options.selectionModel.mode,s=n.evt,u=this.getFirstSelection();if(u==null){r.setSelection({rowIndx:t});return}if(o!="single"){var i=u.rowIndx,f=i,e=t;i>t&&(f=t,e=i);this.selectRange({initRowIndx:f,finalRowIndx:e,evt:s});this.add({rowIndx:t})}};i.refresh=function(){var n,e,i,o;this.selection=[];var r=this.that,u=r.options,s=u.dataModel,h=u.pageModel,c=h.type,l=c=="remote"?!0:!1,a=r.rowIndxOffset,f=[],t=s.data;if(t){for(n=0,e=t.length;n<e;n++)i=t[n],i.pq_rowselect&&(o=l?n+a:n,f.push({rowIndx:o,rowData:i}));this.selection=f}};i.replace=function(n){var i=n.rowIndx,t=n.offset==null?this.that.getRowIndxOffset():n.offset,r=i-t,u=n.$tr,f=n.evt;n.offset=t;n.rowIndxPage=r;this.removeAll({raiseEvent:!0});this.add(n)};i.indexOf=function(n){var r,i,t;for(this.refresh(),r=n.rowIndx,i=this.selection,t=0;t<i.length;t++)if(i[t].rowIndx==r)return t;return-1};i.isSelected=function(n){var i=this.that,t=n.rowData||i.getRowData(n);return t?t.pq_rowselect==null?!1:t.pq_rowselect:null};i._boundRow=function(n){var i=n.rowIndxPage,r=this.that,t=n.$tr==null?r.getRow({rowIndxPage:i}):n.$tr;return t==null||t.length==0?!1:(t.addClass("pq-row-select ui-state-highlight"),t)};i.selectRange=function(n){for(var o,h,t,l=this.that,i=n.initRowIndx,r=n.finalRowIndx,f=n.evt,c=this.getSelection(),s=c.slice(0),u=[],e=0;e<s.length;e++)o=s[e],t=o.rowIndx,(t<i||t>r)&&u.push({rowIndx:t,rowData:o.rowData});for(this.remove({rows:u,evt:f}),u=[],i>r&&(h=i,i=r,r=h),t=i;t<=r;t++)u.push({rowIndx:t,evt:f});this.add({rows:u,evt:f})};t._addToData=function(n){var i=n.dataIndx,t=this.that.getRowData(n);t.pq_cellselect||(t.pq_cellselect={});t.pq_cellselect[i]=!0};t.extendSelection=function(n){var o=this.that,s=this.getFirstSelection(),i=n.rowIndx,t=n.colIndx,l=o.options.selectionModel.mode,a=n.evt;if(s==null){o.setSelection({rowIndx:i,colIndx:t});return}var u=s.rowIndx,r=o.getColIndx({dataIndx:s.dataIndx}),h=u,c=i,f=r,e=t;u>i&&(h=i,c=u);l=="range"?(u>i&&(f=t,e=r),i==u&&t<r&&(f=t,e=r),this.selectRange({initRowIndx:h,initColIndx:f,finalRowIndx:c,finalColIndx:e,evt:a}),this.add({rowIndx:i,colIndx:t})):l=="block"&&(r>t&&(f=t,e=r),this.selectBlock({initRowIndx:h,initColIndx:f,finalRowIndx:c,finalColIndx:e,evt:a}),this.add({rowIndx:i,colIndx:t}))};t._removeFromData=function(n){var t=n.rowData;t&&t.pq_cellselect&&delete t.pq_cellselect[n.dataIndx]};t.removeAll=function(){this.refresh();var n=this.selection.slice(0),t=this;t.remove({cells:n});this.lastSelection=null};i.removeAll=function(n){var r,u,t,i,o;if(n&&n.page!=null)throw"objP.page not supported in removeAll";if(r=this.that,u=n&&n.all!=null?n.all:!0,this.refresh(),t=this.selection.slice(0),u)this.remove({rows:t}),this.lastSelection=null;else{var f=[],c=r.rowIndxOffset,e=r.pdata,l=e?e.length:0;for(i=0,o=t.length;i<o;i++){var s=t[i],a=s.rowIndx,h=a-c;if(h>=0)if(h<l)f.push(s);else break}this.remove({rows:f})}};t.isSelected=function(n){var r=this.that,i=n.rowData||r.getRowData(n),t=n.dataIndx,u=n.colIndx;return u==null&&t==null?null:i==null?null:(t=t==null?r.colModel[u].dataIndx:t,i.pq_cellselect&&i.pq_cellselect[t])?!0:!1};t.refresh=function(){var e,n,a,o,s,v,i,t;this.selection=[];var r=this.that,y=r.options.dataModel,p=r.options.pageModel,u=y.data,h=[],w=p.type,b=w=="remote"?!0:!1,k=r.rowIndxOffset,f=this.that.colModel,c=f.length;if(u){var d=[],g=[],l=[];for(n=0;n<c;n++)e=f[n],t=e.dataIndx,l[n]=t,d[t]=n,g[t]=e;for(n=0,a=u.length;n<a;n++)if(o=u[n],s=o.pq_cellselect,s)for(v=b?n+k:n,i=0;i<c;i++)t=l[i],s[t]&&h.push({rowIndx:v,rowData:o,dataIndx:t,colIndx:i,column:f[i]});this.selection=h}};t.replace=function(n){var i=n.rowIndx,u=n.colIndx,t=n.offset==null?this.that.getRowIndxOffset():n.offset,r=i-t,f=n.$td,e=n.evt;n.rowIndxPage=r;n.offset=t;this.removeAll({raiseEvent:!0});this.add(n)};t.inViewCell=function(n,t){var i=this.that,r=this.options,u=r.freezeCols;return this.inViewRow(n)?t<u||t>=i.initH&&t<=i.finalH:!1};t._add=function(n){var r=this.that,u=n.rowIndx,f=n.rowIndxPage,e=n.rowData||r.getRowData(n),c=r.rowIndxOffset,l,u=u==null?f+c:u,f=f==null?u-c:f,o=n.colIndx,t=n.dataIndx,o=o==null?r.getColIndx({dataIndx:t}):o,s=r.colModel[o],t=t==null?s.dataIndx:t,v=n.evt,a=this.isSelected({rowData:e,dataIndx:t}),h,i;return a==null?!1:(h=this.inViewCell(f,o),a===!1&&(h&&(i=r.getCell({rowIndxPage:f,colIndx:o}),i&&i.addClass("pq-state-select ui-state-highlight")),this._addToData({rowData:e,dataIndx:t}),n.trigger!==!1&&r._trigger("cellSelect",v,{rowIndx:u,rowIndxPage:f,colIndx:o,dataIndx:t,column:s,rowData:e}),l=!0),this.lastSelection={rowIndx:u,dataIndx:t,rowData:e},n.focus!==!1&&h&&(i&&i.length||(i=r.getCell({rowIndxPage:f,dataIndx:t})),i&&i.length&&(i.attr("tabindex","0"),i.focus(),r._fixTableViewPort(),this.focusSelection={rowData:e,rowIndx:u,dataIndx:t})),n.setFirst&&(this.firstSelection={rowIndx:u,rowData:e,dataIndx:t}),l?{rowIndx:u,rowData:e,dataIndx:t,colIndx:o,column:s}:void 0)};i._add=function(t){var e=this.that,s,u=t.rowIndx,f=t.rowIndxPage,h=e.rowIndxOffset,u=u==null?f+h:u,f=f==null?u-h:f,r=r==null?e.getRowData(t):r,i=t.$tr,a=t.evt,c=this.isSelected({rowData:r}),o,l;return(t.rowIndxPage=f,c==null)?!1:(o=this.inViewRow(f),c===!1&&(o&&(l=this._boundRow(t),i=l),r.pq_rowselect=!0,t.trigger!==!1&&e._trigger("rowSelect",a,{rowIndx:u,rowIndxPage:f,rowData:r,$tr:i}),s=!0),this.lastSelection={rowIndx:u,rowData:r},t.focus!==!1&&o&&(i&&i.length||(i=e.getRow({rowIndxPage:f})),i&&(i=n(i[0]),i.attr("tabindex","0"),i.focus(),e._fixTableViewPort(),this.focusSelection={rowData:r,rowIndx:u})),t.setFirst&&(this.firstSelection={rowIndx:u,rowData:r}),s?{rowIndx:u,rowData:r}:void 0)};t.add=function(n){var e=this.that,o=n.evt,i=n.cells,t=!1,u=[],r,s,f;if(i&&typeof i.push=="function"){for(r=0,s=i.length;r<s;r++)f=i[r],f.trigger=!1,t=this._add(f),t&&u.push(t);u.length&&(t=!0,e._trigger("cellSelect",o,{cells:u}))}else t=this._add(n);t&&(e._fixIE(),this.triggerSelectChange({evt:o}))};i.add=function(n){var e=this.that,o=n.evt,i=n.rows,t=!1,u=[],r,s,f;if(i&&typeof i.push=="function"){for(r=0,s=i.length;r<s;r++)f=i[r],f.trigger=!1,t=this._add(f),t&&u.push(t);u.length&&(t=!0,e._trigger("rowSelect",o,{rows:u}))}else t=this._add(n);t&&(e._fixIE(),this.triggerSelectChange({evt:o}))};t._remove=function(n){var r=this.that,u=n.rowIndx,f=n.rowIndxPage,h=r.rowIndxOffset,u=u==null?f+h:u,f=f==null?u-h:f,e=n.rowData||r.getRowData(n),t=n.colIndx,i=n.dataIndx,t=t==null?r.getColIndx({dataIndx:i}):t,o=n.column,o=o==null?r.colModel[t]:o,i=i==null?o.dataIndx:i,c=n.evt,l=this.isSelected({rowData:e,dataIndx:i}),s;if(l)return this.inViewCell(f,t)&&(s=r.getCell({rowIndxPage:f,colIndx:t,all:!0}),s&&(s.removeClass("pq-state-select ui-state-highlight"),s.removeAttr("tabindex"))),this._removeFromData({rowData:e,dataIndx:i}),n.trigger!==!1&&r._trigger("cellUnSelect",c,{rowIndx:u,colIndx:t,dataIndx:i,rowData:e}),{rowIndx:u,rowData:e,dataIndx:i,colIndx:t,column:o}};i._remove=function(n){var f=this.that,i=n.rowIndx,r=n.rowIndxPage,e=f.rowIndxOffset,i=i==null?r+e:i,r=r==null?i-e:r,t=n.rowData,t=t==null?f.getRowData(n):t,u=n.$tr,o=n.evt,s=this.isSelected({rowData:t});if(s)return this.inViewRow(r)&&(u=f.getRow({rowIndxPage:r}),u&&(u.removeClass("pq-row-select ui-state-highlight"),u.removeAttr("tabindex"))),t.pq_rowselect=!1,n.trigger!==!1&&f._trigger("rowUnSelect",o,{rowIndx:i,rowData:t,$tr:u}),{rowIndx:i,rowData:t}};t.remove=function(n){var i=n.cells,e=n.evt,t=!1,r,u,o,f;if(i&&typeof i.push=="function"){for(r=[],u=0,o=i.length;u<o;u++)f=i[u],f.trigger=!1,t=this._remove(f),t&&r.push(t);r.length&&(t=!0,this.that._trigger("cellUnSelect",e,{cells:r}))}else t=this._remove(n);t&&this.triggerSelectChange({evt:e})};i.remove=function(n){var i=n.rows,e=n.evt,t=!1,r,u,o,f;if(i&&typeof i.push=="function"){for(r=[],u=0,o=i.length;u<o;u++)f=i[u],f.trigger=!1,t=this._remove(f),t&&r.push(t);r.length&&(t=!0,this.that._trigger("rowUnSelect",e,{rows:r}))}else t=this._remove(n);t&&this.triggerSelectChange({evt:e})};t.indexOf=function(n){var i,t,r;this.refresh();var f=n.rowIndx,e=this.that,u=n.dataIndx==null?e.colModel[n.colIndx].dataIndx:n.dataIndx;for(n.dataIndx=u,i=this.selection,t=0;t<i.length;t++)if(r=i[t],r.rowIndx==f&&r.dataIndx==u)return t;return-1};t.selectAll=function(n){var e=this.that,o=n&&n.all?!0:!1,i=o?this.options.dataModel.data:e.pdata,s=e.rowIndxOffset,h=e.colModel,p=h.length,c=[],l=function(n,t){for(var r,u,i=0;i<p;i++)(r=h[i],r.hidden)||(u={rowIndx:t,rowData:n,colIndx:i,dataIndx:r.dataIndx,focus:!1},c.push(u))},a,v,u,f,t,r,y;if(i){for(t=0,r=i.length;t<r;t++)u=i[t];if(o)for(a=this.options.pageModel.type,v=a=="remote"?!0:!1,t=0,r=i.length;t<r;t++)u=i[t],f=t,v&&(f=t+s),l(u,f);else for(t=0,r=i.length;t<r;t++){var u=i[t],w=t,f=w+s;l(u,f)}y=this;y.add({cells:c})}};i.selectAll=function(n){var c=this.that,e=n&&n.all?!0:!1,i=e?this.options.dataModel.data:c.pdata,f=[],o,s,u,t,r,h;if(i){if(e)for(o=this.options.pageModel.type,s=o=="remote"?!0:!1,t=0,r=i.length;t<r;t++)u={rowData:i[t],focus:!1},s?u.rowIndxPage=t:u.rowIndx=t,f.push(u);else for(t=0,r=i.length;t<r;t++)h=i[t],f.push({rowIndxPage:t,rowData:h,focus:!1});this.add({rows:f})}};t.selectRange=function(n){for(var i,s,u,t,h=this.that,f=n.initRowIndx,c=n.initColIndx,e=n.finalRowIndx,l=n.finalColIndx,a=h.colModel,p=a.length,w=this.getSelection(),v=w.slice(0),r=[],o=0;o<v.length;o++){var y=v[o],t=y.rowIndx,u=y.dataIndx,i=h.getColIndx({dataIndx:u});t<f||t>e?r.push({rowIndx:t,colIndx:i,dataIndx:u}):t==f&&i<c?r.push({rowIndx:t,colIndx:i,dataIndx:u}):t==e&&i>l&&r.push({rowIndx:t,colIndx:i,dataIndx:u})}for(this.remove({cells:r}),r=[],i=0;i<p;i++)if(s=a[i],!s.hidden){u=s.dataIndx;t=f;do{if(t!=f||!(i<c))if(t==e&&i>l)break;else r.push({rowIndx:t,colIndx:i,dataIndx:u,focus:!1});t++}while(t<=e)}this.add({cells:r})};t.selectBlock=function(n){for(var t,e,u,i,o=this.that,s=n.initRowIndx,h=n.initColIndx,c=n.finalRowIndx,l=n.finalColIndx,y=n.evt,p=this.getSelection(),a=p.slice(0),w=o.colModel,r=[],f=0;f<a.length;f++){var v=a[f],i=v.rowIndx,u=v.dataIndx,t=o.getColIndx({dataIndx:u});t<h||t>l?r.push({rowIndx:i,colIndx:t,dataIndx:u}):(i<s||i>c)&&r.push({rowIndx:i,colIndx:t,dataIndx:u})}for(this.remove({cells:r}),r=[],t=h;t<=l;t++)if(e=w[t],u=e.dataIndx,!e.hidden){i=s;do r.push({rowIndx:i,colIndx:t,dataIndx:u,focus:!1}),i++;while(i<=c)}this.add({cells:r,evt:y})}}(jQuery),function(n){var i=n.paramquery.cCheckBoxColumn=function(n,t){var i=this;this.that=n;this.options=n.options;this.column=t;this.cb=t.cb=t.cb||{all:!1,header:!0};this.dataIndx=t.dataIndx;var r=n.widgetEventPrefix.toLowerCase(),f=n.element,u=n.eventNamespace;f.on(r+"dataavailable"+u,function(n,t){if(i.belongs(n))return i._onDataAvailable(n,t)});f.on(r+"cellclick"+u,function(n,t){if(i.belongs(n))return i.cellClick(n,t)});if(this.cb.reverse){f.on(r+"rowselect"+u,function(n,t){if(i.belongs(n))return i.rowSelect(n,t)});f.on(r+"rowunselect"+u,function(n,t){if(i.belongs(n))return i.rowUnSelect(n,t)})}f.on(r+"cellkeydown"+u,function(n,t){if(i.belongs(n))return i.cellKeyDown(n,t)});f.on(r+"refresh"+u+" "+r+"refreshrow"+u,function(n,t){if(i.belongs(n))return i.refreshHeader(n,t)})},t=i.prototype=new n.paramquery.cClass;t.hasHeaderChkBox=function(){return this.cb.header};t.setValCBox=function(){var n,t,e;if(this.hasHeaderChkBox()){var o=this.that,s=this.options,h=this.dataIndx,c=this.cb.all,r=c?s.dataModel.data:o.pdata,i=null,u=0,f=0;for(n=0,t=r.length;n<t;n++)e=r[n],e[h]?u++:f++;u==t?i=!0:f==t&&(i=!1);this.$inp.pqval({val:i})}};t.onHeaderClick=function(t){var i=this.that,l=this,h=n(t.currentTarget).find("input"),a=this.column,u=a.dataIndx,v=i.getColIndx({dataIndx:u}),w=this.cb.all,f=w?i.options.dataModel.data:i.pdata,e={column:a,dataIndx:u,source:"header"},c=n(t.target).is("input")?!0:!1,y=h.is(":checked"),p=y,r,o,s;if(c||(p=!y),p){if(i._trigger("beforeCheck",t,e)===!1)return!1;for(c||h.pqval({val:!0}),r=0,o=f.length;r<o;r++)s=f[r],s[u]=!0;i.$cont.find("td[pq-col-indx="+v+"] input").prop("checked",!0);i._trigger("check",t,e)!==!1&&l.selectAllRows()}else{if(i._trigger("beforeunCheck",t,e)===!1)return!1;for(c||h.pqval({val:!1}),r=0,o=f.length;r<o;r++)s=f[r],s[u]=!1;i.$cont.find("td[pq-col-indx="+v+"] input").prop("checked",!1);i._trigger("unCheck",t,e)!==!1&&l.unSelectAllRows()}};t.refreshHeader=function(){var t,i,r,n,u;this.hasHeaderChkBox()&&(t=this.that,i=t.pdata,i)&&(r=this,n=t.getCellHeader({dataIndx:this.dataIndx}),n)&&(n.html("<input type='checkbox'/>"),u=this.$inp=n.find("input"),n.click(function(n){return r.onHeaderClick(n)}),this.setValCBox())};t.selectAllRows=function(){var n=this.that,t=this.cb.all;n.iRows.selectAll({all:t})};t.unSelectAllRows=function(){var n=this.that,t=this.cb.all;n.iRows.removeAll({all:t})};t._onDataAvailable=function(){var e=this.that,o=this.options,i=o.dataModel.data,h=o.pageModel.type=="remote"?!0:!1,c=h?e.rowIndxOffset:0,s=this.column,r=s.dataIndx,u,f,n,t;if(r!=null&&i){for(u=[],n=0,f=i.length;n<f;n++)t=i[n],t[r]&&u.push({rowIndx:n+c,rowData:t});if(e._trigger("check",null,{rows:u,column:s,dataIndx:r,source:"dataAvailable"})!==!1)for(n=0;n<f;n++)t=i[n],t[r]&&(t.pq_rowselect=!0)}};t.cellClick=function(n,t){if(t.dataIndx===this.dataIndx)return this.raiseEvent(n,t)};t.rowSelect=function(n,t){var o=this.that,u=t.rows,f=t.rowData,i=this.dataIndx,r,s;if(u)for(r=0,s=u.length;r<s;r++){var h=u[r],e=h.rowIndx,f=h.rowData;f[i]=!0;o.refreshCell({rowIndx:e,dataIndx:i})}else f&&(f[i]=!0,e=t.rowIndx,o.refreshCell({rowIndx:e,dataIndx:i}));this.setValCBox()};t.rowUnSelect=function(n,t){var o=this.that,u=t.rows,f=t.rowData,i=this.dataIndx,r,s;if(u)for(r=0,s=u.length;r<s;r++){var h=u[r],e=h.rowIndx,f=h.rowData;f[i]=!1;o.refreshCell({rowIndx:e,dataIndx:i})}else f&&(f[i]=!1,e=t.rowIndx,o.refreshCell({rowIndx:e,dataIndx:i}));this.setValCBox()};t.raiseEvent=function(t,i){var r=this.that,f=i.rowData,e=n(t.originalEvent.target).is("input")?!0:!1,s=i.rowIndx,o=i.dataIndx,u;if(f[o]){if(r._trigger("beforeunCheck",t,i)===!1)return!1;f[o]=!1;e||(u=r.getCell(i).find("input"),u.pqval({val:!1}));r._trigger("unCheck",t,i)!==!1&&r.iRows.remove({rowIndx:s})}else{if(r._trigger("beforeCheck",t,i)===!1)return!1;f[o]=!0;e||(u=r.getCell(i).find("input"),u.pqval({val:!0}));r._trigger("check",t,i)!==!1&&r.iRows.add({rowIndx:s})}return this.setValCBox(),e?void 0:!1};t.cellKeyDown=function(n,t){if((t.dataIndx=this.dataIndx)&&(n.keyCode==13||n.keyCode==32))return this.raiseEvent(n,t)}}(jQuery),function(){for(var i=0,t=["moz","webkit"],n=0;!window.requestAnimationFrame&&n<t.length;n++)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i));return window.setTimeout(function(){i=(new Date).getTime();n()},r)});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}(),function(n){function i(n){this.that=n;var t=this,u=n.element,i=n.widgetEventPrefix.toLowerCase(),r=n.eventNamespace;this.scrollTop=0;this.scrollLeft=0;u.on(i+"contmousedown"+r,function(n,i){if(t.belongs(n))return t._onContMouseDown(n,i)}).on(i+"mousedrag"+r,function(n,i){if(t.belongs(n)&&t.swipedown)return t._onMouseDrag(n,i)}).on(i+"mousestop"+r,function(n,i){return t._onMouseStop(n,i)}).on(i+"mousepqup"+r,function(n,i){return t._onMousePQUp(n,i)}).on(i+"rowmousedown"+r,function(n,i){if(t.belongs(n))return t._onRowMouseDown(n,i)}).on(i+"cellmousedown"+r,function(n,i){if(t.belongs(n))return t._onCellMouseDown(n,i)}).on(i+"beforetableview"+r,function(n,i){if(t.belongs(n))return t._beforeTableView(n,i)}).on(i+"refresh"+r,function(n,i){if(t.belongs(n))return t._onRefresh(n,i)}).on(i+"cellmouseenter"+r,function(n,i){if(t.belongs(n))return t._onCellMouseEnter(n,i)}).on(i+"rowmouseenter"+r,function(n,i){if(t.belongs(n))return t._onRowMouseEnter(n,i)})}var r=n.paramquery.pqgrid.calcWidthCols,t;n.paramquery.cMouseSelection=i;t=i.prototype=new n.paramquery.cClass;t._beforeTableView=function(){var i=this.that,r=i.getFocusElement(),n,t;this.lastFocus=null;r&&r.$grid&&(n=r.$ae,n.hasClass("pq-grid-row")?(t=i.getRowIndx({$tr:n}),this.lastFocus=t):n.hasClass("pq-grid-cell")&&(t=i.getCellIndices({$td:n}),this.lastFocus=t))};t.inViewPort=function(n){var u=this.that,i=u.iRefresh,f=i.getEContHt(),e=i.getEContWd()+1,t=n[0],r=this,o=r.marginTop,s=r.scrollLeft;if(f>=t.offsetTop+t.offsetHeight+o)if(t.nodeName.toUpperCase()=="TD"){if(e>=t.offsetLeft+t.offsetWidth+s)return!0}else return!0};t._onRefresh=function(){var i=this.that,n=this.lastFocus,t;n&&(t=n.dataIndx!=null?i.getCell(n):i.getRow(n),t&&t.length&&t.attr("tabindex","0").focus())};t._onCellMouseDown=function(n,t){var i=this.that,u=t.rowIndx,r=t.colIndx,f=i.options.selectionModel,o=f.type,e=f.mode;if(o=="cell")return r==null?void 0:(n.shiftKey?(i.iCells.extendSelection({rowIndx:u,colIndx:r,mode:e,evt:n}),n.preventDefault()):(n.ctrlKey||n.metaKey)&&e!="single"?i.iCells.isSelected({rowIndx:u,colIndx:r})?i.iCells.remove({rowIndx:u,colIndx:r}):i.setSelection({rowIndx:u,colIndx:r}):(this.mousedown={r1:u,c1:r},i.setSelection(null),i.setSelection({rowIndx:u,colIndx:r,setFirst:!0})),!0)};t._onCellMouseEnter=function(t,i){var e=this.that,o=e.options.selectionModel,s=o.type,l=n.paramquery,a=o.mode;if(s=="cell"&&this.mousedown){var f=this.mousedown,h=f.r1,c=f.c1,r=i.rowIndx,u=i.colIndx;if(h==r&&c==u)return;if(f.r2==r&&f.c2==u)return;this.mousedown.r2=r;this.mousedown.c2=u;e.scrollCell({rowIndx:r,colIndx:u});e.iCells.extendSelection({rowIndx:r,colIndx:u,evt:t})}};t._onRowMouseEnter=function(n,t){var r=this.that,u=r.options.selectionModel,f=u.type;if(f=="row"&&this.mousedown){var o=this.mousedown,e=this.mousedown.r1,i=t.rowIndx;if(e==i)return;if(this.mousedown.r2==i)return;this.mousedown.r2=i;r.scrollRow({rowIndx:i});r.iRows.extendSelection({rowIndx:i,evt:n})}};t._onRowMouseDown=function(n,t){var i=this.that,o=this,r=t.rowIndx,u=i.options.selectionModel,f=u.mode,e=u.type;if(e=="row")return r==null?void 0:(n.shiftKey?(i.iRows.extendSelection({rowIndx:r,evt:n}),n.preventDefault()):(n.ctrlKey||n.metaKey)&&f!="single"?i.iRows.isSelected({rowIndx:r})?i.iRows.remove({rowIndx:r}):i.setSelection({rowIndx:r}):(this.mousedown={r1:r,y1:n.pageY,x1:n.pageX},i.setSelection(null),i.setSelection({rowIndx:r,setFirst:!0})),!0)};t._onContMouseDown=function(n){var t=this.that,i=t.options.swipeModel,r=i.on;return r&&(this._stopSwipe(!0),this.swipedown={x:n.pageX,y:n.pageY}),!0};t._onMousePQUp=function(){var n=this.that;this.mousedown=null};t._stopSwipe=function(n){var t=this;n&&(t.swipedown=null,t.swipedownPrev=null);window.clearInterval(t.intID);window.cancelAnimationFrame(t.intID);t.intID=null};t._onMouseStop=function(n){var t=this,a=this.that,i,s,h;if(this.swipedownPrev){var r=a.options.swipeModel,u=this.swipedownPrev,v=u.ts,y=(new Date).getTime(),f=y-v,p=u.x,w=u.y,c=n.pageX,l=n.pageY,e=c-p,o=l-w,b=Math.sqrt(e*e+o*o),k=b/f;k>r.ratio?(i=0,s=r.repeat,t._stopSwipe(),h=function(){i+=r.speed;s--;var n=c+i*e/f,u=l+i*o/f;t._onMouseDrag({pageX:n,pageY:u});s>0?t.intID=window.requestAnimationFrame(h):t._stopSwipe(!0)},h()):(t.swipedown=null,t.swipedownPrev=null)}};t._onMouseDrag=function(t){var s=this.that,h=n.paramquery,i=s.options;if(this.swipedown){var r=this.swipedown,u=r.x,f=r.y,e=t.pageX,o=t.pageY;this.swipedownPrev={x:u,y:f,ts:(new Date).getTime()};i.virtualY||i.height==="flex"||(this.scrollVertSmooth(f,o),this.syncScrollBarVert());i.virtualX||i.width==="flex"||(this.scrollHorSmooth(u,e),this.syncScrollBarHor());r.x=e;r.y=o}return!0};t.updateTableY=function(n){var r,i,f;if(n==0)return!1;var e=this.that,t=this.getTableForVertScroll(),u=e.iRefresh.getEContHt();return!t||!t.length?!1:(r=t.data("offsetHeight")-1,i=this.scrollTop-n,f=i<0?0:n<0&&u-r+i>0?r-u:i,this.setScrollTop(f,t),!0)};t.setScrollTop=function(n,t){n>=0&&(n=Math.round(n),this.scrollTop=n,t.parent("div").scrollTop(n))};t.getScrollLeft=function(){return this.scrollLeft};t.getScrollTop=function(){return this.scrollTop};t.setScrollLeft=function(n,t,i){n>=0&&(n=Math.round(n),this.scrollLeft=n,i&&i.css({marginLeft:-1*n}),t&&t.parent("div").scrollLeft(n))};t.scrollVertSmooth=function(n,t){n!=t&&this.updateTableY(t-n)};t.scrollHorSmooth=function(n,t){if(n!=t){var s=this.that,h=t-n,i=this.getTableForHorScroll(),r=this.getTableHeaderForHorScroll(),f=s.iRefresh.getEContWd();if(i||r){var c=i?i:r,e=c.data("scrollWidth"),o,u=this.scrollLeft-h;o=u<0?0:e-f-u<0?e-f:u;this.setScrollLeft(o,i,r)}}};t.syncViewWithScrollBarVert=function(n){var i,t,r;if(n!=null&&(i=this.that,t=this.getTableForVertScroll(),t&&t.length)){r=i.options;r.editModel.indices&&i.blurEditor({force:!0});var f=t.data("offsetHeight")-1,e=i.iRefresh.getEContHt(),o=f-e,u=o*n;if((!f||!e)&&r.debug)throw"_syncViewWithScrollBarVert !tblHt || !contHt";u<0&&(u=0);this.setScrollTop(u,t)}};t.syncViewWithScrollBarHor=function(n){var f;if(n!=null){var i=this.that,t=this.getTableForHorScroll(),r=this.getTableHeaderForHorScroll();if(t||r){f=i.options;f.editModel.indices&&i.blurEditor({force:!0});var s=t?t:r,e=s.data("scrollWidth"),o=i.iRefresh.getEContWd(),h=e-o,u=h*n;e&&o&&(u<0&&(u=0),this.setScrollLeft(u,t,r))}}};t.resetMargins=function(){this.scrollLeft=0;this.scrollTop=0};t.syncHeaderViewWithScrollBarHor=function(n){var t,i,u,f;if(n!=null&&(t=this.that,i=this.getTableHeaderForHorScroll(),i)){u=t.options;f=u.freezeCols;u.editModel.indices&&t.blurEditor({force:!0});var o=i,s=o.data("scrollWidth"),h=t.iRefresh.getEContWd(),e=r.call(t,f,n+f);s&&h&&(e<0&&(e=0),i.css("marginLeft",-e))}};t.syncScrollBarVert=function(){var n=this.that,t=this.getTableForVertScroll();if(t&&t.length){var r=t.data("offsetHeight"),u=n.iRefresh.getEContHt(),f=r-u,e=this.scrollTop,i=e/f;i>=0&&i<=1&&n.$vscroll.hasClass("pq-sb-vert")&&n.$vscroll.pqScrollBar("option","ratio",i)}};t.syncScrollBarHor=function(){var n=this.that,t=this.getTableForHorScroll(),r=this.getTableHeaderForHorScroll();if(t||r){var u=t?t:r,f=u.data("scrollWidth"),e=n.iRefresh.getEContWd(),o=f-e,s=this.scrollLeft,i=s/o;i>=0&&i<=1&&n.$hscroll.hasClass("pq-sb-horiz")&&n.$hscroll.pqScrollBar("option","ratio",i)}};t.getTableForVertScroll=function(){var r=this.that,i=r.pqpanes,t=r.$tbl;if(t&&t.length)return i.h&&i.v?t=n([t[2],t[3]]):i.v?t=n([t[0],t[1]]):i.h&&(t=n(t[1])),t};t.getTableForHorScroll=function(){var u=this.that,r=u.pqpanes,i=[],t=u.$tbl,f;if(t&&t.length)return r.h&&r.v?i.push(t[1],t[3]):r.v?i.push(t[1]):r.h?i.push(t[0],t[1]):i.push(t[0]),u.tables.length&&(f=u.tables[0].$tbl,r.v?i.push(f[1]):i.push(f[0])),n(i)};t.getTableHeaderForHorScroll=function(){var i=this.that,r=i.pqpanes,t=i.$tbl_header;if(t&&t.length)return t=r.vH?n(t[1]):n(t[0]),t.parent()};t.scrollRowNonVirtual=function(n){var t=this.that,l=t.options,i=n.rowIndxPage,p=t.iHierarchy?!0:!1,a=n.rowIndx,o=t.iRefresh.getEContHt(),i=i==null?a-t.rowIndxOffset:i,v=parseInt(l.freezeRows),u;if(!(i<v)){var f=t.get$Tbl(i),y=t.getRow({rowIndxPage:i}),e=y[0];if(e){var s=e.offsetHeight,h=this.getScrollTop(),r=e.offsetTop,c=parseInt(f.css("marginTop"));r-h+c<0?(u=r+c,this.setScrollTop(u,f),this.syncScrollBarVert()):r+s-h>o&&(u=s+r-o,this.setScrollTop(u,f),this.syncScrollBarVert())}}};t.scrollColumnNonVirtual=function(n){var t=this.that,i=n.colIndx,i=i==null?t.getColIndx({dataIndx:n.dataIndx}):i,u=t.options.freezeCols,r;if(!(i<u)){var f=t._calcRightEdgeCol(i).width,e=t._calcRightEdgeCol(i-1).width,o=t._calcRightEdgeCol(u-1).width,s=this.getTableForHorScroll(),h=this.getTableHeaderForHorScroll(),c=t.iRefresh.getEContWd(),l=this.scrollLeft;f-l>c?(r=f-c,this.setScrollLeft(r,s,h),this.syncScrollBarHor()):e-o<l&&(r=e-o,this.setScrollLeft(r,s,h),this.syncScrollBarHor())}}}(jQuery),function(n){var t=null,f=!1,o=!1,s="",e=n.paramquery.pqGrid.prototype,u=e.options,r,i;e.copy=function(){t=new r(this);t.copy();t=null};e.paste=function(){t=new r(this);t.paste();t=null};u.pasteModel=u.pasteModel||{on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"};u.copyModel=u.copyModel||{on:!0,header:!0,zIndex:1e4};r=function(n,t){var i;this.that=n;t&&t.hasClass("pq-grid-row")?(this.rowIndx=n.getRowIndx({$tr:t}).rowIndx,this.dataIndx=null):t&&t.hasClass("pq-grid-cell")?(i=n.getCellIndices({$td:t}),this.rowIndx=i.rowIndx,this.dataIndx=i.dataIndx):(this.rowIndx=null,this.dataIndx=null)};i=r.prototype;i.createClipBoard=function(){var i=n("#pq-grid-excel-div"),r=this.that.options.copyModel,t=n("#pq-grid-excel");t.length==0&&(i=n("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+r.zIndex+";'/>").appendTo(document.body),t=n("<textarea id='pq-grid-excel' autocomplete='off'  style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(i),t.css({opacity:0}));t.select()};i.destroyClipBoard=function(){var i=this.that,r,t=i.iCells.getFocusSelection({old:!0}),u,f,e,o;t?r=i.getCell({rowIndx:t.rowIndx,dataIndx:t.dataIndx}):(t=i.iRows.getFocusSelection({old:!0}),t&&(r=i.getRow({rowIndx:t.rowIndx})));u=n(window).scrollTop();f=n(window).scrollLeft();r?r.attr("tabindex",0).focus():i.$cont.focus();e=n(window).scrollTop();o=n(window).scrollLeft();(u!=e||f!=o)&&window.scrollTo(f,u)};i.clearClipBoard=function(){var t=n("#pq-grid-excel");t.val("")};i.copy=function(){var v=n("#pq-grid-excel"),o=this.that,b=o.options,k=b.copyModel,p=o.colModel,d=p.length,r=[],h=[],l,a,t,c,i;if(k.on){for(r=o.iRows.getSelection(),t=0,c=r.length;t<c;t++){var f=r[t],w=f.rowData,u=[];for(l=0;l<d;l++)(a=p[l],a.copy!==!1)&&u.push(w[a.dataIndx]);i=u.join("\t");h.push(i)}r=o.iCells.getSelection();var w=null,y=null,e=null,u=[];for(t=0,c=r.length;t<c;t++){var f=r[t],y=f.rowIndx,w=f.rowData,a=f.column,g=f.dataIndx;a.copy!==!1&&(e!=null&&y!=e?(i=u.join("\t"),u=[],h.push(i),e=y):e==null&&(e=y),u.push(w[g]))}h.push(u.join("\t"));i=h.join("\n");v.length&&(v.val(i),v.select());s=i}};i.paste=function(){var t=this.that,yt=n("#pq-grid-excel"),rt=yt.length?yt.val():s,rt=rt.replace(/\n$/,""),h=rt.split("\n"),ut=h.length,pt,wt=t.colModel,gt=t.options,c=gt.pasteModel,b="row",k=wt.length,l,o,r,a,v,i,u,y,ft,g,w,it,vt,e;if(c.on&&rt.length!=0&&ut!=0){if(e={rows:h},t._trigger("beforePaste",null,e)===!1)return!1;l=c.type;i=t.iRows.getSelectionCurPage();i&&i.length||(b="cell",i=t.iCells.getSelectionCurPage());i&&i.length?(o=i[0].rowIndx,a=i[i.length-1].rowIndx,b=="cell"&&(r=t.getColIndx({dataIndx:i[0].dataIndx}),v=t.getColIndx({dataIndx:i[i.length-1].dataIndx}))):(o=0,a=0,r=0,v=0);l=="replace"?(u=o,ft="updateElseAdd",y=a-o+1<ut?"extend":"repeat"):l=="append"?(u=a+1,y="extend",ft="addRow"):l=="prepend"&&(u=o,y="extend",ft="addRow");var p,ni=y=="extend"?ut:a-o+1,f,et,d=0,bt=[],ot=0;for(g=0;g<ni;g++){var st=h[d],kt=g+u,nt=l=="replace"?t.getRowData({rowIndx:kt}):null,ht=nt?{}:null,ct={};if(st===undefined&&y==="repeat"&&(d=0,st=h[d]),d++,w=st.split("\t"),!f)if(b=="cell"){if(pt=w.length,p=v-r+1<w.length?"extend":"repeat",f=p=="extend"?pt:v-r+1,isNaN(f))throw"lenH NaN. assert failed.";f+r>k&&(f=k-r)}else f=k,r=0;for(var tt=0,it=0,et=f,it=0;it<et;it++){var ti=it+r,dt=wt[ti],lt=w[tt],at=dt.dataIndx;if(dt.hidden){p=="extend"&&et+r<k&&et++;continue}else lt===undefined&&p==="repeat"&&(tt=0,lt=w[tt]),tt++,ct[at]=lt,ht&&(ht[at]=nt[at])}n.isEmptyObject(ct)==!1&&(vt="update",nt==null&&(vt="add"),bt.push({newRow:ct,rowIndx:kt,rowData:nt,oldRow:ht,type:vt}),ot++)}e={rowList:bt,source:"paste",allowInvalid:c.allowInvalid,validate:c.validate};t._digestData(e);c.select&&(b=="cell"?t.iCells.selectBlock({initRowIndx:u,finalRowIndx:u+ot-1,initColIndx:r,finalColIndx:p=="extend"?r+f-1:v}):t.iRows.selectRange({initRowIndx:u,finalRowIndx:u+ot-1}));t.refreshView();e={rows:h};t._trigger("paste",null,e)}};n(document).unbind(".pqExcel").bind("keydown.pqExcel",function(i){var u,e,h,s,c;if(i.ctrlKey||i.metaKey){if(u=n(i.target),!u.hasClass("pq-grid-row")&&!u.hasClass("pq-grid-cell")&&!u.is("#pq-grid-excel")&&!u.is("div.pq-grid-cont"))return;if(e=u.closest(".pq-grid"),t||u.length&&e.length){if(!t){try{h=e.pqGrid("getInstance").grid}catch(l){return!0}t=new r(h,u);t.createClipBoard()}i.keyCode=="67"||i.keyCode=="99"?(o=!0,t.copy()):i.keyCode=="86"||i.keyCode=="118"?(f=!0,t.clearClipBoard(),window.setTimeout(function(){t&&(t.paste(),t.destroyClipBoard(),t=null);f=!1},0)):(s=n("#pq-grid-excel"),s.length&&(c=document.activeElement,c==s[0]&&t.that._onKeyPressDown(i)))}}}).bind("keyup.pqExcel",function(i){var r=i.keyCode;f||!t||i.ctrlKey||i.metaKey||n.inArray(r,[17,91,93,224])==-1||(t.destroyClipBoard(),t=null);o=!1})}(jQuery),function(n){var i=n.paramquery.pqGrid.prototype.options,r,t,u;i.historyModel=i.historyModel||{on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0};r=n.paramquery.cHistory=function(n){var t=this,i,r;this.that=n;this.options=n.options;this.records=[];this.counter=0;this.id=0;i=n.eventNamespace;r=n.widgetEventPrefix.toLowerCase();n.element.on(r+"keydown"+i,function(n,i){if(t.belongs(n))return t._onKeyDown(n,i)});n.element.on(r+"dataavailable"+i,function(n,i){t.belongs(n)&&i.source!="filter"&&t.reset()})};t=r.prototype=new n.paramquery.cClass;t._onKeyDown=function(n){var t={z:"90",y:"89",c:"67",v:"86"},i=n.ctrlKey||n.metaKey;return i&&n.keyCode==t.z?(this.undo(),!1):i&&n.keyCode==t.y?(this.redo(),!1):void 0};t.resetUndo=function(){if(this.counter==0)return!1;this.counter=0;var n=this.that;n._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})};t.reset=function(){if(this.counter==0&&this.records.length==0)return!1;this.records=[];this.counter=0;this.id=0;var n=this.that;n._trigger("history",null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})};t.increment=function(){var n=this.records,t=n.length,i;t?(i=n[t-1].id,this.id=i+1):this.id=0};t.push=function(t){var o=this.canRedo(),i=this.records,r=this.counter,u,f,e;i.length>r&&i.splice(r,i.length-r);i[r]=n.extend({id:this.id},t);this.counter++;u=this.that;this.counter==1&&(f=!0);o&&this.counter==i.length&&(e=!1);u._trigger("history",null,{type:"add",canUndo:f,canRedo:e,num_undo:this.counter,num_redo:0})};t.canUndo=function(){return this.counter>0?!0:!1};t.canRedo=function(){return this.counter<this.records.length?!0:!1};t.undo=function(){var y=this.canRedo(),t=this.that,f=this.options.historyModel,p=this.records,r,c,k,a,v;if(this.counter>0)this.counter--;else return!1;var w=this.counter,s=p[w],h=s.rowList,i=[],d=s.id;for(r=0,c=h.length;r<c;r++){var n=h[r],l=n.newRow,e=n.rowData,u=n.type,b=n.oldRow,o=n.rowIndx;u=="update"?(o=t.getRowIndx({rowData:e}).rowIndx,i.push({type:u,rowIndx:o,rowData:e,oldRow:l,newRow:b})):u=="add"?i.push({type:"delete",rowData:l}):u=="delete"&&i.push({type:"add",rowIndx:o,newRow:e})}return k=t._digestData({history:!1,source:"undo",checkEditable:f.checkEditable,checkEditableAdd:f.checkEditableAdd,allowInvalid:f.allowInvalid,rowList:i}),t.refreshView(),y===!1&&(a=!0),this.counter==0&&(v=!1),t._trigger("history",null,{canUndo:v,canRedo:a,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0};t.redo=function(){var w=this.canUndo(),t=this.that,f=this.options.historyModel,h=this.counter,e=this.records,r,a,k,y,p;if(h==e.length)return!1;var c=e[h],l=c.rowList,i=[],d=c.id;for(r=0,a=l.length;r<a;r++){var n=l[r],v=n.newRow,o=n.rowData,u=n.type,b=n.oldRow,s=n.rowIndx;u=="update"?(s=t.getRowIndx({rowData:o}).rowIndx,i.push({type:u,rowIndx:s,rowData:o,oldRow:b,newRow:v})):u=="add"?i.push({type:"add",rowIndx:s,newRow:v}):u=="delete"&&i.push({type:"delete",rowData:o})}return k=t._digestData({history:!1,source:"redo",checkEditable:f.checkEditable,checkEditableAdd:f.checkEditableAdd,allowInvalid:f.allowInvalid,rowList:i}),t.refreshView(),this.counter<e.length&&this.counter++,w==!1&&(y=!0),this.counter==this.records.length&&(p=!1),t._trigger("history",null,{canUndo:y,canRedo:p,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0};u=n.paramquery.pqGrid.prototype;u.history=function(n){var t=n.method;return this.iHistory[t](n)}}(jQuery),function(n){var t=n.ui.autocomplete.prototype,r=t._renderMenu,u=t._renderItem,i;t._renderMenu=function(t,i){var e,u;if(r.call(this,t,i),e=this.options,u=e.selectItem,u&&u.on){var f=u.cls,f=f===undefined?"ui-state-highlight":f,o=this.element.val();o&&f&&n("a",t).filter(function(){return n(this).text()===o}).addClass(f)}};t._renderItem=function(n,t){var h=u.call(this,n,t),c=this.options,r=c.highlightText,f,e,i;if(r&&r.on&&(f=this.element.val(),f&&(e=new RegExp("("+f+")","i"),i=t.label,e.test(i)))){var o=r.style,o=o===undefined?"font-weight:bold;":o,s=r.cls,s=s===undefined?"":s;i=i.replace(e,"<span style='"+o+"' class='"+s+"'>$1<\/span>");h.find("a").html(i)}return h};i={options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var i=n(this),s=i.closest(".pq-grid"),f=s.pqGrid("getInstance").grid,e=f.getCellIndices({$td:i}),h=e.rowIndx,c=e.dataIndx,r=f.data({rowIndx:h,dataIndx:c,data:"pq_valid"}).data,u,t,o;return r?(u=r.icon,t=r.msg,t=t!=null?t:"",o=u==""?"":"<span class='ui-icon "+u+" pq-tooltip-icon'><\/span>",o+t):i.attr("title")}}};i._create=function(){this._super();var t=this.element,i=this.eventNamespace;t.on("pqtooltipopen"+i,function(t,i){var u=n(t.target),f=n(t.originalEvent.target),s;f.on("remove",function(n){u.pqTooltip("close",n,!0)});if(i.tooltip.css("zIndex",f.zIndex()+5),u.is(".pq-grid")){var e=u.pqGrid("getCellIndices",{$td:f}),h=e.rowIndx,c=e.dataIndx,r,l=u.pqGrid("getRowData",{rowIndx:h});if((r=l)&&(r=r.pq_celldata)&&(r=r[c])&&(r=r.pq_valid)){var o=r,a=o.style,v=o.cls;i.tooltip.addClass(v);s=i.tooltip.attr("style");i.tooltip.attr("style",s+";"+a)}u.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(n){n.currentTarget=f[0];u.pqTooltip("close",n,!0)})}});t.on("pqtooltipclose"+i,function(t){var i=n(t.target),r=n(t.originalEvent.target);r.off("remove");i.is(".pq-grid")&&i.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})};n.widget("paramquery.pqTooltip",n.ui.tooltip,i)}(jQuery)
//# sourceMappingURL=pqgrid.min.map
